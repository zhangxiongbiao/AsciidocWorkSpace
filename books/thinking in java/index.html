<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="张雄彪">
<title>Thinking In Java</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: #fff; color: #222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Arial, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Arial, sans-serif; font-weight: normal; font-style: normal; color: #7B2D00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Arial, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #ddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #ddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }

blockquote, blockquote p { line-height: 1.6; color: #333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #ddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: #fff; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: -webkit-linear-gradient(top, #add386, #90b66a); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #fff; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eee; border: 1px solid #ddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; }

pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

.keyseq { color: #333333; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: black; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: #7B2D00; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #e15200; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #333; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #333; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: #7B2D00; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0 solid #ddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #003b6b; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #fff; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #ddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 0 solid #ddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7B2D00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: #7B2D00; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddd; color: #e15200; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px dashed #666; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 1.25em 1.5625em 1.125em 1.5625em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1.25em 1.5625em 1.125em 1.5625em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.6; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 0.75em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #333; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #003b6b; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #e15200; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 0.75em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #333; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #e15200; }

.quoteblock.abstract { margin: 0 0 0.75em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #d8d8ce; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: -webkit-linear-gradient(top, #add386, #90b66a); }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #fff; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 0.75em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px #fff; -webkit-box-shadow: 0 0 0 1px #ddd; box-shadow: 0 0 0 1px #ddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #004177; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #ddd; }

.sect1 { padding-bottom: 0; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

.literalblock pre, .listingblock pre { background: #eee; }

</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Thinking In Java</h1>
<div class="details">
<span id="author" class="author">张雄彪</span><br>
<span id="email" class="email"><a href="mailto:zxb@dameng.com">zxb@dameng.com</a></span><br>
<span id="revnumber">version 1.0,</span>
<span id="revdate">2016-04-06</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<ul class="sectlevel0">
<li><a href="#_introduction_to_objects">Introduction to Objects</a>
<ul class="sectlevel1">
<li><a href="#_the_progress_of_abstraction">1. The progress of abstraction</a></li>
<li><a href="#_an_object_has_an_interface">2. An object has an interface</a></li>
<li><a href="#_an_object_provides_services">3. An object provides services</a></li>
<li><a href="#_the_hidden_implementation">4. The hidden implementation</a></li>
<li><a href="#_reusing_the_implementation">5. Reusing the implementation</a></li>
<li><a href="#_inheritance">6. Inheritance</a></li>
<li><a href="#_is_a_vs_is_like_a_relationships">7. Is-a vs. is-like-a relationships</a></li>
<li><a href="#_interchangeable_objects_with_polymorphism">8. Interchangeable objects with polymorphism</a></li>
<li><a href="#_the_singly_rooted_hierarchy">9. The singly rooted hierarchy</a></li>
<li><a href="#_containers">10. Containers</a>
<ul class="sectlevel2">
<li><a href="#_parameterized_types_generics">10.1. Parameterized types (generics)</a></li>
</ul>
</li>
<li><a href="#_object_creation_lifetime">11. Object creation &amp; lifetime</a></li>
<li><a href="#_exception_handling_dealing_with_errors">12. Exception handling: dealing with errors</a></li>
<li><a href="#_concurrent_programming">13. Concurrent programming</a></li>
</ul>
</li>
<li><a href="#_everything_is_an_object">Everything Is an Object</a>
<ul class="sectlevel1">
<li><a href="#_you_manipulate_objects_with_references">14. You manipulate objects with references</a></li>
<li><a href="#_you_must_create_all_the_objects">15. You must create all the objects</a>
<ul class="sectlevel2">
<li><a href="#_where_storage_lives">15.1. Where storage lives</a></li>
<li><a href="#_special_case_primitive_types">15.2. Special case: primitive types</a></li>
<li><a href="#_high_precision_numbers">15.3. High-precision numbers</a></li>
<li><a href="#_arrays_in_java">15.4. Arrays in Java</a></li>
</ul>
</li>
<li><a href="#_you_never_need_to_destroy_an_object">16. You never need to destroy an object</a>
<ul class="sectlevel2">
<li><a href="#_scoping">16.1. Scoping</a></li>
<li><a href="#_scope_of_objects">16.2. Scope of objects</a></li>
</ul>
</li>
<li><a href="#_creating_new_data_types_class">17. Creating new data types: class</a>
<ul class="sectlevel2">
<li><a href="#_fields_and_methods">17.1. Fields and methods</a></li>
</ul>
</li>
<li><a href="#_methods_arguments_and_return_values">18. Methods, arguments, and return values</a>
<ul class="sectlevel2">
<li><a href="#_the_argument_list">18.1. The argument list</a></li>
</ul>
</li>
<li><a href="#_building_a_java_program">19. Building a Java program</a>
<ul class="sectlevel2">
<li><a href="#_name_visibility">19.1. Name Visibility</a></li>
<li><a href="#_using_other_components">19.2. Using other components</a></li>
<li><a href="#_the_strong_static_strong_keyword">19.3. The <strong>static</strong> keyword</a></li>
</ul>
</li>
<li><a href="#_your_first_java_program">20. Your first Java program</a></li>
<li><a href="#_compiling_and_running">21. Compiling and running</a></li>
<li><a href="#_comments_and_embedded_documentation">22. Comments and embedded documentation</a>
<ul class="sectlevel2">
<li><a href="#_comment_documentation">22.1. Comment documentation</a></li>
<li><a href="#_some_example_tags">22.2. Some example tags</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_operators">Operators</a>
<ul class="sectlevel1">
<li><a href="#_simpler_print_statements">23. Simpler print statements</a></li>
<li><a href="#_using_java_operators">24. Using Java operators</a></li>
<li><a href="#_precedence">25. Precedence</a></li>
<li><a href="#_assignment">26. Assignment</a></li>
<li><a href="#_aliasing_during_method_calls">27. Aliasing during method calls</a></li>
<li><a href="#_mathematical_operators">28. Mathematical operators</a></li>
<li><a href="#_unary_minus_and_plus_operators">29. Unary minus and plus operators</a></li>
<li><a href="#_auto_increment_and_decrement">30. Auto increment and decrement</a></li>
<li><a href="#_relational_operators">31. Relational operators</a>
<ul class="sectlevel2">
<li><a href="#_testing_object_equivalence">31.1. Testing object equivalence</a></li>
</ul>
</li>
<li><a href="#_logical_operators">32. Logical operators</a>
<ul class="sectlevel2">
<li><a href="#_short_circuiting">32.1. Short-circuiting</a></li>
</ul>
</li>
<li><a href="#_literals">33. Literals</a>
<ul class="sectlevel2">
<li><a href="#_exponential_notation">33.1. Exponential notation</a></li>
</ul>
</li>
<li><a href="#_bitwise_operators">34. Bitwise operators</a></li>
<li><a href="#_shift_operators">35. Shift operators</a>
<ul class="sectlevel2">
<li><a href="#_ternary_if_else_operator">35.1. Ternary if-else operator</a></li>
</ul>
</li>
<li><a href="#_string_operator_and">36. String operator + and +=</a></li>
<li><a href="#_common_pitfalls_when_using_operators">37. Common pitfalls when using operators</a></li>
<li><a href="#_casting_operators">38. Casting operators</a>
<ul class="sectlevel2">
<li><a href="#_truncation_and_rounding">38.1. Truncation and rounding</a></li>
<li><a href="#_promotion">38.2. Promotion</a></li>
</ul>
</li>
<li><a href="#_java_has_no_sizeof">39. Java has no “sizeof”</a></li>
<li><a href="#_a_compendium_of_operators">40. A compendium of operators</a></li>
<li><a href="#_summary">41. Summary</a></li>
</ul>
</li>
<li><a href="#_controlling_execution">Controlling Execution</a>
<ul class="sectlevel1">
<li><a href="#__strong_true_strong_and_strong_false_strong">42. <strong>True</strong> and <strong>False</strong></a></li>
<li><a href="#__strong_if_else_strong">43. <strong>if-else</strong></a></li>
<li><a href="#_iteration">44. Iteration</a>
<ul class="sectlevel2">
<li><a href="#_the_comma_operator">44.1. The comma operator</a></li>
</ul>
</li>
<li><a href="#_foreach_syntax">45. Foreach Syntax</a></li>
<li><a href="#__strong_return_strong">46. <strong>return</strong></a></li>
<li><a href="#__strong_break_strong_and_strong_continue_strong">47. <strong>break</strong> and <strong>continue</strong></a></li>
<li><a href="#_the_infamous_goto">48. The infamous “goto”</a></li>
<li><a href="#_switch">49. switch</a></li>
<li><a href="#_summary_2">50. Summary</a></li>
</ul>
</li>
<li><a href="#_initialization_cleanup">Initialization &amp; Cleanup</a>
<ul class="sectlevel1">
<li><a href="#_guaranteed_initialization_with_the_constructor">51. Guaranteed initialization with the constructor</a></li>
<li><a href="#_method_overloading">52. Method overloading</a></li>
<li><a href="#_default_constructors">53. Default constructors</a></li>
<li><a href="#_the_strong_this_strong_keyword">54. The <strong>this</strong> keyword</a>
<ul class="sectlevel2">
<li><a href="#_calling_constructors_from_constructors">54.1. Calling constructors from constructors</a></li>
<li><a href="#_the_meaning_of_static">54.2. The meaning of static</a></li>
</ul>
</li>
<li><a href="#_cleanup_finalization_and_garbage_collection">55. Cleanup: finalization and garbage collection</a></li>
<li><a href="#_enumerated_types">56. Enumerated types</a></li>
</ul>
</li>
<li><a href="#_accesscontrol">AccessControl</a>
<ul class="sectlevel1">
<li><a href="#_package_the_library_unit">57. package: the library unit</a>
<ul class="sectlevel2">
<li><a href="#_code_organization">57.1. Code organization</a></li>
<li><a href="#_java_access_specfiers">57.2. Java Access specfiers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_reusing_class">Reusing Class</a>
<ul class="sectlevel1">
<li><a href="#_final_keyword">58. Final KeyWord</a>
<ul class="sectlevel2">
<li><a href="#_final_data">58.1. final data</a></li>
<li><a href="#_blank_finals">58.2. Blank finals</a></li>
<li><a href="#_final_arguments">58.3. final arguments</a></li>
<li><a href="#_final_methods">58.4. final methods</a></li>
<li><a href="#_final_and_private">58.5. final and private</a></li>
<li><a href="#_final_classes">58.6. final classes</a></li>
<li><a href="#_final_caution">58.7. final caution</a></li>
</ul>
</li>
<li><a href="#_initialization_and_class_loading">59. Initialization and class loading</a></li>
</ul>
</li>
<li><a href="#_polymorphism">Polymorphism</a>
<ul class="sectlevel1">
<li><a href="#_method_call_binding">60. Method-call binding</a></li>
<li><a href="#_constructors_and_polymorphism">61. Constructors and polymorphism</a></li>
<li><a href="#_可变的返回类型">62. 可变的返回类型</a></li>
</ul>
</li>
<li><a href="#_interfaces">Interfaces</a>
<ul class="sectlevel1">
<li><a href="#_extending_an_interface_with_inheritance">63. Extending an interface with inheritance</a></li>
<li><a href="#_fields_in_interfaces">64. Fields in interfaces</a></li>
<li><a href="#_nesting_interfaces">65. Nesting interfaces</a></li>
<li><a href="#_interfaces_and_factories">66. Interfaces and factories</a></li>
</ul>
</li>
<li><a href="#_innerclasses">InnerClasses</a>
<ul class="sectlevel1">
<li><a href="#_creating_inner_classes">67. Creating inner classes</a></li>
<li><a href="#_the_link_to_the_outer_class">68. The link to the outer class</a></li>
<li><a href="#_using_this_and_new">69. Using .this and .new</a>
<ul class="sectlevel2">
<li><a href="#__this">69.1. .this</a></li>
<li><a href="#__new">69.2. .new</a></li>
</ul>
</li>
<li><a href="#_inner_classes_and_upcasting">70. Inner classes and upcasting</a></li>
<li><a href="#_inner_classes_in_methods_and_scopes">71. Inner Classes in methods and scopes</a></li>
<li><a href="#_anonymous_inner_classes">72. Anonymous inner classes</a>
<ul class="sectlevel2">
<li><a href="#_作为返回值返回匿名内部类">72.1. 作为返回值返回匿名内部类</a></li>
<li><a href="#_传入构造函数参数给匿名内部类">72.2. 传入构造函数参数给匿名内部类</a></li>
<li><a href="#_传参初始化匿名内部的成员变量">72.3. 传参初始化匿名内部的成员变量</a></li>
<li><a href="#_匿名内部类的构造函数">72.4. 匿名内部类的构造函数</a></li>
<li><a href="#_匿名内部类构造初始化">72.5. 匿名内部类构造初始化</a></li>
</ul>
</li>
<li><a href="#_factory_method_revisited">73. Factory Method revisited</a></li>
<li><a href="#_nested_classes_静态内部类">74. Nested classes（静态内部类）</a>
<ul class="sectlevel2">
<li><a href="#_classes_inside_interfaces">74.1. Classes inside interfaces</a></li>
<li><a href="#_reaching_outward_from_a_multiply_nested_class">74.2. Reaching outward from a multiply nested class</a></li>
</ul>
</li>
<li><a href="#_why_inner_classes">75. Why inner classes?</a></li>
<li><a href="#_inheriting_from_inner_class">76. Inheriting from inner class</a></li>
<li><a href="#_can_inner_classes_be_overridden">77. Can inner classes be overridden?</a></li>
<li><a href="#_inner_class_identifiers">78. Inner-class identifiers</a></li>
</ul>
</li>
<li><a href="#_holding_your_objects">Holding Your Objects</a>
<ul class="sectlevel1">
<li><a href="#_adding_groups_of_elements">79. Adding groups of elements</a>
<ul class="sectlevel2">
<li><a href="#_arrays_aslist">79.1. Arrays.asList</a></li>
</ul>
</li>
<li><a href="#_printing_containers">80. Printing containers</a></li>
<li><a href="#_list">81. List</a></li>
<li><a href="#_iterator">82. Iterator</a>
<ul class="sectlevel2">
<li><a href="#_listiterator">82.1. ListIterator</a></li>
</ul>
</li>
<li><a href="#_linkedlist">83. LinkedList</a></li>
<li><a href="#_stack">84. Stack</a></li>
<li><a href="#_set">85. Set</a></li>
<li><a href="#_map">86. Map</a></li>
<li><a href="#_queue">87. Queue</a>
<ul class="sectlevel2">
<li><a href="#_priorityqueue">87.1. PriorityQueue</a></li>
</ul>
</li>
<li><a href="#_collection_vs_iterator">88. Collection vs. Iterator</a></li>
<li><a href="#_foreach_and_iterators">89. Foreach and iterators</a>
<ul class="sectlevel2">
<li><a href="#_the_adapter_method_idiom">89.1. The Adapter Method idiom</a></li>
</ul>
</li>
<li><a href="#_summary_3">90. Summary</a></li>
</ul>
</li>
<li><a href="#_error_handling_with_exceptions">Error Handling with Exceptions</a>
<ul class="sectlevel1">
<li><a href="#_concepts">91. Concepts</a></li>
<li><a href="#_finally">92. finally</a>
<ul class="sectlevel2">
<li><a href="#_异常丢失情况">92.1. 异常丢失情况</a></li>
</ul>
</li>
<li><a href="#_exception_restrictions">93. Exception restrictions</a></li>
<li><a href="#_constuctors">94. Constuctors</a></li>
<li><a href="#_exception_guidelines">95. Exception GuideLines</a></li>
</ul>
</li>
<li><a href="#_strings">Strings</a>
<ul class="sectlevel1">
<li><a href="#_immutable_strings">96. Immutable Strings</a></li>
<li><a href="#_overloading_vs_stringbuilder">97. Overloading ‘+’ vs. StringBuilder</a></li>
<li><a href="#_unintended_recursion">98. Unintended recursion</a></li>
<li><a href="#_string_intern">99. String.intern()</a></li>
<li><a href="#_formating_output">100. Formating output</a>
<ul class="sectlevel2">
<li><a href="#_formatter_class">100.1. Formatter class</a></li>
<li><a href="#_format_specifiers">100.2. Format specifiers</a></li>
<li><a href="#_formatter_conversions">100.3. Formatter conversions</a></li>
<li><a href="#_string_format">100.4. String.format()</a>
<ul class="sectlevel3">
<li><a href="#_a_hex_dump_tool">100.4.1. A hex dump tool</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_scanning_input">101. Scanning Input</a>
<ul class="sectlevel2">
<li><a href="#_scanner_delimiters">101.1. Scanner Delimiters</a></li>
<li><a href="#_scanning_with_regular_expressions">101.2. Scanning with regular expressions</a></li>
</ul>
</li>
<li><a href="#_stringtokenizer">102. StringTokenizer</a></li>
</ul>
</li>
<li><a href="#_regularexpression">RegularExpression</a>
<ul class="sectlevel1">
<li><a href="#_基本使用">103. 基本使用</a>
<ul class="sectlevel2">
<li><a href="#_string_matches">103.1. String.Matches</a></li>
<li><a href="#_string_split">103.2. String.split</a></li>
</ul>
</li>
<li><a href="#_正则规则">104. 正则规则</a></li>
<li><a href="#_转义符">105. 转义符</a></li>
<li><a href="#_字符类">106. 字符类</a></li>
<li><a href="#_行终止符">107. 行终止符</a></li>
<li><a href="#_分组与捕捉">108. 分组与捕捉</a>
<ul class="sectlevel2">
<li><a href="#_分组序号">108.1. 分组序号</a></li>
<li><a href="#_分组名称">108.2. 分组名称</a></li>
</ul>
</li>
<li><a href="#_回溯引用">109. 回溯引用</a>
<ul class="sectlevel2">
<li><a href="#_使用示例">109.1. 使用示例</a></li>
</ul>
</li>
<li><a href="#_零宽断言_预搜索_预匹配">110. 零宽断言（预搜索、预匹配）</a>
<ul class="sectlevel2">
<li><a href="#_使用示例_2">110.1. 使用示例</a></li>
</ul>
</li>
<li><a href="#_量词">111. 量词</a>
<ul class="sectlevel2">
<li><a href="#_使用示例_3">111.1. 使用示例</a></li>
</ul>
</li>
<li><a href="#_行终止符_2">112. 行终止符</a>
<ul class="sectlevel2">
<li><a href="#_使用示例_4">112.1. 使用示例</a>
<ul class="sectlevel3">
<li><a href="#__b">112.1.1. \b</a></li>
<li><a href="#_其它终止符">112.1.2. 其它终止符</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_逻辑操作符">113. 逻辑操作符</a>
<ul class="sectlevel2">
<li><a href="#_使用示例_5">113.1. 使用示例</a></li>
</ul>
</li>
<li><a href="#_charsequence">114. CharSequence</a></li>
<li><a href="#_pattern_and_matcher">115. Pattern and Matcher</a>
<ul class="sectlevel2">
<li><a href="#_matches_与_lookingat">115.1. Matches() 与 LookingAt()</a></li>
<li><a href="#_find">115.2. find()</a></li>
<li><a href="#_groups">115.3. Groups</a></li>
<li><a href="#_start_end">115.4. start() , end()</a></li>
</ul>
</li>
<li><a href="#_match_flags">116. match flags</a></li>
<li><a href="#_split">117. Split()</a></li>
<li><a href="#_replace">118. Replace</a></li>
<li><a href="#_reset">119. reset</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="_introduction_to_objects" class="sect0"><a class="anchor" href="#_introduction_to_objects"></a>Introduction to Objects</h1>
<div class="openblock partintro">
<div class="content">
本章为背景和补充资料，因为很多人并不了解 <em>OOP</em> 。本章主要讲解面对对象编程的一些基本概念，以及为什么需要面向对象编程及其重要性。你可以跳过本章节，但是还是建议补充一下 <em>OOP</em> 的基本知识。
</div>
</div>
<div class="sect1">
<h2 id="_the_progress_of_abstraction"><a class="anchor" href="#_the_progress_of_abstraction"></a>1. The progress of abstraction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>所有的编程语言都提供了抽象。汇编语言是底层计算机器指令的抽象，而 <em>C</em> 等语言则是汇编语言的抽象。虽然 <em>C</em> 语言极大地抽象了汇编语言的复杂操作，但是它还是需要你思考计算机的结构而不是思考真正要解决的问题的结构。编程者往往需要在计算机模型与问题模型间建立联系。</p>
</div>
<div class="paragraph">
<p>面向对象在问题领域提供了进一步的工具来表示这些问题。将问题领域中的元素理解为对象。所以出现了新的问题元素时只是需要添加新的类型的对象即可。</p>
</div>
<div class="paragraph">
<p><strong><em>Alan Kay</em></strong> 总结了面向对象的五个特性。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Everything is an object</strong> .你可以将对象视为一个奇特的变量，它不仅可以存储数据，还可以请求它来执行方法。理论上，在你所解决的问题中，所有组件你都可以抽象为对象。</p>
</li>
<li>
<p><strong>A program is a bunch of objects telling each other what to do by
sending messages</strong> .即一个程序可以理解为一组互相彼此通讯的对象。</p>
</li>
<li>
<p><strong>Each object has its own memory made up of other objects</strong> .换句话说，就是通过组织现的一些对象，来构建新的对象。这样，可以把复杂的程序对象隐藏在一引简单的对象后面，用户只需要知道这个简单的对象即可。</p>
</li>
<li>
<p><strong>Every object has a type</strong> . 每一个对象都是一个类的实例，类又可以说是 <em>type</em> 的同义词。区别一个类的最重要的特征是"<code>What messages can you send to it?</code>"</p>
</li>
<li>
<p><strong>All objects of a particular type can receive the same messages</strong> .例如，圆这个类的对象同时也是 <em>Shape</em> 这个类的对象，圆可以接受 <em>Shape</em> 的消息。大致就是子类继承父类的行为和特性吧。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>Booch</em></strong> 提出了对 <strong>对象</strong> 更简洁的描述</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><em>An object has state, behavior and identity.</em></p>
</div>
</div>
</div>
<div class="paragraph">
<p>这就是说，每一个对象有其内部数据（描述对象的状态）和方法（即对象的行为），并且每一个对象都有别于其它对象，因为每个对象的内存地址是唯一的。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_an_object_has_an_interface"><a class="anchor" href="#_an_object_has_an_interface"></a>2. An object has an interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Aristotle</em> 可能是第一个开始学习研究 <em>type</em> 这个概念的人了。他提出，所有的 <em>class</em> 是一个唯一的类型，也是其它拥有通用特征与行为的 <em>class</em> 的子类型。</p>
</div>
<div class="paragraph">
<p>在面向对象中，创建基础的数据类型 <em>class</em> 是一个基本概念。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_an_object_provides_services"><a class="anchor" href="#_an_object_provides_services"></a>3. An object provides services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>如果你想开发或理解一个程序设计，最好的方式是将 <em>objects</em> 想象成 "<code>service providers</code>" 。你的程序通过调用提供服务的 <em>object</em> 来为用户提供服务。所以编程者只需要编写一系统提供服务的 <em>object</em> 即可。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_hidden_implementation"><a class="anchor" href="#_the_hidden_implementation"></a>4. The hidden implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>隐藏具体实现可以减少程序bug。通过访问控制来达到这个目标。
<em>Java</em> 使用了3个明确的访问修饰符 <strong><em>public</em></strong> <strong><em>private</em></strong> <strong><em>protected</em></strong> 来做访问控制。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">public</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">所有人可以访问</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">只自己可以访问</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">protected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">子类可以访问</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">同一包内可以访问</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_reusing_the_implementation"><a class="anchor" href="#_reusing_the_implementation"></a>5. Reusing the implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>优先使用组合来达到复用的目的，其次再考虑继承。组合更能弹性扩展。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inheritance"><a class="anchor" href="#_inheritance"></a>6. Inheritance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>继承好处，父类中的成员或方法改变，子类使用时也会改变。子类可以添加自己独特的方法或者重写父类已有的方法。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_is_a_vs_is_like_a_relationships"><a class="anchor" href="#_is_a_vs_is_like_a_relationships"></a>7. Is-a vs. is-like-a relationships</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Is-a 通常指的是继承关系， is-like-a 则指继承后在子类添加了新的方法。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/is_a.png" alt="is a">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interchangeable_objects_with_polymorphism"><a class="anchor" href="#_interchangeable_objects_with_polymorphism"></a>8. Interchangeable objects with polymorphism</h2>
<div class="sectionbody">
<div class="paragraph">
<p>编码时，依赖于抽象类型，而非具体类型。多态时，会发生向上转换 <em>upcast</em> ，编译器编译时是以基类型进行编译的，而在运行时以具体子类型 <em>upcast</em> 再调用的。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_singly_rooted_hierarchy"><a class="anchor" href="#_the_singly_rooted_hierarchy"></a>9. The singly rooted hierarchy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>单根继承。所有的 <em>objects</em> 继承自基类 <strong><em>Object</em></strong> . 所有对象都是 <em>Object</em> 的好处就是，可以为所有的对象添加一些基本操作，也方便传参。</p>
</div>
<div class="paragraph">
<p>单根继承，可以让垃圾收集器实现起来更容易些。而且你从来都不会无法确定一个对象的类型，在异常处理等方面很有帮助。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_containers"><a class="anchor" href="#_containers"></a>10. Containers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>容器，即Array，List,Map之类的。</p>
</div>
<div class="sect2">
<h3 id="_parameterized_types_generics"><a class="anchor" href="#_parameterized_types_generics"></a>10.1. Parameterized types (generics)</h3>
<div class="paragraph">
<p>Java SE<sub>5</sub> 以前，容器只存储一个类型，即 <em>Object</em> 类型。因为所有类型都是 <em>Object</em> 类型的子类，所以容器就可以存储所有类型的对象。 这种情况就会出现 <em>upcast</em> 和 <em>downcasting</em> 的情况，即装箱和拆箱。</p>
</div>
<div class="paragraph">
<p>此时如果 <em>downcasting</em> 错误后，就会出现运行时异常。</p>
</div>
<div class="paragraph">
<p>JavaSE<sub>5</sub> 中出现了参数化类型，称为泛型。容器在编译时即知道它所装的对象的类型。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">Shape</span>&gt; shapeList = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">Shape</span>&gt;();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_object_creation_lifetime"><a class="anchor" href="#_object_creation_lifetime"></a>11. Object creation &amp; lifetime</h2>
<div class="sectionbody">
<div class="paragraph">
<p>使用 <em>gc</em> 来完成垃圾收集。而 <em>C++</em> 则需要手动释放。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exception_handling_dealing_with_errors"><a class="anchor" href="#_exception_handling_dealing_with_errors"></a>12. Exception handling: dealing with errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>尽管异常处理中通常把异常表示为一个对象，但是异常处理并不是一个 <em>OOP</em> 的特征。异常处理出现地比 <em>OOP</em> 早。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concurrent_programming"><a class="anchor" href="#_concurrent_programming"></a>13. Concurrent programming</h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_everything_is_an_object" class="sect0"><a class="anchor" href="#_everything_is_an_object"></a>Everything Is an Object</h1>
<div class="openblock partintro">
<div class="content">
Although it is based on C++, Java is more of a “pure” object-oriented
language.
</div>
</div>
<div class="sect1">
<h2 id="_you_manipulate_objects_with_references"><a class="anchor" href="#_you_manipulate_objects_with_references"></a>14. You manipulate objects with references</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>objects</em> 的操作都是以引用进行操作的。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_you_must_create_all_the_objects"><a class="anchor" href="#_you_must_create_all_the_objects"></a>15. You must create all the objects</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> s = <span class="keyword">new</span> <span class="predefined-type">String</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">asdf</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_where_storage_lives"><a class="anchor" href="#_where_storage_lives"></a>15.1. Where storage lives</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Registers</strong>. 寄存器。存储读写速度快，因为它在处理器中。但是数量极其有限，所以这里的空间也是按需分配。你不能直接控制这里的空间分配，而且在程序中也感觉不到这片空间的存在。</p>
</li>
<li>
<p><strong>The Stack</strong>. 栈空间。这片区域在 <strong><em>RAM</em></strong> (<em>Random Access Memory</em>) 中，它可以从处理器中直接通过 <em>stack pointer</em> 进行控制。栈指针向下移动则分配空间，向上移动则释放那些已分配的空间。这是一个快速有效的分配存储方法，仅次于 <strong>Registers</strong> 。在创建程序时， <em>JAVA</em> 系统必须准确地知道存储在 <em>Stack</em> 中的每一项内容的生命周期，这会限制你的程序的扩展性。所以 <em>JAVA</em> 程序在 <em>Stack</em> 中存储的是对象的引用，而对象的存储则是在 <em>Heap</em> 中。</p>
</li>
<li>
<p><strong>The Heap</strong>. 堆空间。这是一个通用的内存池（也在 <em>RAM</em> 中），这里存储了所有的 <em>Java Objects</em> 。不像 <em>Stack</em> ，编译器不需要知道 <em>Heap</em> 中的对象需要在 <em>Heap</em> 中生存多久。因此，在 <em>Heap</em> 上存储将会很有扩展性。在 <em>Heap</em> 上分配空间，只需要 <em>new</em> 一下就 <em>Ok</em> 了。当然，这种很好的扩展性也是有代价的，比 <em>stack</em> 在分配和清理空间时需要更多的时间。</p>
</li>
<li>
<p><strong>Constant storage</strong>. 常量存储(常量池)。常量值通常直接存放在程序代码中，因为它的值永远不会改变所以这是安全的。有时在嵌入式系统中，也会单独把常量值放在 <a href="http://baike.baidu.com/link?url=QAK3xw_Sh0jPOVMyJ3xQh-my_XBYIgRHZ_CRf0Ex99DxvypzwzZMr4Yn9-9QqxNPHSnR4yeyUxfsGY1fbASTua"> <em>ROM</em> </a> 中。</p>
</li>
<li>
<p><strong>Non-RAM storage</strong>. 非 <em>RAM</em> 存储。如果数据可以独立于程序存储，那么它就可以在程序没有运行时存在。这其中主要的两个例子是 <strong>流对象</strong> 和 <strong>持久化对象</strong> 。 <em>Stream Objects</em> 通常被转换为 <em>bytes</em> 然后传输给其它的机器。 <em>persistent objects</em> 通常是将对象及其状态存储到硬盘上。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_special_case_primitive_types"><a class="anchor" href="#_special_case_primitive_types"></a>15.2. Special case: primitive types</h3>
<div class="paragraph">
<p>基类型是存储在 <em>stack</em> 上的，它直接指向了其值。而 <em>new</em> 出来的对象是在 <em>heap</em> 上的，由 <em>stack</em> 上的 <em>reference</em> 指向 <em>heap</em> 上的 <em>object</em> 。</p>
</div>
<div class="paragraph">
<p><em>Java</em> 明确定义了每一种基类型的 <em>size</em> ，而且在不同的机器架构上，这个 <em>size</em> 都不会变。其它语言可能不是这样的哦。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/types.png" alt="types">
</div>
</div>
<div class="paragraph">
<p><strong>boolean</strong> 类型是没有明确指定 <em>size</em> 的，因为它只会有 <em>true</em> 和 <em>false</em> 两个字面量值。</p>
</div>
<div class="paragraph">
<p><strong>包装类型</strong> 是存储在 <em>heap</em> 上的对象，它是对应的 <strong>基类型</strong> 的对象表现形式。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">char</span> c = <span class="error">‘</span>x<span class="error">’</span>;
<span class="predefined-type">Character</span> ch = <span class="keyword">new</span> <span class="predefined-type">Character</span>(c);

<span class="predefined-type">Character</span> ch = <span class="keyword">new</span> <span class="predefined-type">Character</span>(<span class="error">‘</span>x<span class="error">’</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>JavaSE<sub>5</sub> 的自动装箱能自动将 <strong>基类型</strong> 转为 <strong>包装类型</strong>，也能自动将 <strong>包装类型</strong> 转为 <strong>基类型</strong> 。</p>
</div>
</div>
<div class="sect2">
<h3 id="_high_precision_numbers"><a class="anchor" href="#_high_precision_numbers"></a>15.3. High-precision numbers</h3>
<div class="paragraph">
<p><em>Java</em> 提供了高精确的两种类型。 <strong><em>BigInteger</em></strong> 和 <strong><em>BigDecimal</em></strong></p>
</div>
<div class="paragraph">
<p><strong><em>BigInteger</em></strong> 支持任意精度的整数</p>
</div>
<div class="paragraph">
<p><strong><em>BigDecimal</em></strong> 可以支持货币运算</p>
</div>
</div>
<div class="sect2">
<h3 id="_arrays_in_java"><a class="anchor" href="#_arrays_in_java"></a>15.4. Arrays in Java</h3>
<div class="paragraph">
<p><em>Java</em> 中的数组是不能越界访问的，相对于 <em>C</em> 和 <em>C++</em> 是非常安全的。为了确保这种数组的范围检查，这需要在每一个数组上有一点额外的内存开销用于在运行时验证 <em>position</em> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Integer</span><span class="type">[]</span> arr = <span class="keyword">new</span> <span class="predefined-type">Integer</span>[<span class="integer">5</span>]; <img src="./images/icons/callouts/1.png" alt="1">
<span class="type">int</span> <span class="type">[]</span> arr2 = <span class="keyword">new</span> <span class="type">int</span>[<span class="integer">5</span>]; <img src="./images/icons/callouts/2.png" alt="2"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>初始化数组后，其中存储的全是空引用。即引用指向了 <em>null</em> 。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>将使用 <em>int</em> 的默认值进行初始化。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_you_never_need_to_destroy_an_object"><a class="anchor" href="#_you_never_need_to_destroy_an_object"></a>16. You never need to destroy an object</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Java</em> 简化了对象销毁操作，不再需要手动释放。</p>
</div>
<div class="sect2">
<h3 id="_scoping"><a class="anchor" href="#_scoping"></a>16.1. Scoping</h3>
<div class="paragraph">
<p>大多数程序语言都有一个 <em>scope</em> 的概念。 <em>scope</em> 也就决定了定义在 <em>scope</em> 中的变量的可见性与有效期。<em>Java</em> 中 <em>scope</em> 使用 <code>{}</code> 来定义。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">{
  <span class="type">int</span> x = <span class="integer">12</span>;
  <span class="comment">// Only x available</span>
  {
    <span class="type">int</span> q = <span class="integer">96</span>;
    <span class="comment">// Both x &amp; q available</span>
  }
  <span class="comment">// Only x available</span>
  <span class="comment">// q is &quot;out of scope&quot;</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scope_of_objects"><a class="anchor" href="#_scope_of_objects"></a>16.2. Scope of objects</h3>
<div class="paragraph">
<p><em>Java Objects</em> 的生命周期并不同于普通的基类型。</p>
</div>
<div class="listingblock">
<div class="title">example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">{
  <span class="predefined-type">String</span> s = <span class="keyword">new</span> <span class="predefined-type">String</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">a string</span><span class="delimiter">&quot;</span></span>);
} <span class="comment">// End Of Scope</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>引用 <em>s</em> 会在这个 <em>scope</em> 结束后消失。然后这个 <em>String</em> 对象却不会立即消失，它将存放在  <em>memory</em> 中。</p>
</div>
<div class="paragraph">
<p><em>Java</em> 使用 <em>garbage collector</em> 来回收 <em>Object</em> 。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_new_data_types_class"><a class="anchor" href="#_creating_new_data_types_class"></a>17. Creating new data types: class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>使用 <em>class</em> 关键字来创建一个类。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">ATypeName</span> { <span class="comment">/* Class body goes here */</span> }</code></pre>
</div>
</div>
<div class="paragraph">
<p>创建了类后，可以使用 <em>new</em> 创建该类的对象</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ATypeName a = <span class="keyword">new</span> ATypeName();</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_fields_and_methods"><a class="anchor" href="#_fields_and_methods"></a>17.1. Fields and methods</h3>
<div class="paragraph">
<p>定义了一个 <em>class</em> 后，你可以添加 <em>fileds</em> 与 <em>methods</em> 到 <em>class</em> 中。</p>
</div>
<div class="paragraph">
<p>每一个 <em>object</em> 都单独存储它的 <em>fields</em> ，而且普通的 <em>fileds</em> 是不会在各个 <em>objects</em> 之间进行共享的。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">DataOnly</span> {
  <span class="type">int</span> i;
  <span class="type">double</span> d;
  <span class="type">boolean</span> b;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">引用成员变量</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataOnly data = <span class="keyword">new</span> DataOnly();
data.i = <span class="integer">47</span>;
data.d = <span class="float">1.1</span>;
data.b = <span class="predefined-constant">false</span>;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_methods_arguments_and_return_values"><a class="anchor" href="#_methods_arguments_and_return_values"></a>18. Methods, arguments, and return values</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ReturnType methodName( <span class="comment">/* Argument list */</span> ) {
  <span class="comment">/* Method body */</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>除静态方法外， <em>method</em> 只能被 <em>object</em> 调用。<em>static method</em> 可以被 <em>class</em> 调用。</p>
</div>
<div class="sect2">
<h3 id="_the_argument_list"><a class="anchor" href="#_the_argument_list"></a>18.1. The argument list</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> storage(<span class="predefined-type">String</span> s) { <img src="./images/icons/callouts/1.png" alt="1">
  <span class="keyword">return</span> s.length() * <span class="integer">2</span>; <img src="./images/icons/callouts/2.png" alt="2">
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>传入的参数列表</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>返回值，为表达式则为计算后的值。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_a_java_program"><a class="anchor" href="#_building_a_java_program"></a>19. Building a Java program</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在构建一个 <em>java program</em> 之前需要理解一些概念。</p>
</div>
<div class="sect2">
<h3 id="_name_visibility"><a class="anchor" href="#_name_visibility"></a>19.1. Name Visibility</h3>
<div class="paragraph">
<p>为了避免命令重复， <em>java</em> 使用完全限定名： <code>packagename + class name</code> 。 <em>package name</em> 通常为域名的倒写。例如 <code>com.dameng.core</code> ，且包名只能小写。</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_other_components"><a class="anchor" href="#_using_other_components"></a>19.2. Using other components</h3>
<div class="paragraph">
<p>使用 <em>import</em> 关键字可以引用其它的包。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.ArrayList</span>; <img src="./images/icons/callouts/1.png" alt="1">

<span class="keyword">import</span> <span class="include">java.util</span>.*; <img src="./images/icons/callouts/2.png" alt="2"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>完全限定名引用一个类</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>引用 <em>java.util.*</em> 下的所有类</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_the_strong_static_strong_keyword"><a class="anchor" href="#_the_strong_static_strong_keyword"></a>19.3. The <strong>static</strong> keyword</h3>
<div class="paragraph">
<p>一般情况下，使用 <em>new</em> 来创建一个对象，此时就会分配一个单独的空间给该对象。有时并不需要说非得要 <em>new</em> 一个对象才能使用某一个特定的 <em>filed</em> 或者 <em>method</em> 。此时就需要使用 <em>static</em> 关键字了。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">StaticTest</span> {
  <span class="directive">static</span> <span class="type">int</span> i = <span class="integer">47</span>;
}

StaticTest st1 = <span class="keyword">new</span> StaticTest(); <img src="./images/icons/callouts/1.png" alt="1">
StaticTest st2 = <span class="keyword">new</span> StaticTest();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>哪怕创建多个 <em>StaticTest</em> 的对象，也只会为静态的 <em>field</em> <em>i</em> 分配一份内存空间。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_your_first_java_program"><a class="anchor" href="#_your_first_java_program"></a>20. Your first Java program</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">first java program</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// HelloDate.java</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloDate</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, it’s: </span><span class="delimiter">&quot;</span></span>);
    <span class="predefined-type">System</span>.out.println(<span class="keyword">new</span> <span class="predefined-type">Date</span>()); <img src="./images/icons/callouts/1.png" alt="1">
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>将 <em>new</em> 出的 <em>date</em> 对象转换为 <em>String</em> 再输出。</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution">
</td>
<td class="content">
<div class="paragraph">
<p>默认情况下，所有的 <em>java</em> 文件，都会自动导入 <em>java.lang</em> 包，哪怕你没有显示地指定。所以你可以不导 <em>java.lang</em> 包就能使用 <em>System</em> 类了。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">main 方法说明</div>
<div class="listingblock">
<div class="title">main method</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
  <span class="comment">// method body</span>
}</code></pre>
</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
public
</td>
<td class="hdlist2">
<p>访问修饰符，必须为 <strong>public</strong> 。</p>
</td>
</tr>
<tr>
<td class="hdlist1">
static
</td>
<td class="hdlist2">
<p>静态修饰符，必须为 <strong>static</strong> 。</p>
</td>
</tr>
<tr>
<td class="hdlist1">
void
</td>
<td class="hdlist2">
<p>返回类型</p>
</td>
</tr>
<tr>
<td class="hdlist1">
main
</td>
<td class="hdlist2">
<p>方法名称，必须为 <strong>main</strong> 。</p>
</td>
</tr>
<tr>
<td class="hdlist1">
args
</td>
<td class="hdlist2">
<p>参数列表，这里指接受的 <em>command line</em> 的参数。</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compiling_and_running"><a class="anchor" href="#_compiling_and_running"></a>21. Compiling and running</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">javac HelloDate.java
java HelloDate</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_embedded_documentation"><a class="anchor" href="#_comments_and_embedded_documentation"></a>22. Comments and embedded documentation</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/* This is a comment
* that continues
* across lines
*/</span>   <img src="./images/icons/callouts/1.png" alt="1">

<span class="comment">// This is a one-line comment </span> <img src="./images/icons/callouts/2.png" alt="2"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>多行注释</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>单行注释</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_comment_documentation"><a class="anchor" href="#_comment_documentation"></a>22.1. Comment documentation</h3>
<div class="paragraph">
<p>使用 <em>javadoc</em> 命令可以提取出文档注释。</p>
</div>
</div>
<div class="sect2">
<h3 id="_some_example_tags"><a class="anchor" href="#_some_example_tags"></a>22.2. Some example tags</h3>
<div class="paragraph">
<p>@See</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@see</span> classname
<span class="annotation">@see</span> fully-qualified-classname
<span class="annotation">@see</span> fully-qualified-classname<span class="error">#</span>method-name</code></pre>
</div>
</div>
<div class="paragraph">
<p>{@link package.class#member label}</p>
</div>
<div class="paragraph">
<p>{@docRoot}</p>
</div>
<div class="paragraph">
<p>{@inheritDoc}</p>
</div>
<div class="paragraph">
<p>@version</p>
</div>
<div class="paragraph">
<p>@author</p>
</div>
<div class="paragraph">
<p>@since</p>
</div>
<div class="paragraph">
<p>@param</p>
</div>
<div class="paragraph">
<p>@return</p>
</div>
<div class="paragraph">
<p>@throws</p>
</div>
<div class="paragraph">
<p>@deprecated</p>
</div>
</div>
</div>
</div>
<h1 id="_operators" class="sect0"><a class="anchor" href="#_operators"></a>Operators</h1>
<div class="sect1">
<h2 id="_simpler_print_statements"><a class="anchor" href="#_simpler_print_statements"></a>23. Simpler print statements</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Rather a lot to type</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_java_operators"><a class="anchor" href="#_using_java_operators"></a>24. Using Java operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>几乎所有的操作符只适用于基本类型，只有 <code>=</code> <code>==</code> <code>!=</code> 是适用于 <em>objects</em> 的。另外 <em>String</em> 支持 <code>+</code> 和 <code>+=</code> 。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_precedence"><a class="anchor" href="#_precedence"></a>25. Precedence</h2>
<div class="sectionbody">
<div class="paragraph">
<p>操作符优先级定义了当多个操作符出现在同一表达式中时运行的先后顺序。 <em>Java</em> 有特殊的规则来定义操作符计算顺序，这其中最简单的一个规则就是 <code>*</code> 和 <code>/</code> 比 <code>+</code> 和 <code>-</code> 的优先级高。所以通常使用 <code>()</code> 来保证优先级。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/Precedence.java</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Precedence</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="type">int</span> x = <span class="integer">1</span>, y = <span class="integer">2</span>, z = <span class="integer">3</span>;
    <span class="type">int</span> a = x + y - <span class="integer">2</span>/<span class="integer">2</span> + z; <span class="comment">// (1)</span>
    <span class="type">int</span> b = x + (y - <span class="integer">2</span>)/(<span class="integer">2</span> + z); <span class="comment">// (2)</span>
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">a = </span><span class="delimiter">&quot;</span></span> + a + <span class="string"><span class="delimiter">&quot;</span><span class="content"> b = </span><span class="delimiter">&quot;</span></span> + b); <img src="./images/icons/callouts/1.png" alt="1">
  }
} <span class="comment">/* Output:
a = 5 b = 1
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>将 <code>int</code> 类型的 <em>a</em> 和 <em>b</em> 转换为了 <code>String</code> 类型，再进行字符串拼接。</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><code>System.out.println();</code> 中使用了 <code>+</code> ，这里在字符串中 <code>+</code> 就是追加的意思。另外，当编译器看到一个 <strong>String</strong> 后面和一个 <strong>非String</strong> 使用 <code>+</code> 进行连接的时候，它会把 <strong>非String</strong> 转换为 <strong>String</strong> 再进行字符串拼接操作。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assignment"><a class="anchor" href="#_assignment"></a>26. Assignment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>赋值操作是使用 <code>=</code> 操作符完成的，它的意思就是把 <code>=</code> 右边的值 <em>copy</em> 给左侧的变量。右边的值可以是 <em>constant</em> , <em>variable</em> , <em>expression</em> ，如果为静态式或变量均是计算后的值。</p>
</div>
<div class="listingblock">
<div class="title">分配常量值给变量</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">a = <span class="integer">4</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>为变量赋基本类型的值是相当容易的，因为基本类型是持有其真实的值而非一个 <strong>对象的引用</strong> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">a = <span class="integer">4</span>;
b = a; <img src="./images/icons/callouts/1.png" alt="1">

b = <span class="integer">5</span>; <img src="./images/icons/callouts/2.png" alt="2"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>就是直接把基本类型值 <code>4</code> <em>copy</em> 给变量 <em>b</em> 。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>当改变变量 <em>b</em> 的值的时候不会影响变量 <em>a</em> 的值。</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">引用复制</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/Assignment.java</span>
<span class="comment">// Assignment with objects is a bit tricky.</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="type">class</span> <span class="class">Tank</span> {
        <span class="type">int</span> level;
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">Assignment</span> {
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
                Tank t1 = <span class="keyword">new</span> Tank();
                Tank t2 = <span class="keyword">new</span> Tank();
                t1.level = <span class="integer">9</span>;
                t2.level = <span class="integer">47</span>;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">1: t1.level: </span><span class="delimiter">&quot;</span></span> + t1.level +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">, t2.level: </span><span class="delimiter">&quot;</span></span> + t2.level);
                t1 = t2;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">2: t1.level: </span><span class="delimiter">&quot;</span></span> + t1.level +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">, t2.level: </span><span class="delimiter">&quot;</span></span> + t2.level);
                t1.level = <span class="integer">27</span>;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">3: t1.level: </span><span class="delimiter">&quot;</span></span> + t1.level +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">, t2.level: </span><span class="delimiter">&quot;</span></span> + t2.level);
        }
} <span class="comment">/* Output:
1: t1.level: 9, t2.level: 47  <img src="./images/icons/callouts/1.png" alt="1">
2: t1.level: 47, t2.level: 47 <img src="./images/icons/callouts/2.png" alt="2">
3: t1.level: 27, t2.level: 27 <img src="./images/icons/callouts/3.png" alt="3">
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>直接为基本类型 <em>field</em> 赋值</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>引用赋值 <code>t1 = t2;</code> ，两个引用指向同一个 <em>object</em> ，所以输出结果一样。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>使用任一引用 <code>t1</code> 改变 <em>field</em> 值，此时改变的就是具体的 <em>object</em> 的 <em>field</em> 值。而 <code>t2</code> 也引用了同一个 <em>object</em> ，所以输出结果相同。</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>上述这种引用复制也称为 <strong><em>aliasing</em></strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aliasing_during_method_calls"><a class="anchor" href="#_aliasing_during_method_calls"></a>27. Aliasing during method calls</h2>
<div class="sectionbody">
<div class="paragraph">
<p>将一个 <em>object</em> 作为 <em>parameter</em> 传递入一个 <em>method</em> 时也会发生 <strong><em>aliasing</em></strong> 。</p>
</div>
<div class="listingblock">
<div class="title">Aliasing during method calls</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/PassObject.java</span>
<span class="comment">// Passing objects to methods may not be</span>
<span class="comment">// what you’re used to.</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="type">class</span> <span class="class">Letter</span> {
        <span class="type">char</span> c;
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">PassObject</span> {
        <span class="directive">static</span> <span class="type">void</span> f(Letter y) {
                y.c = <span class="string"><span class="delimiter">'</span><span class="content">z</span><span class="delimiter">'</span></span>;
        }
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
                Letter x = <span class="keyword">new</span> Letter();
                x.c = <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">1: x.c: </span><span class="delimiter">&quot;</span></span> + x.c);
                f(x); <img src="./images/icons/callouts/1.png" alt="1">
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">2: x.c: </span><span class="delimiter">&quot;</span></span> + x.c);
        }
} <span class="comment">/* Output:
1: x.c: a
2: x.c: z
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>在调用方法 <code>f(x)</code> 时，实际上是把引用 <em>x</em> 作为参数传递给了方法 <em>f()</em> 的形参 <em>y</em> 。此时就是一个引用复制，即 <code>y=x</code> 。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mathematical_operators"><a class="anchor" href="#_mathematical_operators"></a>28. Mathematical operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>基本的数学操作符就是。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><kbd>+</kbd></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">加号</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><kbd>-</kbd></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">减号</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><kbd>*</kbd></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">乘号</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><kbd>/</kbd></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">除号</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><kbd>%</kbd></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">取模</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">基本操作示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/MathOps.java</span>
<span class="comment">// Demonstrates the mathematical operators.</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="directive">public</span> <span class="type">class</span> <span class="class">MathOps</span> {
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
                <span class="comment">// Create a seeded random number generator:</span>
                <span class="predefined-type">Random</span> rand = <span class="keyword">new</span> <span class="predefined-type">Random</span>(<span class="integer">47</span>);
                <span class="type">int</span> i, j, k;
                <span class="comment">// Choose value from 1 to 100:</span>
                j = rand.nextInt(<span class="integer">100</span>) + <span class="integer">1</span>;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">j : </span><span class="delimiter">&quot;</span></span> + j);
                k = rand.nextInt(<span class="integer">100</span>) + <span class="integer">1</span>;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">k : </span><span class="delimiter">&quot;</span></span> + k);
                i = j + k;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">j + k : </span><span class="delimiter">&quot;</span></span> + i);
                i = j - k;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">j - k : </span><span class="delimiter">&quot;</span></span> + i);
                i = k / j;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">k / j : </span><span class="delimiter">&quot;</span></span> + i);
                i = k * j;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">k * j : </span><span class="delimiter">&quot;</span></span> + i);
                i = k % j;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">k % j : </span><span class="delimiter">&quot;</span></span> + i);
                j %= k;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">j %= k : </span><span class="delimiter">&quot;</span></span> + j);
                <span class="comment">// Floating-point number tests:</span>
                <span class="type">float</span> u, v, w; <span class="comment">// Applies to doubles, too</span>
                v = rand.nextFloat();
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">v : </span><span class="delimiter">&quot;</span></span> + v);
                w = rand.nextFloat();
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">w : </span><span class="delimiter">&quot;</span></span> + w);
                u = v + w;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">v + w : </span><span class="delimiter">&quot;</span></span> + u);
                u = v - w;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">v - w : </span><span class="delimiter">&quot;</span></span> + u);
                u = v * w;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">v * w : </span><span class="delimiter">&quot;</span></span> + u);
                u = v / w;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">v / w : </span><span class="delimiter">&quot;</span></span> + u);
                <span class="comment">// The following also works for char,</span>
                <span class="comment">// byte, short, int, long, and double:</span>
                Operators <span class="integer">67</span>
                <span class="integer">68</span> Thinking in Java Bruce Eckel
                u += v;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">u += v : </span><span class="delimiter">&quot;</span></span> + u);
                u -= v;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">u -= v : </span><span class="delimiter">&quot;</span></span> + u);
                u *= v;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">u *= v : </span><span class="delimiter">&quot;</span></span> + u);
                u /= v;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">u /= v : </span><span class="delimiter">&quot;</span></span> + u);
        }
} <span class="comment">/* Output:
j : 59
k : 56
j + k : 115
j - k : 3
k / j : 0
k * j : 3304
k % j : 56
j %= k : 3
v : 0.5309454
w : 0.0534122
v + w : 0.5843576
v - w : 0.47753322
v * w : 0.028358962
v / w : 9.940527
u += v : 10.471473
u -= v : 9.940527
u *= v : 5.2778773
u /= v : 9.940527
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unary_minus_and_plus_operators"><a class="anchor" href="#_unary_minus_and_plus_operators"></a>29. Unary minus and plus operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>一元操作符， <code>+</code> 和 <code>-</code> 。其实一元的 <code>+</code> 和 <code>-</code> 同二元的在运算上没有什么区别。编译器根据你填写的表达式认定你的是一元的还是二元的。</p>
</div>
<div class="listingblock">
<div class="title">minus and plus operators</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">x = -a; <img src="./images/icons/callouts/1.png" alt="1">

x = a * -b; <img src="./images/icons/callouts/2.png" alt="2">

x = a * (-b); <img src="./images/icons/callouts/3.png" alt="3"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>很明显的一元操作符。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>这种写法会让人困惑，所以通常是第3种写法。</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>一元的 <code>+</code> 没什么用，这里只是为了与一元的 <code>-</code> 对称引进来的。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auto_increment_and_decrement"><a class="anchor" href="#_auto_increment_and_decrement"></a>30. Auto increment and decrement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>自加自减操作符。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>++</code> 自加1</p>
</li>
<li>
<p><code>--</code> 自减1</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">desc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">解释</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">++a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-increment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">先自加1，再进行运算</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a++</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-increment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">先运算，再自加1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-decrement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">先自减1，再运算</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a--</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-decrement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">先运算，再自减1</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">auto increment and decrement example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/AutoInc.java</span>
<span class="comment">// Demonstrates the ++ and -- operators.</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="directive">public</span> <span class="type">class</span> <span class="class">AutoInc</span> {
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
                <span class="type">int</span> i = <span class="integer">1</span>;
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i : </span><span class="delimiter">&quot;</span></span> + i);
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">++i : </span><span class="delimiter">&quot;</span></span> + ++i); <span class="comment">// Pre-increment</span>
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i++ : </span><span class="delimiter">&quot;</span></span> + i++); <span class="comment">// Post-increment</span>
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i : </span><span class="delimiter">&quot;</span></span> + i);
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">--i : </span><span class="delimiter">&quot;</span></span> + --i); <span class="comment">// Pre-decrement</span>
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i-- : </span><span class="delimiter">&quot;</span></span> + i--); <span class="comment">// Post-decrement</span>
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i : </span><span class="delimiter">&quot;</span></span> + i);
        }
} <span class="comment">/* Output:
i : 1
++i : 2
i++ : 2
i : 3
--i : 2
i-- : 2
i : 1
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">小段子</div>
<div class="paragraph">
<p>Bill Joy (one of the Java creators) 曾经说 <code>java=C</code><code><code>+--</code>，意思是 <em>java</em> 是 C</code>+ 减去一部分不必要且复杂的东西。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relational_operators"><a class="anchor" href="#_relational_operators"></a>31. Relational operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>比较操作符都会产生一个 <em>boolean</em> 类型的结果值。比较操作符都有</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;   小于</p>
</li>
<li>
<p>&gt;   大于</p>
</li>
<li>
<p>&lt;= 小于等于</p>
</li>
<li>
<p>&gt;=  大于等于</p>
</li>
<li>
<p>==  等于</p>
</li>
<li>
<p>!=  不等于</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>==</code> 和 <code>!=</code> 适用于所有的基本类型，但是其它几个操作符除了 <em>boolean</em> 类型的不适用外其它基本类型都适用。因为 <code>true &gt;= false</code> 这种是没有任何意义的。</p>
</div>
<div class="sect2">
<h3 id="_testing_object_equivalence"><a class="anchor" href="#_testing_object_equivalence"></a>31.1. Testing object equivalence</h3>
<div class="paragraph">
<p><code>==</code> 和 <code>!=</code> 适用于所有的 <em>objects</em> ，但是其意义是不一样的。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">所有对象</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">基本类型</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>==`和</code>!=`</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">适用，只比较引用</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">适用，比较值</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">equals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">适用，默认比较引用，覆写该方法后才能比较具体值。默认String及其它包装类覆写了equals方法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不适用</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">compare object with == !=</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/Equivalence.java</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Equivalence</span> {
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
                <span class="predefined-type">Integer</span> n1 = <span class="keyword">new</span> <span class="predefined-type">Integer</span>(<span class="integer">47</span>);
                <span class="predefined-type">Integer</span> n2 = <span class="keyword">new</span> <span class="predefined-type">Integer</span>(<span class="integer">47</span>);
                <span class="predefined-type">System</span>.out.println(n1 == n2); <img src="./images/icons/callouts/1.png" alt="1">
                <span class="predefined-type">System</span>.out.println(n1 != n2);
        }
} <span class="comment">/* Output:
false
true
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>只比较栈中的对象引用的值（真实对象的内存地址）是否相等。</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">compare object with equals</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/EqualsMethod.java</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EqualsMethod</span> {
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
                <span class="predefined-type">Integer</span> n1 = <span class="keyword">new</span> <span class="predefined-type">Integer</span>(<span class="integer">47</span>);
                <span class="predefined-type">Integer</span> n2 = <span class="keyword">new</span> <span class="predefined-type">Integer</span>(<span class="integer">47</span>);
                <span class="predefined-type">System</span>.out.println(n1.equals(n2));
                <span class="integer">70</span> Thinking in Java Bruce Eckel
        }
} <span class="comment">/* Output:
true
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">compare object with equals 2</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/EqualsMethod2.java</span>
<span class="comment">// Default equals() does not compare contents.</span>
<span class="type">class</span> <span class="class">Value</span> {
        <span class="type">int</span> i;
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">EqualsMethod2</span> {
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
                Value v1 = <span class="keyword">new</span> Value();
                Value v2 = <span class="keyword">new</span> Value();
                v1.i = v2.i = <span class="integer">100</span>;
                <span class="predefined-type">System</span>.out.println(v1.equals(v2)); <img src="./images/icons/callouts/1.png" alt="1">
        }
} <span class="comment">/* Output:
false
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>类 <em>Value</em> 需要自己 <em>override</em> <strong><em>equals()</em></strong> 方法，否则类 <strong><em>Object</em></strong> 中的 <em>equals</em> 方法默认是直接使用 <code>==</code> 比较引用。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logical_operators"><a class="anchor" href="#_logical_operators"></a>32. Logical operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>每一个逻辑关系符 <em>AND</em> (&amp;&amp;) <em>OR</em> (||) <em>NOT</em> (!) 都会基于其参数产生一个 <em>boolean</em> 值。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/Bool.java</span>
<span class="comment">// Relational and logical operators.</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="directive">public</span> <span class="type">class</span> <span class="class">Bool</span> {
<span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Random</span> rand = <span class="keyword">new</span> <span class="predefined-type">Random</span>(<span class="integer">47</span>);
        <span class="type">int</span> i = rand.nextInt(<span class="integer">100</span>);
        <span class="type">int</span> j = rand.nextInt(<span class="integer">100</span>);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i = </span><span class="delimiter">&quot;</span></span> + i);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">j = </span><span class="delimiter">&quot;</span></span> + j);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i &gt; j is </span><span class="delimiter">&quot;</span></span> + (i &gt; j));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i &lt; j is </span><span class="delimiter">&quot;</span></span> + (i &lt; j));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i &gt;= j is </span><span class="delimiter">&quot;</span></span> + (i &gt;= j));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i &lt;= j is </span><span class="delimiter">&quot;</span></span> + (i &lt;= j));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i == j is </span><span class="delimiter">&quot;</span></span> + (i == j));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i != j is </span><span class="delimiter">&quot;</span></span> + (i != j));
<span class="comment">// Treating an int as a boolean is not legal Java:</span>
<span class="comment">//! print(&quot;i &amp;&amp; j is &quot; + (i &amp;&amp; j));</span>
<span class="comment">//! print(&quot;i || j is &quot; + (i || j));</span>
<span class="comment">//! print(&quot;!i is &quot; + !i);</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">(i &lt; 10) &amp;&amp; (j &lt; 10) is </span><span class="delimiter">&quot;</span></span>
              + ((i &lt; <span class="integer">10</span>) &amp;&amp; (j &lt; <span class="integer">10</span>)) );
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">(i &lt; 10) || (j &lt; 10) is </span><span class="delimiter">&quot;</span></span>
              + ((i &lt; <span class="integer">10</span>) || (j &lt; <span class="integer">10</span>)) );
}
} <span class="comment">/* Output:
     i = 58
     j = 55
     i &gt; j is true
     i &lt; j is false
     i &gt;= j is true
     i &lt;= j is false
     i == j is false
     i != j is true
     (i &lt; 10) &amp;&amp; (j &lt; 10) is false
     (i &lt; 10) || (j &lt; 10) is false
   */</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><em>boolean</em> 值在与 <em>String</em> 拼接时会转换为对应的字符串。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_short_circuiting"><a class="anchor" href="#_short_circuiting"></a>32.1. Short-circuiting</h3>
<div class="paragraph">
<p>使用逻辑操作符时，可能会遇到 <em>Short-circuiting</em> （短路）的情况。</p>
</div>
<div class="listingblock">
<div class="title">Short-circuiting example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/ShortCircuit.java</span>
<span class="comment">// Demonstrates short-circuiting behavior</span>
<span class="comment">// with logical operators.</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="integer">72</span> Thinking in Java Bruce Eckel
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShortCircuit</span> {
<span class="directive">static</span> <span class="type">boolean</span> test1(<span class="type">int</span> val) {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">test1(</span><span class="delimiter">&quot;</span></span> + val + <span class="string"><span class="delimiter">&quot;</span><span class="content">)</span><span class="delimiter">&quot;</span></span>);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">result: </span><span class="delimiter">&quot;</span></span> + (val &lt; <span class="integer">1</span>));
        <span class="keyword">return</span> val &lt; <span class="integer">1</span>;
}
<span class="directive">static</span> <span class="type">boolean</span> test2(<span class="type">int</span> val) {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">test2(</span><span class="delimiter">&quot;</span></span> + val + <span class="string"><span class="delimiter">&quot;</span><span class="content">)</span><span class="delimiter">&quot;</span></span>);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">result: </span><span class="delimiter">&quot;</span></span> + (val &lt; <span class="integer">2</span>));
        <span class="keyword">return</span> val &lt; <span class="integer">2</span>;
}
<span class="directive">static</span> <span class="type">boolean</span> test3(<span class="type">int</span> val) {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">test3(</span><span class="delimiter">&quot;</span></span> + val + <span class="string"><span class="delimiter">&quot;</span><span class="content">)</span><span class="delimiter">&quot;</span></span>);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">result: </span><span class="delimiter">&quot;</span></span> + (val &lt; <span class="integer">3</span>));
        <span class="keyword">return</span> val &lt; <span class="integer">3</span>;
}
<span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="type">boolean</span> b = test1(<span class="integer">0</span>) &amp;&amp; test2(<span class="integer">2</span>) &amp;&amp; test3(<span class="integer">2</span>); <img src="./images/icons/callouts/1.png" alt="1">
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">expression is </span><span class="delimiter">&quot;</span></span> + b);
}
} <span class="comment">/* Output:
     test1(0)
     result: true
     test2(2)
     result: false
     expression is false
   */</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>出现了短路现象， <code>_test3(2)_</code> 是没有被计算的。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>_test1(0)_</code> 是 <em>true</em> ， <code>_test2(2)_</code> 是 <em>false</em> ， <code>true&amp;&amp;false</code> 那么整个表达式也就是 <em>false</em> ，所以就没必要计算 <code>_test3(2)_</code> 了。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_literals"><a class="anchor" href="#_literals"></a>33. Literals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>通常情况下，在程序中指定了一个常量值时，编译器是明确知道它的类型的。但是有时还是含糊不清的，这时就需要通过在常量值后面添加后缀来明确地告诉编译器该常量的类型。</p>
</div>
<div class="listingblock">
<div class="title">example of Literals</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: operators/Literals.java</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="directive">public</span> <span class="type">class</span> <span class="class">Literals</span> {
<span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="type">int</span> i1 = <span class="hex">0x2f</span>; <span class="comment">// Hexadecimal (lowercase)</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i1: </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(i1));
        <span class="type">int</span> i2 = <span class="hex">0X2F</span>; <span class="comment">// Hexadecimal (uppercase)</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i2: </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(i2));
        <span class="type">int</span> i3 = <span class="octal">0177</span>; <span class="comment">// Octal (leading zero)</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i3: </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(i3));
        <span class="type">char</span> c = <span class="hex">0xffff</span>; <span class="comment">// max char hex value</span>
        Operators <span class="integer">73</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">c: </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(c));
        <span class="type">byte</span> b = <span class="hex">0x7f</span>; <span class="comment">// max byte hex value</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">b: </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(b));
        <span class="type">short</span> s = <span class="hex">0x7fff</span>; <span class="comment">// max short hex value</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">s: </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(s));
        <span class="type">long</span> n1 = <span class="integer">200L</span>; <span class="comment">// long suffix</span>
        <span class="type">long</span> n2 = <span class="integer">200l</span>; <span class="comment">// long suffix (but can be confusing)</span>
        <span class="type">long</span> n3 = <span class="integer">200</span>;
        <span class="type">float</span> f1 = <span class="integer">1</span>;
        <span class="type">float</span> f2 = <span class="float">1F</span>; <span class="comment">// float suffix</span>
        <span class="type">float</span> f3 = <span class="float">1f</span>; <span class="comment">// float suffix</span>
        <span class="type">double</span> d1 = <span class="float">1d</span>; <span class="comment">// double suffix</span>
        <span class="type">double</span> d2 = <span class="float">1D</span>; <span class="comment">// double suffix</span>
<span class="comment">// (Hex and Octal also work with long)</span>
}
} <span class="comment">/* Output:
     i1: 101111
     i2: 101111
     i3: 1111111
     c: 1111111111111111
     b: 1111111
     s: 111111111111111
   */</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Long</dt>
<dd>
<p>Long类型的后缀为 <code>l</code> 或者 <code>L</code></p>
</dd>
<dt class="hdlist1">Float</dt>
<dd>
<p>Float类型的后缀为 <code>f</code> 或者 <code>F</code></p>
</dd>
<dt class="hdlist1">Double</dt>
<dd>
<p>Double类型的后缀为 <code>d</code> 或者 <code>D</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>16 进制以 <code>0x</code> 开头， 8 进制以 <code>0</code> 开头。</p>
</div>
<div class="paragraph">
<p><code>Integer</code> 和 <code>Long</code> 类型分别有转换为二进制、十六进制、八进制形式字符串输出的方法：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/toBinaryString.png" alt="toBinaryString">
</div>
</div>
<div class="sect2">
<h3 id="_exponential_notation"><a class="anchor" href="#_exponential_notation"></a>33.1. Exponential notation</h3>
<div class="paragraph">
<p>指数</p>
</div>
<div class="listingblock">
<div class="title">Exponents</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/Exponents.java</span>
<span class="comment">// &quot;e&quot; means &quot;10 to the power.&quot;</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Exponents</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="comment">// Uppercase and lowercase 'e' are the same:</span>
        <span class="type">float</span> expFloat = <span class="float">1.39e-43f</span>; <img src="./images/icons/callouts/1.png" alt="1">
        expFloat = <span class="float">1.39E-43f</span>;
        <span class="predefined-type">System</span>.out.println(expFloat);
        <span class="type">double</span> expDouble = <span class="float">47e47d</span>; <span class="comment">// 'd' is optional</span>
        <span class="type">double</span> expDouble2 = <span class="float">47e47</span>; <span class="comment">// Automatically double</span>
        <span class="predefined-type">System</span>.out.println(expDouble);
        <span class="type">double</span> expDouble3 = <span class="float">2e2</span>; <img src="./images/icons/callouts/2.png" alt="2">
        <span class="predefined-type">System</span>.out.println(expDouble3);
    }
} <span class="comment">/* Output:
1.39E-43
4.7E48
200.0
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>1.39e-43f 即 1.39 * 10<sup>-43</sup></td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>2e2 即 2 * 10<sup>2</sup> ，所以是 200.0 . 指数默认为 <em>double</em> 类型</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bitwise_operators"><a class="anchor" href="#_bitwise_operators"></a>34. Bitwise operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>按位操作符。 <em>Java</em> 最初设计这种语法是因为要嵌入电视机顶盒考虑的，所以这个还是尽量少用吧。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">操作符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">说明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">And(&amp;)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">与，当两数的位都是1时，则输出1，否则输出0；</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OR(|)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">或，当两数的位中有一个是1时，则输出1。只有两数都是0时，才输出0；</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XOR(^)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">异或，两个操作数的位中，相同则结果为0，不同则结果为1。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT(~)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非，只对一个操作数有效。如果位为0，结果是1，如果位为1，结果是0；</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>位操作符，可以与 <code>=</code> 在一起，完成位运算及赋值操作。由于 NOT(~) 是一元操作符，所以它玩不了。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&amp;=</p>
</li>
<li>
<p>|=</p>
</li>
<li>
<p>^=</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>boolean*是以一位来对待的，所以它会有些不同。可以对 *boolean</strong> 执行位与、或、异或，但是不能执行位非（可能是考虑会与逻辑非混淆）。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important">
</td>
<td class="content">
<div class="paragraph">
<p>位与、或、异或会产生与逻辑操作符相同的效果，但是它不会出现 <em>short circuit</em> （短路）现象。</p>
</div>
<div class="listingblock">
<div class="title">example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">boolean</span> flag = test1(<span class="integer">0</span>) &amp; test2(<span class="integer">2</span>) &amp; test3(<span class="integer">2</span>); <img src="./images/icons/callouts/1.png" alt="1">
print(<span class="string"><span class="delimiter">&quot;</span><span class="content">expression is </span><span class="delimiter">&quot;</span></span> + flag);

<span class="predefined-type">System</span>.out.println(<span class="predefined-constant">true</span>^<span class="predefined-constant">false</span>^<span class="predefined-constant">true</span>); <img src="./images/icons/callouts/2.png" alt="2">
<span class="comment">/* output
test1(0)
result: true
test2(2)
result: false
test3(2)
result: true
expression is false
false
*/</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>三个表达式都将会被计算</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td><em>XOR</em> 并没有逻辑操作符与之对象，不建议对 <em>boolean</em> 使用。</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution">
</td>
<td class="content">
<div class="paragraph">
<p>不能对 <em>boolean</em> 使用位移操作符。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shift_operators"><a class="anchor" href="#_shift_operators"></a>35. Shift operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>位移操作符。位移操作符也可以操作位。它只能被用于基本类型，整形。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">操作符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">说明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;&lt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将操作数左移指定位数，移出的位将被抛弃，右侧差的位则用0补齐。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将操作数右移指定位数，为正高位补0，为负数高位补1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">无符号右移，无论正负，高位都补0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>详细操作见 <a href="http://blog.sina.com.cn/s/blog_439f80c40100n0hc.html">链接</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>一.int的是32位。long的是64位。
  如int i = 1;
  i的二进制原码表示为：
  00000000000000000000000000000001
  long l = 1;
  l的二进制原码表示为：   0000000000000000000000000000000000000000000000000000000000000001</p>
</div>
<div class="paragraph">
<p>二.原码——符号位为0表示正数，为1表示负数；
        其余各位等同于真值的绝对值。
 如：0000000000000010B=2，1000000000000010B=-2
反码——符号位的用法及正数的表示与“原码”一样；
 负数的表示是在“原码”表示的基础上通过将符号位以外
 的各位取反来获得的。
 如：0000000000000010B=2，1111111111111101B=-2
补码——符号位的用法及正数的表示与“原码”一样；
 负数的表示是在“反码”的基础上通过加1来获得的。
 如：00000010B=2，11111110B=-2</p>
</div>
<div class="paragraph">
<p>三。常用的操作
    &amp; 与。    全1为1， 有0为0。　　任何数与0与都等于0。　　
    | 或。      有1为1， 全0为0。　　任何数与0或都等于原值。
    ~ 非。     逐位取反
    ^ 异或。  相同为0，相异为1。      任何数与0异或都等于原值。</p>
</div>
<div class="paragraph">
<p>正数在计算机中是用二进制表示的，负数在计算机中使用补码表示的。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;

<span class="comment">/**
 * 位移操作。
 * &lt;pre&gt;
 *     System.out.println(1&lt;&lt;1); //结果2，1左移1位，相当于乘以2
 * &lt;/pre&gt;
 * @author zxb
 * @version 1.0.0
 * @date 2016年04月10日 13:44
 * @since Jdk1.6
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShiftBit</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="type">int</span> b1 = <span class="integer">1</span>;
        <span class="type">int</span> b2 = -<span class="integer">4</span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b1:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(b1));
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b2:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(b2));
        <span class="type">int</span> b3 = b1 &lt;&lt; <span class="integer">1</span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b3:</span><span class="delimiter">&quot;</span></span> + b3);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b1 &lt;&lt; 1:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(b3));
        <span class="type">int</span> b4 = b1 &gt;&gt; <span class="integer">2</span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b4:</span><span class="delimiter">&quot;</span></span> + b4);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b1 &gt;&gt; 2:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(b4));
        <span class="type">int</span> b6 = b2 &gt;&gt; <span class="integer">2</span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b6:</span><span class="delimiter">&quot;</span></span> + b6);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b2 &gt;&gt; 2:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(b6));

        <span class="type">int</span> b5 = b2 &gt;&gt;&gt; <span class="integer">2</span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b5:</span><span class="delimiter">&quot;</span></span> + b5);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">b2 &gt;&gt; 2:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Integer</span>.toBinaryString(b5));

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">2^5:</span><span class="delimiter">&quot;</span></span> + (<span class="integer">1</span>&lt;&lt;<span class="integer">5</span>));

        <span class="type">int</span> a = <span class="integer">1</span>;
        a &lt;&lt;= <span class="integer">5</span>; <img src="./images/icons/callouts/1.png" alt="1">
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">2^5:</span><span class="delimiter">&quot;</span></span> + a);
        a &gt;&gt;= <span class="integer">3</span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">a&gt;&gt;=3:</span><span class="delimiter">&quot;</span></span> + a);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>移位操作符可以与赋值操作符一起使用。即移位后就赋值。（<code>&lt;\&lt;=、&gt;&gt;=、&gt;&gt;&gt;=</code>）</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">example2</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/URShift.java</span>
<span class="comment">// Test of unsigned right shift.</span>

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">URShift</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="type">int</span> i = -<span class="integer">1</span>;
        print(<span class="predefined-type">Integer</span>.toBinaryString(i));
        i &gt;&gt;&gt;= <span class="integer">10</span>;
        print(<span class="predefined-type">Integer</span>.toBinaryString(i));
        <span class="type">long</span> l = -<span class="integer">1</span>;
        print(<span class="predefined-type">Long</span>.toBinaryString(l));
        l &gt;&gt;&gt;= <span class="integer">10</span>;
        print(<span class="predefined-type">Long</span>.toBinaryString(l));
        <span class="type">short</span> s = -<span class="integer">1</span>;
        print(<span class="predefined-type">Integer</span>.toBinaryString(s));
        s &gt;&gt;&gt;= <span class="integer">10</span>;
        print(<span class="predefined-type">Integer</span>.toBinaryString(s));
        <span class="type">byte</span> b = -<span class="integer">1</span>;
        print(<span class="predefined-type">Integer</span>.toBinaryString(b));
        b &gt;&gt;&gt;= <span class="integer">10</span>;
        print(<span class="predefined-type">Integer</span>.toBinaryString(b));
        b = -<span class="integer">1</span>;
        print(<span class="predefined-type">Integer</span>.toBinaryString(b));
        print(<span class="predefined-type">Integer</span>.toBinaryString(b &gt;&gt;&gt; <span class="integer">10</span>));
    }
} <span class="comment">/* Output:
11111111111111111111111111111111
1111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111
111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111
11111111111111111111111111111111
11111111111111111111111111111111
11111111111111111111111111111111
11111111111111111111111111111111
1111111111111111111111
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important">
</td>
<td class="content">
<div class="paragraph">
<p>最高位表示符号位。0表示正数，1表示负数。
如正数1，为0000 0000 0000 0000 0000 0000 0000 0001，负数-1为11111111111111111111111111111111</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_ternary_if_else_operator"><a class="anchor" href="#_ternary_if_else_operator"></a>35.1. Ternary if-else operator</h3>
<div class="listingblock">
<div class="title">三元运算符</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">boolean</span>-exp ? value0 : value1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">compare to if/else</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/TernaryIfElse.java</span>

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">TernaryIfElse</span> {
    <span class="directive">static</span> <span class="type">int</span> ternary(<span class="type">int</span> i) {
        <span class="keyword">return</span> i &lt; <span class="integer">10</span> ? i * <span class="integer">100</span> : i * <span class="integer">10</span>; <img src="./images/icons/callouts/1.png" alt="1">
    }

    <span class="directive">static</span> <span class="type">int</span> standardIfElse(<span class="type">int</span> i) {
        <span class="keyword">if</span> (i &lt; <span class="integer">10</span>)
            <span class="keyword">return</span> i * <span class="integer">100</span>;
        <span class="keyword">else</span>
            <span class="keyword">return</span> i * <span class="integer">10</span>;
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        print(ternary(<span class="integer">9</span>));
        print(ternary(<span class="integer">10</span>));
        print(standardIfElse(<span class="integer">9</span>));
        print(standardIfElse(<span class="integer">10</span>));
    }
} <span class="comment">/* Output:
900
100
900
100
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>三元运算符，虽然简洁，但是可读性差。还是建议使用if/else</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_string_operator_and"><a class="anchor" href="#_string_operator_and"></a>36. String operator + and +=</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>+</code> 与 <code>+=</code> 可以用来追加字符串。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
在 <code>C#</code> 与 <code>C++</code> 中，使用 <strong>运算符重载</strong> 来实现这种特性。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>在一个表达式中，如果有一个字符串，其它使用 <code>+</code> 拼接的表达式都会最终被计算为字符串并进行字符串拼接。</p>
</div>
<div class="listingblock">
<div class="title">example of String operator</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/StringOperators.java</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">StringOperators</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="type">int</span> x = <span class="integer">0</span>, y = <span class="integer">1</span>, z = <span class="integer">2</span>;
    <span class="predefined-type">String</span> s = <span class="string"><span class="delimiter">&quot;</span><span class="content">x, y, z </span><span class="delimiter">&quot;</span></span>;
    print(s + x + y + z);
    print(x + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + s); <span class="comment">// Converts x to a String</span>
    s += <span class="string"><span class="delimiter">&quot;</span><span class="content">(summed) = </span><span class="delimiter">&quot;</span></span>; <span class="comment">// Concatenation operator</span>
    print(s + (x + y + z));
    print(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span> + x); <span class="comment">// Shorthand for Integer.toString()</span>
  }
} <span class="comment">/* Output:
x, y, z 012
0 x, y, z
x, y, z (summed) = 3
0
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_common_pitfalls_when_using_operators"><a class="anchor" href="#_common_pitfalls_when_using_operators"></a>37. Common pitfalls when using operators</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_casting_operators"><a class="anchor" href="#_casting_operators"></a>38. Casting operators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>类型转换操作符，类型转换分为隐式转换和显式转换。</p>
</div>
<div class="listingblock">
<div class="title">example of cast</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/Casting.java</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Casting</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="type">int</span> i = <span class="integer">200</span>;
    <span class="type">long</span> lng = (<span class="type">long</span>)i;
    lng = i; <span class="comment">// &quot;Widening,&quot; so cast not really required </span><img src="./images/icons/callouts/1.png" alt="1">
    <span class="type">long</span> lng2 = (<span class="type">long</span>)<span class="integer">200</span>;
    lng2 = <span class="integer">200</span>;
    <span class="comment">// A &quot;narrowing conversion&quot;:</span>
    i = (<span class="type">int</span>)lng2; <span class="comment">// Cast required </span><img src="./images/icons/callouts/2.png" alt="2">
  }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>隐式转换，大类型引用指向小类型值。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>显式转换，小类型引用指向大类型值。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>除了 <em>boolean</em> 外，其它所有基本类型都可以进行类型转换。</p>
</div>
<div class="sect2">
<h3 id="_truncation_and_rounding"><a class="anchor" href="#_truncation_and_rounding"></a>38.1. Truncation and rounding</h3>
<div class="paragraph">
<p>当执行一个缩小的转换 <em>narrowing conversions</em> ，是可能会损失精度的。</p>
</div>
<div class="listingblock">
<div class="title">example of truncation and rounding</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/CastingNumbers.java</span>
<span class="comment">// What happens when you cast a float</span>
<span class="comment">// or double to an integral value?</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">CastingNumbers</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="type">double</span> above = <span class="float">0.7</span>, below = <span class="float">0.4</span>;
    <span class="type">float</span> fabove = <span class="float">0.7f</span>, fbelow = <span class="float">0.4f</span>;
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">(int)above: </span><span class="delimiter">&quot;</span></span> + (<span class="type">int</span>)above);
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">(int)below: </span><span class="delimiter">&quot;</span></span> + (<span class="type">int</span>)below);
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">(int)fabove: </span><span class="delimiter">&quot;</span></span> + (<span class="type">int</span>)fabove);
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">(int)fbelow: </span><span class="delimiter">&quot;</span></span> + (<span class="type">int</span>)fbelow);
  }
} <span class="comment">/* Output:  <img src="./images/icons/callouts/1.png" alt="1">
(int)above: 0
(int)below: 0
(int)fabove: 0
(int)fbelow: 0
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>大类型强制转成小类型，丢失了精度。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>通常， <em>double</em> 和 <em>float</em> 转成 <em>int</em> 是直接被截断的。如果你希望四舍五入，可以采用 <em>java.lang.Math.round()</em> 而非 <em>强制转换</em> 。</p>
</div>
<div class="listingblock">
<div class="title">example of rounding numbers</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/RoundingNumbers.java</span>
<span class="comment">// Rounding floats and doubles.</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<img src="./images/icons/callouts/1.png" alt="1">
<span class="directive">public</span> <span class="type">class</span> <span class="class">RoundingNumbers</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="type">double</span> above = <span class="float">0.7</span>, below = <span class="float">0.4</span>;
    <span class="type">float</span> fabove = <span class="float">0.7f</span>, fbelow = <span class="float">0.4f</span>;
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Math.round(above): </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Math</span>.round(above));
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Math.round(below): </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Math</span>.round(below));
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Math.round(fabove): </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Math</span>.round(fabove));
    print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Math.round(fbelow): </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Math</span>.round(fbelow));
  }
} <span class="comment">/* Output:
Math.round(above): 1
Math.round(below): 0
Math.round(fabove): 1
Math.round(fbelow): 0
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>因为 <em>java.lang.Math</em> 类属于 <em>java.lang</em> 包，所以你不需要额外地去导该类了。因为默认会导 <em>java.lang.*</em> 。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_promotion"><a class="anchor" href="#_promotion"></a>38.2. Promotion</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">类型提升</dt>
<dd>
<p>你可能会发现，当你对那些比 <strong>int</strong> 小的基本类型（ <strong>char</strong> , <strong>byte</strong> , <strong>short</strong> ）执行算术或位操作时，这些类型会被转为 <em>int</em> 类型进行操作，而你要得到对应类型时，需要强转（损失精度）。</p>
<div class="paragraph">
<p>通常，两个操作数一起计算时，大类型与小类型在一起时，结果就是大类型。</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_has_no_sizeof"><a class="anchor" href="#_java_has_no_sizeof"></a>39. Java has no “sizeof”</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在 <strong>C</strong> 或 <strong>C++</strong> 中存在 <em>sizeof</em> 方法，这个方法用来得到某一类型所占的字节数。如 <strong>int</strong> 在 <strong>A操作系统</strong> 中占 <em>16bit</em> ，在 <strong>B操作系统</strong> 中占 <em>32bit</em> ，那么程序员要考虑何时是 <strong>int</strong> 是 <em>16bit</em> 之类的问题。</p>
</div>
<div class="paragraph">
<p>在 <strong>java</strong> 中没有这种问题，所以也就不需要 <em>sizeof</em> 方法。因为 <strong>java</strong> 中所有的类型在不同的操作系统中都是相同的固定长度。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_compendium_of_operators"><a class="anchor" href="#_a_compendium_of_operators"></a>40. A compendium of operators</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">all operators</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">operators</span>;<span class="comment">//: operators/AllOps.java</span>
<span class="comment">// Tests all the operators on all the primitive data types</span>
<span class="comment">// to show which ones are accepted by the Java compiler.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">AllOps</span> {
  <span class="comment">// To accept the results of a boolean test:</span>
  <span class="type">void</span> f(<span class="type">boolean</span> b) {}
  <span class="type">void</span> boolTest(<span class="type">boolean</span> x, <span class="type">boolean</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    <span class="comment">//! x = x * y;</span>
    <span class="comment">//! x = x / y;</span>
    <span class="comment">//! x = x % y;</span>
    <span class="comment">//! x = x + y;</span>
    <span class="comment">//! x = x - y;</span>
    <span class="comment">//! x++;</span>
    <span class="comment">//! x--;</span>
    <span class="comment">//! x = +y;</span>
    <span class="comment">//! x = -y;</span>
    <span class="comment">// Relational and logical:</span>
    <span class="comment">//! f(x &gt; y);</span>
    <span class="comment">//! f(x &gt;= y);</span>
    <span class="comment">//! f(x &lt; y);</span>
    <span class="comment">//! f(x &lt;= y);</span>
    f(x == y);
    f(x != y);
    f(!y);
    x = x &amp;&amp; y;
    x = x || y;
    <span class="comment">// Bitwise operators:</span>
    <span class="comment">//! x = ~y;</span>
    x = x &amp; y;
    x = x | y;
    x = x ^ y;
    <span class="comment">//! x = x &lt;&lt; 1;</span>
    <span class="comment">//! x = x &gt;&gt; 1;</span>
    <span class="comment">//! x = x &gt;&gt;&gt; 1;</span>
    <span class="comment">// Compound assignment:</span>
    <span class="comment">//! x += y;</span>
    <span class="comment">//! x -= y;</span>
    <span class="comment">//! x *= y;</span>
    <span class="comment">//! x /= y;</span>
    <span class="comment">//! x %= y;</span>
    <span class="comment">//! x &lt;&lt;= 1;</span>
    <span class="comment">//! x &gt;&gt;= 1;</span>
    <span class="comment">//! x &gt;&gt;&gt;= 1;</span>
    x &amp;= y;
    x ^= y;
    x |= y;
    <span class="comment">// Casting:</span>
    <span class="comment">//! char c = (char)x;</span>
    <span class="comment">//! byte b = (byte)x;</span>
    <span class="comment">//! short s = (short)x;</span>
    <span class="comment">//! int i = (int)x;</span>
    <span class="comment">//! long l = (long)x;</span>
    <span class="comment">//! float f = (float)x;</span>
    <span class="comment">//! double d = (double)x;</span>
  }
  <span class="type">void</span> charTest(<span class="type">char</span> x, <span class="type">char</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    x = (<span class="type">char</span>)(x * y);
    x = (<span class="type">char</span>)(x / y);
    x = (<span class="type">char</span>)(x % y);
    x = (<span class="type">char</span>)(x + y);
    x = (<span class="type">char</span>)(x - y);
    x++;
    x--;
    x = (<span class="type">char</span>)+y;
    x = (<span class="type">char</span>)-y;
    <span class="comment">// Relational and logical:</span>
    f(x &gt; y);
    f(x &gt;= y);
    f(x &lt; y);
    f(x &lt;= y);
    f(x == y);
    f(x != y);
    <span class="comment">//! f(!x);</span>
    <span class="comment">//! f(x &amp;&amp; y);</span>
    <span class="comment">//! f(x || y);</span>
    <span class="comment">// Bitwise operators:</span>
    x= (<span class="type">char</span>)~y;
    x = (<span class="type">char</span>)(x &amp; y);
    x  = (<span class="type">char</span>)(x | y);
    x = (<span class="type">char</span>)(x ^ y);
    x = (<span class="type">char</span>)(x &lt;&lt; <span class="integer">1</span>);
    x = (<span class="type">char</span>)(x &gt;&gt; <span class="integer">1</span>);
    x = (<span class="type">char</span>)(x &gt;&gt;&gt; <span class="integer">1</span>);
    <span class="comment">// Compound assignment:</span>
    x += y;
    x -= y;
    x *= y;
    x /= y;
    x %= y;
    x &lt;&lt;= <span class="integer">1</span>;
    x &gt;&gt;= <span class="integer">1</span>;
    x &gt;&gt;&gt;= <span class="integer">1</span>;
    x &amp;= y;
    x ^= y;
    x |= y;
    <span class="comment">// Casting:</span>
    <span class="comment">//! boolean bl = (boolean)x;</span>
    <span class="type">byte</span> b = (<span class="type">byte</span>)x;
    <span class="type">short</span> s = (<span class="type">short</span>)x;
    <span class="type">int</span> i = (<span class="type">int</span>)x;
    <span class="type">long</span> l = (<span class="type">long</span>)x;
    <span class="type">float</span> f = (<span class="type">float</span>)x;
    <span class="type">double</span> d = (<span class="type">double</span>)x;
  }
  <span class="type">void</span> byteTest(<span class="type">byte</span> x, <span class="type">byte</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    x = (<span class="type">byte</span>)(x* y);
    x = (<span class="type">byte</span>)(x / y);
    x = (<span class="type">byte</span>)(x % y);
    x = (<span class="type">byte</span>)(x + y);
    x = (<span class="type">byte</span>)(x - y);
    x++;
    x--;
    x = (<span class="type">byte</span>)+ y;
    x = (<span class="type">byte</span>)- y;
    <span class="comment">// Relational and logical:</span>
    f(x &gt; y);
    f(x &gt;= y);
    f(x &lt; y);
    f(x &lt;= y);
    f(x == y);
    f(x != y);
    <span class="comment">//! f(!x);</span>
    <span class="comment">//! f(x &amp;&amp; y);</span>
    <span class="comment">//! f(x || y);</span>
    <span class="comment">// Bitwise operators:</span>
    x = (<span class="type">byte</span>)~y;
    x = (<span class="type">byte</span>)(x &amp; y);
    x = (<span class="type">byte</span>)(x | y);
    x = (<span class="type">byte</span>)(x ^ y);
    x = (<span class="type">byte</span>)(x &lt;&lt; <span class="integer">1</span>);
    x = (<span class="type">byte</span>)(x &gt;&gt; <span class="integer">1</span>);
    x = (<span class="type">byte</span>)(x &gt;&gt;&gt; <span class="integer">1</span>);
    <span class="comment">// Compound assignment:</span>
    x += y;
    x -= y;
    x *= y;
    x /= y;
    x %= y;
    x &lt;&lt;= <span class="integer">1</span>;
    x &gt;&gt;= <span class="integer">1</span>;
    x &gt;&gt;&gt;= <span class="integer">1</span>;
    x &amp;= y;
    x ^= y;
    x |= y;
    <span class="comment">// Casting:</span>
    <span class="comment">//! boolean bl = (boolean)x;</span>
    <span class="type">char</span> c = (<span class="type">char</span>)x;
    <span class="type">short</span> s = (<span class="type">short</span>)x;
    <span class="type">int</span> i = (<span class="type">int</span>)x;
    <span class="type">long</span> l = (<span class="type">long</span>)x;
    <span class="type">float</span> f = (<span class="type">float</span>)x;
    <span class="type">double</span> d = (<span class="type">double</span>)x;
  }
  <span class="type">void</span> shortTest(<span class="type">short</span> x, <span class="type">short</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    x = (<span class="type">short</span>)(x * y);
    x = (<span class="type">short</span>)(x / y);
    x = (<span class="type">short</span>)(x % y);
    x = (<span class="type">short</span>)(x + y);
    x = (<span class="type">short</span>)(x - y);
    x++;
    x--;
    x = (<span class="type">short</span>)+y;
    x = (<span class="type">short</span>)-y;
    <span class="comment">// Relational and logical:</span>
    f(x &gt; y);
    f(x &gt;= y);
    f(x &lt; y);
    f(x &lt;= y);
    f(x == y);
    f(x != y);
    <span class="comment">//! f(!x);</span>
    <span class="comment">//! f(x &amp;&amp; y);</span>
    <span class="comment">//! f(x || y);</span>
    <span class="comment">// Bitwise operators:</span>
    x = (<span class="type">short</span>)~y;
    x = (<span class="type">short</span>)(x &amp; y);
    x = (<span class="type">short</span>)(x | y);
    x = (<span class="type">short</span>)(x ^ y);
    x = (<span class="type">short</span>)(x &lt;&lt; <span class="integer">1</span>);
    x = (<span class="type">short</span>)(x &gt;&gt; <span class="integer">1</span>);
    x = (<span class="type">short</span>)(x &gt;&gt;&gt; <span class="integer">1</span>);
    <span class="comment">// Compound assignment:</span>
    x += y;
    x -= y;
    x *= y;
    x /= y;
    x %= y;
    x &lt;&lt;= <span class="integer">1</span>;
    x &gt;&gt;= <span class="integer">1</span>;
    x &gt;&gt;&gt;= <span class="integer">1</span>;
    x &amp;= y;
    x ^= y;
    x |= y;
    <span class="comment">// Casting:</span>
    <span class="comment">//! boolean bl = (boolean)x;</span>
    <span class="type">char</span> c = (<span class="type">char</span>)x;
    <span class="type">byte</span> b = (<span class="type">byte</span>)x;
    <span class="type">int</span> i = (<span class="type">int</span>)x;
    <span class="type">long</span> l = (<span class="type">long</span>)x;
    <span class="type">float</span> f = (<span class="type">float</span>)x;
    <span class="type">double</span> d = (<span class="type">double</span>)x;
  }
  <span class="type">void</span> intTest(<span class="type">int</span> x, <span class="type">int</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    x = x * y;
    x = x / y;
    x = x % y;
    x = x + y;
    x = x - y;
    x++;
    x--;
    x = +y;
    x = -y;
    <span class="comment">// Relational and logical:</span>
    f(x &gt; y);
    f(x &gt;= y);
    f(x &lt; y);
    f(x &lt;= y);
    f(x == y);
    f(x != y);
    <span class="comment">//! f(!x);</span>
    <span class="comment">//! f(x &amp;&amp; y);</span>
    <span class="comment">//! f(x || y);</span>
    <span class="comment">// Bitwise operators:</span>
    x = ~y;
    x = x &amp; y;
    x = x | y;
    x = x ^ y;
    x = x &lt;&lt; <span class="integer">1</span>;
    x = x &gt;&gt; <span class="integer">1</span>;
    x = x &gt;&gt;&gt; <span class="integer">1</span>;
    <span class="comment">// Compound assignment:</span>
    x += y;
    x -= y;
    x *= y;
    x /= y;
    x %= y;
    x &lt;&lt;= <span class="integer">1</span>;
    x &gt;&gt;= <span class="integer">1</span>;
    x &gt;&gt;&gt;= <span class="integer">1</span>;
    x &amp;= y;
    x ^= y;
    x |= y;
    <span class="comment">// Casting:</span>
    <span class="comment">//! boolean bl = (boolean)x;</span>
    <span class="type">char</span> c = (<span class="type">char</span>)x;
    <span class="type">byte</span> b = (<span class="type">byte</span>)x;
    <span class="type">short</span> s = (<span class="type">short</span>)x;
    <span class="type">long</span> l = (<span class="type">long</span>)x;
    <span class="type">float</span> f = (<span class="type">float</span>)x;
    <span class="type">double</span> d = (<span class="type">double</span>)x;
  }
  <span class="type">void</span> longTest(<span class="type">long</span> x, <span class="type">long</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    x = x * y;
    x = x / y;
    x = x % y;
    x = x + y;
    x = x - y;
    x++;
    x--;
    x = +y;
    x = -y;
    <span class="comment">// Relational and logical:</span>
    f(x &gt; y);
    f(x &gt;= y);
    f(x &lt; y);
    f(x &lt;= y);
    f(x == y);
    f(x != y);
    <span class="comment">//! f(!x);</span>
    <span class="comment">//! f(x &amp;&amp; y);</span>
    <span class="comment">//! f(x || y);</span>
    <span class="comment">// Bitwise operators:</span>
    x = ~y;
    x = x &amp; y;
    x = x | y;
    x = x ^ y;
    x = x &lt;&lt; <span class="integer">1</span>;
    x = x &gt;&gt; <span class="integer">1</span>;
    x = x &gt;&gt;&gt; <span class="integer">1</span>;
    <span class="comment">// Compound assignment:</span>
    x += y;
    x -= y;
    x *= y;
    x /= y;
    x %= y;
    x &lt;&lt;= <span class="integer">1</span>;
    x &gt;&gt;= <span class="integer">1</span>;
    x &gt;&gt;&gt;= <span class="integer">1</span>;
    x &amp;= y;
    x ^= y;
    x |= y;
    <span class="comment">// Casting:</span>
    <span class="comment">//! boolean bl = (boolean)x;</span>
    <span class="type">char</span> c = (<span class="type">char</span>)x;
    <span class="type">byte</span> b = (<span class="type">byte</span>)x;
    <span class="type">short</span> s = (<span class="type">short</span>)x;
    <span class="type">int</span> i = (<span class="type">int</span>)x;
    <span class="type">float</span> f = (<span class="type">float</span>)x;
    <span class="type">double</span> d = (<span class="type">double</span>)x;
  }
  <span class="type">void</span> floatTest(<span class="type">float</span> x, <span class="type">float</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    x = x * y;
    x = x / y;
    x = x % y;
    x = x + y;
    x = x - y;
    x++;
    x--;
    x = +y;
    x = -y;
    <span class="comment">// Relational and logical:</span>
    f(x &gt; y);
    f(x &gt;= y);
    f(x &lt; y);
    f(x &lt;= y);
    f(x == y);
    f(x != y);
    <span class="comment">//! f(!x);</span>
    <span class="comment">//! f(x &amp;&amp; y);</span>
    <span class="comment">//! f(x || y);</span>
    <span class="comment">// Bitwise operators:</span>
    <span class="comment">//! x = ~y;</span>
    <span class="comment">//! x = x &amp; y;</span>
    <span class="comment">//! x = x | y;</span>
    <span class="comment">//! x = x ^ y;</span>
    <span class="comment">//! x = x &lt;&lt; 1;</span>
    <span class="comment">//! x = x &gt;&gt; 1;</span>
    <span class="comment">//! x = x &gt;&gt;&gt; 1;</span>
    <span class="comment">// Compound assignment:</span>
    x += y;
    x -= y;
    x *= y;
    x /= y;
    x %= y;
    <span class="comment">//! x &lt;&lt;= 1;</span>
    <span class="comment">//! x &gt;&gt;= 1;</span>
    <span class="comment">//! x &gt;&gt;&gt;= 1;</span>
    <span class="comment">//! x &amp;= y;</span>
    <span class="comment">//! x ^= y;</span>
    <span class="comment">//! x |= y;</span>
    <span class="comment">// Casting:</span>
    <span class="comment">//! boolean bl = (boolean)x;</span>
    <span class="type">char</span> c = (<span class="type">char</span>)x;
    <span class="type">byte</span> b = (<span class="type">byte</span>)x;
    <span class="type">short</span> s = (<span class="type">short</span>)x;
    <span class="type">int</span> i = (<span class="type">int</span>)x;
    <span class="type">long</span> l = (<span class="type">long</span>)x;
    <span class="type">double</span> d = (<span class="type">double</span>)x;
  }
  <span class="type">void</span> doubleTest(<span class="type">double</span> x, <span class="type">double</span> y) {
    <span class="comment">// Arithmetic operators:</span>
    x = x * y;
    x = x / y;
    x = x % y;
    x = x + y;
    x = x - y;
    x++;
    x--;
    x = +y;
    x = -y;
    <span class="comment">// Relational and logical:</span>
    f(x &gt; y);
    f(x &gt;= y);
    f(x &lt; y);
    f(x &lt;= y);
    f(x == y);
    f(x != y);
    <span class="comment">//! f(!x);</span>
    <span class="comment">//! f(x &amp;&amp; y);</span>
    <span class="comment">//! f(x || y);</span>
    <span class="comment">// Bitwise operators:</span>
    <span class="comment">//! x = ~y;</span>
    <span class="comment">//! x = x &amp; y;</span>
    <span class="comment">//! x = x | y;</span>
    <span class="comment">//! x = x ^ y;</span>
    <span class="comment">//! x = x &lt;&lt; 1;</span>
    <span class="comment">//! x = x &gt;&gt; 1;</span>
    <span class="comment">//! x = x &gt;&gt;&gt; 1;</span>
    <span class="comment">// Compound assignment:</span>
    x += y;
    x -= y;
    x *= y;
    x /= y;
    x %= y;
    <span class="comment">//! x &lt;&lt;= 1;</span>
    <span class="comment">//! x &gt;&gt;= 1;</span>
    <span class="comment">//! x &gt;&gt;&gt;= 1;</span>
    <span class="comment">//! x &amp;= y;</span>
    <span class="comment">//! x ^= y;</span>
    <span class="comment">//! x |= y;</span>
    <span class="comment">// Casting:</span>
    <span class="comment">//! boolean bl = (boolean)x;</span>
    <span class="type">char</span> c = (<span class="type">char</span>)x;
    <span class="type">byte</span> b = (<span class="type">byte</span>)x;
    <span class="type">short</span> s = (<span class="type">short</span>)x;
    <span class="type">int</span> i = (<span class="type">int</span>)x;
    <span class="type">long</span> l = (<span class="type">long</span>)x;
    <span class="type">float</span> f = (<span class="type">float</span>)x;
  }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>41. Summary</h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_controlling_execution" class="sect0"><a class="anchor" href="#_controlling_execution"></a>Controlling Execution</h1>
<div class="openblock partintro">
<div class="content">
<strong>if-else</strong> , <strong>while</strong> , <strong>do-while</strong> , <strong>for</strong> , <strong>return</strong> , <strong>break</strong> , <strong>switch</strong>
</div>
</div>
<div class="sect1">
<h2 id="__strong_true_strong_and_strong_false_strong"><a class="anchor" href="#__strong_true_strong_and_strong_false_strong"></a>42. <strong>True</strong> and <strong>False</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>所有的条件语句都使用 <strong>true</strong> 或 <strong>false</strong> 来决定语句的执行。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><strong>Java</strong> 不允许使用 <strong>nubmer</strong> 当作 <strong>boolean</strong>（在 <strong>C</strong> 或 <strong>C++</strong> 中会把 <strong>0</strong> 当作 <strong>false</strong> ，非 <strong>0</strong> 当作 <strong>true</strong>）。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__strong_if_else_strong"><a class="anchor" href="#__strong_if_else_strong"></a>43. <strong>if-else</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>if-else</strong> 是使用最多的控制语句。 <em>else</em> 是可选的。所以可以有以下两种方式使用 <em>if</em> 。</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. if</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span>(<span class="predefined-type">Boolean</span>-expression)
  statement

or

<span class="keyword">if</span>(<span class="predefined-type">Boolean</span>-expression)
  statement
<span class="keyword">else</span>
  statement</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 2. if / else if /else</div>
<div class="content">
<div class="listingblock">
<div class="title">example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/IfElse.java</span>

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">IfElse</span> {
    <span class="directive">static</span> <span class="type">int</span> result = <span class="integer">0</span>;

    <span class="directive">static</span> <span class="type">void</span> test(<span class="type">int</span> testval, <span class="type">int</span> target) {
        <span class="keyword">if</span> (testval &gt; target)
            result = +<span class="integer">1</span>;
        <span class="keyword">else</span> <span class="keyword">if</span> (testval &lt; target)
            result = -<span class="integer">1</span>;
        <span class="keyword">else</span>
            result = <span class="integer">0</span>; <span class="comment">// Match</span>
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        test(<span class="integer">10</span>, <span class="integer">5</span>);
        print(result);
        test(<span class="integer">5</span>, <span class="integer">10</span>);
        print(result);
        test(<span class="integer">5</span>, <span class="integer">5</span>);
        print(result);
    }
} <span class="comment">/* Output:
1
-1
0
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_iteration"><a class="anchor" href="#_iteration"></a>44. Iteration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>循环， <strong>while</strong> 、 <strong>do-while</strong> 、 <strong>for</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">while</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">while</span>(<span class="predefined-type">Boolean</span>-expression)
  statement</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">WhileTest</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/WhileTest.java</span>
<span class="comment">// Demonstrates the while loop.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">WhileTest</span> {
    <span class="directive">static</span> <span class="type">boolean</span> condition() {
        <span class="type">boolean</span> result = <span class="predefined-type">Math</span>.random() &lt; <span class="float">0.99</span>;
        <span class="predefined-type">System</span>.out.print(result + <span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> result;
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="keyword">while</span> (condition()) <img src="./images/icons/callouts/1.png" alt="1">
            <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Inside 'while'</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Exited 'while'</span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">/* (Execute to see output) */</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>直到 <code>condition()</code> 为 <em>false</em> 时才退出循环</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">do-while</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">do</span>
  statement
<span class="keyword">while</span>(<span class="predefined-type">Boolean</span>-expression);</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>while</em> 与 <em>do-while</em> 的区别在于 <em>do-while</em> 至少执行一次。</p>
</div>
</dd>
<dt class="hdlist1">for</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">for</span>(initialization; <span class="predefined-type">Boolean</span>-expression; step) <img src="./images/icons/callouts/1.png" alt="1">
  statement</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td><em>initialization</em> 或 <em>Boolean-expression</em> 或 <em>step</em> 这三者均可为空。</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">List Characters</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/ListCharacters.java</span>
<span class="comment">// Demonstrates &quot;for&quot; loop by listing</span>
<span class="comment">// all the lowercase ASCII letters.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">ListCharacters</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="keyword">for</span> (<span class="type">char</span> c = <span class="integer">0</span>; c &lt; <span class="integer">128</span>; c++)
            <span class="keyword">if</span> (<span class="predefined-type">Character</span>.isLowerCase(c))
                <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">value: </span><span class="delimiter">&quot;</span></span> + (<span class="type">int</span>) c +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content"> character: </span><span class="delimiter">&quot;</span></span> + c);
    }
} <span class="comment">/* Output:
value: 97 character: a
value: 98 character: b
value: 99 character: c
value: 100 character: d
value: 101 character: e
value: 102 character: f
value: 103 character: g
value: 104 character: h
value: 105 character: i
value: 106 character: j
...
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_the_comma_operator"><a class="anchor" href="#_the_comma_operator"></a>44.1. The comma operator</h3>
<div class="paragraph">
<p>在 <em>for</em> 循环中，可以使用多个 <em>comma</em> 。</p>
</div>
<div class="listingblock">
<div class="title">comma operator</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/CommaOperator.java</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">CommaOperator</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="integer">1</span>, j = i + <span class="integer">10</span>; i &lt; <span class="integer">5</span>; i++, j = i * <span class="integer">2</span>) { <img src="./images/icons/callouts/1.png" alt="1">
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">i = </span><span class="delimiter">&quot;</span></span> + i + <span class="string"><span class="delimiter">&quot;</span><span class="content"> j = </span><span class="delimiter">&quot;</span></span> + j);
    }
  }
} <span class="comment">/* Output:
i = 1 j = 11
i = 2 j = 4
i = 3 j = 6
i = 4 j = 8
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>以逗号隔开，初始化多个相同类型的变量等。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_foreach_syntax"><a class="anchor" href="#_foreach_syntax"></a>45. Foreach Syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>JavaSE<sub>5</sub></strong> 推出了更简洁的迭代 <em>Array</em> 与 <em>Container</em> 的 <em>for</em> 语法，这也被称为 <em>foreach syntax</em> 。不再需要初始化一个 <strong>int</strong> 类型变量来遍历整个序列， <em>foreach</em> 直接将每次迭代的 <em>item</em> 给你。</p>
</div>
<div class="listingblock">
<div class="title">foreach array</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/ForEachFloat.java</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ForEachFloat</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="predefined-type">Random</span> rand = <span class="keyword">new</span> <span class="predefined-type">Random</span>(<span class="integer">47</span>);
    <span class="type">float</span> f<span class="type">[]</span> = <span class="keyword">new</span> <span class="type">float</span>[<span class="integer">10</span>];
    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++)
      f[i] = rand.nextFloat();
    <span class="keyword">for</span>(<span class="type">float</span> x : f) <img src="./images/icons/callouts/1.png" alt="1">
      <span class="predefined-type">System</span>.out.println(x);
  }
} <span class="comment">/* Output:
0.72711575
0.39982635
0.5309454
0.0534122
0.16020656
0.57799757
0.18847865
0.4170137
0.51660204
0.73734957
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>直接遍历了数组，并且每次迭代时将每一个 <em>item</em> 给你。</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">foreach char array</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/ForEachString.java</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">ForEachString</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="keyword">for</span>(<span class="type">char</span> c : <span class="string"><span class="delimiter">&quot;</span><span class="content">An African Swallow</span><span class="delimiter">&quot;</span></span>.toCharArray() ) <img src="./images/icons/callouts/1.png" alt="1">
      <span class="predefined-type">System</span>.out.print(c + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
  }
} <span class="comment">/* Output:
A n   A f r i c a n   S w a l l o w
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>迭代 <em>char</em> 数组</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p><em>foreach</em> 可以用于所有实现了 <strong>Iterable</strong> 接口的对象。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__strong_return_strong"><a class="anchor" href="#__strong_return_strong"></a>46. <strong>return</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>return</strong> 关键字的用处：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>指定方法的返回值（如果方法不是 <em>void</em> ）</p>
</li>
<li>
<p>退出当前方法</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/IfElse2.java</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">IfElse2</span> {
  <span class="directive">static</span> <span class="type">int</span> test(<span class="type">int</span> testval, <span class="type">int</span> target) {
    <span class="keyword">if</span>(testval &gt; target)
      <span class="keyword">return</span> +<span class="integer">1</span>;
    <span class="keyword">else</span> <span class="keyword">if</span>(testval &lt; target)
      <span class="keyword">return</span> -<span class="integer">1</span>;
    <span class="keyword">else</span>
      <span class="keyword">return</span> <span class="integer">0</span>; <span class="comment">// Match </span><img src="./images/icons/callouts/1.png" alt="1">
  }
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    print(test(<span class="integer">10</span>, <span class="integer">5</span>));
    print(test(<span class="integer">5</span>, <span class="integer">10</span>));
    print(test(<span class="integer">5</span>, <span class="integer">5</span>));
  }
} <span class="comment">/* Output:
1
-1
0
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>其实这里可以不再需要 <em>else</em> ，因为 <em>return</em> 执行后方法就结果了。</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>如果 <em>method</em> 的返回值类型为 <em>void</em> ，那么可以不用指定 <em>return</em> 。</p>
</div>
<div class="paragraph">
<p>如果 <em>method</em> 的返回值为明确的某一类型，那么就必须在方法中指定 <em>return</em> 。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="__strong_break_strong_and_strong_continue_strong"><a class="anchor" href="#__strong_break_strong_and_strong_continue_strong"></a>47. <strong>break</strong> and <strong>continue</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>在循环内部可以通过 <strong>break</strong> 与 <strong>continue</strong> 控制循环。</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
break
</td>
<td class="hdlist2">
<p>不再执行余下代码，并跳出当前循环。</p>
</td>
</tr>
<tr>
<td class="hdlist1">
continue
</td>
<td class="hdlist2">
<p>停止当前执行，并跳到循环开始处继续执行。</p>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Break and Continue</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/BreakAndContinue.java</span>
<span class="comment">// Demonstrates break and continue keywords.</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Range</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">BreakAndContinue</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">100</span>; i++) {
      <span class="keyword">if</span>(i == <span class="integer">74</span>) <span class="keyword">break</span>; <span class="comment">// Out of for loop</span>
      <span class="keyword">if</span>(i % <span class="integer">9</span> != <span class="integer">0</span>) <span class="keyword">continue</span>; <span class="comment">// Next iteration</span>
      <span class="predefined-type">System</span>.out.print(i + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    }
    <span class="predefined-type">System</span>.out.println();
    <span class="comment">// Using foreach:</span>
    <span class="keyword">for</span>(<span class="type">int</span> i : range(<span class="integer">100</span>)) {
      <span class="keyword">if</span>(i == <span class="integer">74</span>) <span class="keyword">break</span>; <span class="comment">// Out of for loop</span>
      <span class="keyword">if</span>(i % <span class="integer">9</span> != <span class="integer">0</span>) <span class="keyword">continue</span>; <span class="comment">// Next iteration</span>
      <span class="predefined-type">System</span>.out.print(i + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    }
    <span class="predefined-type">System</span>.out.println();
    <span class="type">int</span> i = <span class="integer">0</span>;
    <span class="comment">// An &quot;infinite loop&quot;:</span>
    <span class="keyword">while</span>(<span class="predefined-constant">true</span>) {
      i++;
      <span class="type">int</span> j = i * <span class="integer">27</span>;
      <span class="keyword">if</span>(j == <span class="integer">1269</span>) <span class="keyword">break</span>; <span class="comment">// Out of loop</span>
      <span class="keyword">if</span>(i % <span class="integer">10</span> != <span class="integer">0</span>) <span class="keyword">continue</span>; <span class="comment">// Top of loop</span>
      <span class="predefined-type">System</span>.out.print(i + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    }
  }
} <span class="comment">/* Output:
0 9 18 27 36 45 54 63 72
0 9 18 27 36 45 54 63 72
10 20 30 40
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_infamous_goto"><a class="anchor" href="#_the_infamous_goto"></a>48. The infamous “goto”</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>goto</strong> 是指如在条件A处跳到B处，条件B处又直接跳转到A处。</p>
</div>
<div class="paragraph">
<p>问题的本身不是使用 <strong>goto</strong> ，而是过度使用 <strong>goto</strong> ，最终导致程序控制流程惨不忍睹。其实某些特殊情况，使用 <strong>goto</strong> 是非常方便地能解决问题的。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p><strong>goto</strong> 在 <strong>java</strong> 中是保留的关键字，而且也没有使用 <strong>goto</strong> 了。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>在 <strong>java</strong> 中可以使用 <em>label</em> 与 <em>break</em> 或 <em>continue</em> 来达到类似 <em>goto</em> 的 <em>jump</em> 效果。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">label</dt>
<dd>
<p>label就是一个标识符，以冒号结尾。</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">label1:{
  statement;
}

label2:
outer-iteration {
  inner-iteration {
    <span class="comment">//...</span>
    <span class="keyword">break</span>; <img src="./images/icons/callouts/1.png" alt="1">
    <span class="comment">//...</span>
    <span class="keyword">continue</span>; <img src="./images/icons/callouts/2.png" alt="2">
    <span class="comment">//...</span>
    <span class="keyword">continue</span> label1; <img src="./images/icons/callouts/3.png" alt="3">
    <span class="comment">//...</span>
    <span class="keyword">break</span> label1; <img src="./images/icons/callouts/4.png" alt="4">
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>break inner-iteration</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>continue inner-iteration</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>continue outer-iteration</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>break outer-interation</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>使用 <em>label</em> 最有用处的地方主要还是在循环中，因为 <em>break</em> 与 <em>continue</em> 只能跳出当前的循环，对付嵌套循环就不好办了。</p>
</div>
<div class="listingblock">
<div class="title">Labeled For</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/LabeledFor.java</span>
<span class="comment">// For loops with &quot;labeled break&quot; and &quot;labeled continue.&quot;</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">LabeledFor</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="type">int</span> i = <span class="integer">0</span>;
    outer: <span class="comment">// Can't have statements here</span>
    <span class="keyword">for</span>(; <span class="predefined-constant">true</span> ;) { <span class="comment">// infinite loop</span>
      inner: <span class="comment">// Can't have statements here</span>
      <span class="keyword">for</span>(; i &lt; <span class="integer">10</span>; i++) {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i = </span><span class="delimiter">&quot;</span></span> + i);
        <span class="keyword">if</span>(i == <span class="integer">2</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">continue</span><span class="delimiter">&quot;</span></span>);
          <span class="keyword">continue</span>;
        }
        <span class="keyword">if</span>(i == <span class="integer">3</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">break</span><span class="delimiter">&quot;</span></span>);
          i++; <span class="comment">// Otherwise i never</span>
               <span class="comment">// gets incremented.</span>
          <span class="keyword">break</span>;
        }
        <span class="keyword">if</span>(i == <span class="integer">7</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">continue outer</span><span class="delimiter">&quot;</span></span>);
          i++; <span class="comment">// Otherwise i never</span>
               <span class="comment">// gets incremented.</span>
          <span class="keyword">continue</span> outer;
        }
        <span class="keyword">if</span>(i == <span class="integer">8</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">break outer</span><span class="delimiter">&quot;</span></span>);
          <span class="keyword">break</span> outer; <img src="./images/icons/callouts/1.png" alt="1">
        }
        <span class="keyword">for</span>(<span class="type">int</span> k = <span class="integer">0</span>; k &lt; <span class="integer">5</span>; k++) {
          <span class="keyword">if</span>(k == <span class="integer">3</span>) {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">continue inner</span><span class="delimiter">&quot;</span></span>);
            <span class="keyword">continue</span> inner;
          }
        }
      }
    }
    <span class="comment">// Can't break or continue to labels here</span>
  }
} <span class="comment">/* Output:
i = 0
continue inner
i = 1
continue inner
i = 2
continue
i = 3
break
i = 4
continue inner
i = 5
continue inner
i = 6
continue inner
i = 7
continue outer
i = 8
break outer
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>如果跳转外层循环后，方法就结束了的话，也可以直接使用 <em>return</em></td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Labeled While</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/LabeledWhile.java</span>
<span class="comment">// While loops with &quot;labeled break&quot; and &quot;labeled continue.&quot;</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">LabeledWhile</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="type">int</span> i = <span class="integer">0</span>;
    outer:
    <span class="keyword">while</span>(<span class="predefined-constant">true</span>) {
      print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Outer while loop</span><span class="delimiter">&quot;</span></span>);
      <span class="keyword">while</span>(<span class="predefined-constant">true</span>) {
        i++;
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">i = </span><span class="delimiter">&quot;</span></span> + i);
        <span class="keyword">if</span>(i == <span class="integer">1</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">continue</span><span class="delimiter">&quot;</span></span>);
          <span class="keyword">continue</span>;
        }
        <span class="keyword">if</span>(i == <span class="integer">3</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">continue outer</span><span class="delimiter">&quot;</span></span>);
          <span class="keyword">continue</span> outer;
        }
        <span class="keyword">if</span>(i == <span class="integer">5</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">break</span><span class="delimiter">&quot;</span></span>);
          <span class="keyword">break</span>;
        }
        <span class="keyword">if</span>(i == <span class="integer">7</span>) {
          print(<span class="string"><span class="delimiter">&quot;</span><span class="content">break outer</span><span class="delimiter">&quot;</span></span>);
          <span class="keyword">break</span> outer;
        }
      }
    }
  }
} <span class="comment">/* Output:
Outer while loop
i = 1
continue
i = 2
i = 3
continue outer
Outer while loop
i = 4
i = 5
break
Outer while loop
i = 6
i = 7
break outer
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution">
</td>
<td class="content">
<div class="paragraph">
<p>不推荐使用 <em>label</em> ，除非在遇到嵌套循环不好处理时。</p>
</div>
<div class="paragraph">
<p>使用 <em>label</em> 将降低程序可读性、可分析性，使代码难维护。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_switch"><a class="anchor" href="#_switch"></a>49. switch</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>switch</strong> 有时也被称为选择语句。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">switch</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">switch</span>(integral-selector) {
  <span class="keyword">case</span> integral-value1 : statement; <span class="keyword">break</span>;
  <span class="keyword">case</span> integral-value2 : statement; <span class="keyword">break</span>; <img src="./images/icons/callouts/1.png" alt="1">
  <span class="keyword">case</span> integral-value3 : statement; <span class="keyword">break</span>;
  <span class="keyword">case</span> integral-value4 : statement; <span class="keyword">break</span>;
  <span class="keyword">case</span> integral-value5 : statement; <span class="keyword">break</span>;
  <span class="comment">// ...</span>
  <span class="keyword">default</span>: statement;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td><em>break</em> 是可选的，如果没有 <em>break</em> ，则会一直执行下面的 <em>case</em> 直到遇到 <em>break</em> 。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>swtich</strong> 将 <em>integral-selector</em> 与所有的 <em>case</em> 进行比较。如果匹配，则执行对应的 <em>statement</em> ，否则执行 <em>default statement</em> 。</p>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">VowelAndConsonants</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">control</span>;<span class="comment">//: control/VowelsAndConsonants.java</span>
<span class="comment">// Demonstrates the switch statement.</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">VowelsAndConsonants</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="predefined-type">Random</span> rand = <span class="keyword">new</span> <span class="predefined-type">Random</span>(<span class="integer">47</span>);
    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">100</span>; i++) {
      <span class="type">int</span> c = rand.nextInt(<span class="integer">26</span>) + <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>;
      printnb((<span class="type">char</span>)c + <span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span> + c + <span class="string"><span class="delimiter">&quot;</span><span class="content">: </span><span class="delimiter">&quot;</span></span>);
      <span class="keyword">switch</span>(c) {
        <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>:
        <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">e</span><span class="delimiter">'</span></span>:
        <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>:
        <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">o</span><span class="delimiter">'</span></span>:
        <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>: print(<span class="string"><span class="delimiter">&quot;</span><span class="content">vowel</span><span class="delimiter">&quot;</span></span>);
                  <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">y</span><span class="delimiter">'</span></span>:
        <span class="keyword">case</span> <span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>: print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Sometimes a vowel</span><span class="delimiter">&quot;</span></span>);
                  <span class="keyword">break</span>;
        <span class="keyword">default</span>:  print(<span class="string"><span class="delimiter">&quot;</span><span class="content">consonant</span><span class="delimiter">&quot;</span></span>);
      }
    }
  }
} <span class="comment">/* Output:
y, 121: Sometimes a vowel
n, 110: consonant
z, 122: consonant
b, 98: consonant
r, 114: consonant
n, 110: consonant
y, 121: Sometimes a vowel
g, 103: consonant
c, 99: consonant
f, 102: consonant
o, 111: vowel
w, 119: Sometimes a vowel
z, 122: consonant
...
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary_2"><a class="anchor" href="#_summary_2"></a>50. Summary</h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_initialization_cleanup" class="sect0"><a class="anchor" href="#_initialization_cleanup"></a>Initialization &amp; Cleanup</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>关于安全的两个问题就是 <em>Initialization</em> 与 <em>CleanUp</em> 。很多 <em>C</em> 程序的 <em>Bug</em> 是程序员忘记初始化变量了。</p>
</div>
<div class="paragraph">
<p><em>C++</em> 引入了构造函数的概念，构造函数会在对象创建时自动执行。 <em>Java</em> 也引入了构造函数，并且还添加了 <em>Garbage Collector</em> 。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_guaranteed_initialization_with_the_constructor"><a class="anchor" href="#_guaranteed_initialization_with_the_constructor"></a>51. Guaranteed initialization with the constructor</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">示例1</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">initialization</span>;<span class="comment">//: initialization/SimpleConstructor.java</span>
<span class="comment">// Demonstration of a simple constructor.</span>

<span class="type">class</span> <span class="class">Rock</span> {
  Rock() { <span class="comment">// This is the constructor</span>
    <span class="predefined-type">System</span>.out.print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Rock </span><span class="delimiter">&quot;</span></span>);
  }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleConstructor</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++)
      <span class="keyword">new</span> Rock();
  }
} <span class="comment">/* Output:
Rock Rock Rock Rock Rock Rock Rock Rock Rock Rock
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_method_overloading"><a class="anchor" href="#_method_overloading"></a>52. Method overloading</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_default_constructors"><a class="anchor" href="#_default_constructors"></a>53. Default constructors</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_the_strong_this_strong_keyword"><a class="anchor" href="#_the_strong_this_strong_keyword"></a>54. The <strong>this</strong> keyword</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_calling_constructors_from_constructors"><a class="anchor" href="#_calling_constructors_from_constructors"></a>54.1. Calling constructors from constructors</h3>

</div>
<div class="sect2">
<h3 id="_the_meaning_of_static"><a class="anchor" href="#_the_meaning_of_static"></a>54.2. The meaning of static</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_cleanup_finalization_and_garbage_collection"><a class="anchor" href="#_cleanup_finalization_and_garbage_collection"></a>55. Cleanup: finalization and garbage collection</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_enumerated_types"><a class="anchor" href="#_enumerated_types"></a>56. Enumerated types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Enum都有自己的 <em>oridal()</em> 方法，表示序数，从0开始。
也有 values()方法，也有valueOf()方法。</p>
</div>
</div>
</div>
<h1 id="_accesscontrol" class="sect0"><a class="anchor" href="#_accesscontrol"></a>AccessControl</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>访问控制最常见的是 <em>library</em> 依赖。如 <em>client</em>  依赖于某一 <em>library</em> ，则 <em>library creator</em> 应该保证升级过程中，不对 <em>client</em> 的代码造成影响，如 <em>client</em> 要修改大量代码之类的。</p>
</div>
<div class="paragraph">
<p>那么 <em>library creator</em> 又如何能知道哪些类或方法或字段被 <em>client</em> 给依赖了呢。为了解决这个问题， <em>java</em> 中使用 <strong>访问修饰符</strong> 来控制哪些可以被 <em>client</em> 访问，哪些不可以。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_package_the_library_unit"><a class="anchor" href="#_package_the_library_unit"></a>57. package: the library unit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>一个 <em>package</em> 包含一组类，并且这些类使用相同的 <em>namespace</em> ，即包名。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>导入单个类
import java.util.ArrayList;</p>
</li>
<li>
<p>导入某包下所有类
import java.util.*;</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
通过包名加类名这种完全限定名来解决类名冲突。
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important">
</td>
<td class="content">
<div class="paragraph">
<p>每一个 <em>.java</em> 文件中，只允许出现一个 <em>plubic</em> 声明的类。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_code_organization"><a class="anchor" href="#_code_organization"></a>57.1. Code organization</h3>
<div class="paragraph">
<p>当你编译一个 <em>.java</em> 文件时，将产生一个相同名称的 <em>.class</em> 文件。一个可运行的程序由一组 <em>.class</em> 文件组成，这些 <em>.class</em> 文件也可以被打包成一个 <em>jar</em> 包。 <em>java</em> 解释器就负责查找、加载与解释执行这些 <em>.class</em> 文件。</p>
</div>
</div>
<div class="sect2">
<h3 id="_java_access_specfiers"><a class="anchor" href="#_java_access_specfiers"></a>57.2. Java Access specfiers</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">public</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">公共访问权限</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">protected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">类继承访问权限，包访问权限</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">friendly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">包访问权限， <strong>无关键字</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">私有权限，仅本类可访问</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>类只有 <em>plublic</em> 与 <em>friendly</em> （包访问）修饰。</p>
</div>
</div>
</div>
</div>
<h1 id="_reusing_class" class="sect0"><a class="anchor" href="#_reusing_class"></a>Reusing Class</h1>
<div class="openblock partintro">
<div class="content">
选择 <em>Composition</em> 还是 <em>Inheritance</em> 主要取决于你是否需要 <em>upcasting</em> 。
</div>
</div>
<div class="sect1">
<h2 id="_final_keyword"><a class="anchor" href="#_final_keyword"></a>58. Final KeyWord</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_final_data"><a class="anchor" href="#_final_data"></a>58.1. final data</h3>
<div class="paragraph">
<p>使用 <em>static final</em> 修饰的常量，命名时以全部大写，且多个单词以下划线分开。
使用 <em>final</em> 修饰的常量不用大写，使用驼峰命名法即可。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>static final</em></dt>
<dd>
<p><em>static</em> 强调只有一个， <em>final</em> 强调这是一个常量。</p>
</dd>
<dt class="hdlist1">final data</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>对基本类型使用 <em>final</em> ，该变量值将不可被改变。</p>
</li>
<li>
<p>对引用类型变量使用 <em>final</em> ，该引用的地址将不改被改变，即不改再将该引用指向其它对象。</p>
</li>
</ol>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_blank_finals"><a class="anchor" href="#_blank_finals"></a>58.2. Blank finals</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">blank finals</dt>
<dd>
<p>即将 <em>fields</em> 声明为 <em>final</em> ，但是没有给定一个初始值，但是被 <em>blank finals</em> 声明的变量必须在被使用前先完成初始化。</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>blank finals</em> 必须在变量定义或构造函数中完成初始化，这样也就保证了它在使用前一定完成了初始化。</p>
</div>
</div>
<div class="sect2">
<h3 id="_final_arguments"><a class="anchor" href="#_final_arguments"></a>58.3. final arguments</h3>
<div class="paragraph">
<p>被 <em>final</em> 修改的方法参数，在方法内部将不能修改该参数指向的值。</p>
</div>
</div>
<div class="sect2">
<h3 id="_final_methods"><a class="anchor" href="#_final_methods"></a>58.4. final methods</h3>
<div class="olist arabic">
<div class="title">使用 <em>final methods</em> 的有两种原因</div>
<ol class="arabic">
<li>
<p>防止该方法被子类 <em>override</em></p>
</li>
<li>
<p>在早期的 <em>jdk</em> 中指定编译器优化该方法，现在的 <em>Jdk5+</em> 已经不推荐使用</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_final_and_private"><a class="anchor" href="#_final_and_private"></a>58.5. final and private</h3>
<div class="paragraph">
<p>任何 <em>private</em> 的方法其实算是隐式的 <em>final</em> 方法，因为被 <em>private</em> 修饰的方法不可被外部访问，也不可 <em>override</em> 。你可以给 <em>private</em> 修饰的方法添加一个 <em>final</em> 关键字，但是这并不会起什么效果。</p>
</div>
</div>
<div class="sect2">
<h3 id="_final_classes"><a class="anchor" href="#_final_classes"></a>58.6. final classes</h3>
<div class="paragraph">
<p>被 <em>final</em> 修饰的 <em>class</em> 将不可被继承，其中的 <em>method</em> 也就被隐式地声明为了 <em>final</em> 了， <strong>但是其中的 <em>field</em> 不受影响</strong> ，即 <em>field</em> 可声明为 <em>final</em> 或非 <em>final</em> ，此处参照 <em>final data</em> 章节。</p>
</div>
</div>
<div class="sect2">
<h3 id="_final_caution"><a class="anchor" href="#_final_caution"></a>58.7. final caution</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_initialization_and_class_loading"><a class="anchor" href="#_initialization_and_class_loading"></a>59. Initialization and class loading</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">类在JVM中的工作原理</div>
<p>要想使用一个Java类为自己工作，必须经过以下几个过程</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>类加载load：从字节码二进制文件——.class文件将类加载到内存，从而达到类的从硬盘上到内存上的一个迁移，所有的程序必须加载到内存才能工作。将内存中的class放到运行时数据区的方法区内，之后在堆区建立一个java.lang.Class对象，用来封装方法区的数据结构。这个时候就体现出了万事万物皆对象了，干什么事情都得有个对象。就是到了最底层究竟是鸡生蛋，还是蛋生鸡呢?类加载的最终产物就是堆中的一个java.lang.Class对象。</p>
</li>
<li>
<p>连接：连接又分为以下小步骤
验证：出于安全性的考虑，验证内存中的字节码是否符合JVM的规范，类的结构规范、语义检查、字节码操作是否合法、这个是为了防止用户自己建立一个非法的XX.class文件就进行工作了，或者是JVM版本冲突的问题，比如在JDK6下面编译通过的class(其中包含注解特性的类)，是不能在JDK1.4的JVM下运行的。
准备：将类的静态变量进行分配内存空间、初始化默认值。(对象还没生成呢，所以这个时候没有实例变量什么事情)
解析：把类的符号引用转为直接引用(保留)</p>
</li>
<li>
<p>类的初始化： 将类的静态变量赋予正确的初始值，这个初始值是开发者自己定义时赋予的初始值，而不是默认值。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>而类的初始化则是在第一次访问该类时执行，且执行顺序如下：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>父类静态代码块</p>
</li>
<li>
<p>子类静态代码块</p>
</li>
<li>
<p>父类非静态代码块</p>
</li>
<li>
<p>父类构造函数</p>
</li>
<li>
<p>子类非静态代码块</p>
</li>
<li>
<p>子类构造函数</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>一般来说就是类的 <em>static field</em> 或 <em>static method</em> 被访问到时就会初始化该类。其实构造函数也是一个特殊的 <em>static method</em> ，只是没有被显示声明。</p>
</div>
</div>
</div>
<h1 id="_polymorphism" class="sect0"><a class="anchor" href="#_polymorphism"></a>Polymorphism</h1>
<div class="sect1">
<h2 id="_method_call_binding"><a class="anchor" href="#_method_call_binding"></a>60. Method-call binding</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Java</em> 中所有绑定的方法都是 <em>late binding</em> ，除了 <em>static</em> 和 <em>final</em> 修饰的方法（<em>private</em> 修饰的方法是隐式的 <em>final</em> 方法）。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_constructors_and_polymorphism"><a class="anchor" href="#_constructors_and_polymorphism"></a>61. Constructors and polymorphism</h2>
<div class="sectionbody">
<div class="paragraph">
<p>构造函数调用顺序。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>最顶层父类成员变量初始化</p>
</li>
<li>
<p>最顶层父类构造函数执行</p>
</li>
<li>
<p>依次各次父类成员变量初始化、构造执行</p>
</li>
<li>
<p>当前类成员变量初始化，构造函数执行</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>如果有静态成员变量，则最先执行的为静态成员变量。静态成员变量的初始化，也是先父类后子类。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>构造函数中涉及多态时调用</p>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: polymorphism/PolyConstructors.java</span>
<span class="comment">// Constructors and polymorphism</span>
<span class="comment">// don’t produce what you might expect.</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;
<span class="type">class</span> <span class="class">Glyph</span> {
<span class="type">void</span> draw() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Glyph.draw()</span><span class="delimiter">&quot;</span></span>);
}
Glyph() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Glyph() before draw()</span><span class="delimiter">&quot;</span></span>);
        draw();
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Glyph() after draw()</span><span class="delimiter">&quot;</span></span>);
}
}
<span class="type">class</span> <span class="class">RoundGlyph</span> <span class="directive">extends</span> Glyph {
<span class="directive">private</span> <span class="type">int</span> radius = <span class="integer">1</span>;
RoundGlyph(<span class="type">int</span> r) {
        radius = r;
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">RoundGlyph.RoundGlyph(), radius = </span><span class="delimiter">&quot;</span></span> + radius);
}
<span class="type">void</span> draw() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">RoundGlyph.draw(), radius = </span><span class="delimiter">&quot;</span></span> + radius);
}
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">PolyConstructors</span> {
<span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="integer">210</span> Thinking in Java Bruce Eckel
        <span class="keyword">new</span> RoundGlyph(<span class="integer">5</span>);
}
} <span class="comment">/* Output:
     Glyph() before draw()
     RoundGlyph.draw(), radius = 0 <img src="./images/icons/callouts/1.png" alt="1">
     Glyph() after draw()
     RoundGlyph.RoundGlyph(), radius = 5
   */</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>父类构造调用 <em>draw()</em> 时，由于多态，结果调用了子类的 <em>draw()</em> 方法。</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>父类构造调用</p>
</li>
<li>
<p>父类调用 <em>draw()</em> 方法，由于多态，调用了子类的 <em>draw()</em></p>
</li>
<li>
<p>子类构造调用</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_可变的返回类型"><a class="anchor" href="#_可变的返回类型"></a>62. 可变的返回类型</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: polymorphism/CovariantReturn.java</span>
Polymorphism <span class="integer">211</span>
<span class="type">class</span> <span class="class">Grain</span> {
<span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Grain</span><span class="delimiter">&quot;</span></span>;
}
}
<span class="type">class</span> <span class="class">Wheat</span> <span class="directive">extends</span> Grain {
<span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Wheat</span><span class="delimiter">&quot;</span></span>;
}
}
<span class="type">class</span> <span class="class">Mill</span> {
Grain process() {
        <span class="keyword">return</span> <span class="keyword">new</span> Grain();
}
}
<span class="type">class</span> <span class="class">WheatMill</span> <span class="directive">extends</span> Mill {
Wheat process() { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">return</span> <span class="keyword">new</span> Wheat();
}
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">CovariantReturn</span> {
<span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Mill m = <span class="keyword">new</span> Mill();
        Grain g = m.process();
        <span class="predefined-type">System</span>.out.println(g);
        m = <span class="keyword">new</span> WheatMill();
        g = m.process();
        <span class="predefined-type">System</span>.out.println(g);
}
} <span class="comment">/* Output:
     Grain
     Wheat
   */</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>注意，<em>override</em> 父类的 <em>process</em> 方法时，返回类型是子类型。</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>JavaSE<sub>5</sub> 之前会强制子类 <em>override</em> 时必须返回相同的类型，如Grain，而现在则不会。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="_interfaces" class="sect0"><a class="anchor" href="#_interfaces"></a>Interfaces</h1>
<div class="sect1">
<h2 id="_extending_an_interface_with_inheritance"><a class="anchor" href="#_extending_an_interface_with_inheritance"></a>63. Extending an interface with inheritance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>对于接口继承时，可以同时继承多个接口。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">interface</span> <span class="class">Vampire</span> <span class="directive">extends</span> DangerousMonster, Lethal, Flyable { <img src="./images/icons/callouts/1.png" alt="1">
  <span class="type">void</span> drinkBlood();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>创建新接口时，可以多继承其它接口</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>这种多extends的情况只在接口多继承的情况下有效。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fields_in_interfaces"><a class="anchor" href="#_fields_in_interfaces"></a>64. Fields in interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Interface</em> 上的 <em>field</em> 都自动是 <em>public static final</em> 的。</p>
</div>
<div class="paragraph">
<p><em>Interface</em> 上的 <em>fields</em> 并不仅是 <em>Interface</em> 的一部分，它们的值都存储在 <strong>静态存储区域</strong> 。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nesting_interfaces"><a class="anchor" href="#_nesting_interfaces"></a>65. Nesting interfaces</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: interfaces/nesting/NestingInterfaces.java</span>
<span class="keyword">package</span> <span class="namespace">interfaces.nesting</span>;

<span class="type">class</span> <span class="class">A</span> {
  <span class="type">interface</span> <span class="class">B</span> {
    <span class="type">void</span> f();
  }
  <span class="directive">public</span> <span class="type">class</span> <span class="class">BImp</span> <span class="directive">implements</span> B {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="directive">private</span> <span class="type">class</span> <span class="class">BImp2</span> <span class="directive">implements</span> B {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="directive">public</span> <span class="type">interface</span> <span class="class">C</span> {
    <span class="type">void</span> f();
  }
  <span class="type">class</span> <span class="class">CImp</span> <span class="directive">implements</span> C {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="directive">private</span> <span class="type">class</span> <span class="class">CImp2</span> <span class="directive">implements</span> C {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="directive">private</span> <span class="type">interface</span> <span class="class">D</span> { <img src="./images/icons/callouts/1.png" alt="1">
    <span class="type">void</span> f();
  }
  <span class="directive">private</span> <span class="type">class</span> <span class="class">DImp</span> <span class="directive">implements</span> D {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="directive">public</span> <span class="type">class</span> <span class="class">DImp2</span> <span class="directive">implements</span> D {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="directive">public</span> D getD() { <span class="keyword">return</span> <span class="keyword">new</span> DImp2(); }
  <span class="directive">private</span> D dRef;
  <span class="directive">public</span> <span class="type">void</span> receiveD(D d) {
    dRef = d;
    dRef.f();
  }
}

<span class="type">interface</span> <span class="class">E</span> {
  <span class="type">interface</span> <span class="class">G</span> {
    <span class="type">void</span> f();
  }
  <span class="comment">// Redundant &quot;public&quot;:</span>
  <span class="directive">public</span> <span class="type">interface</span> <span class="class">H</span> {
    <span class="type">void</span> f();
  }
  <span class="type">void</span> g();
  <span class="comment">// Cannot be private within an interface:</span>
  <span class="comment">//! private interface I {}</span>
}


<span class="directive">public</span> <span class="type">class</span> <span class="class">NestingInterfaces</span> {
  <span class="directive">public</span> <span class="type">class</span> <span class="class">BImp</span> <span class="directive">implements</span> A.B {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="type">class</span> <span class="class">CImp</span> <span class="directive">implements</span> A.C {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="comment">// Cannot implement a private interface except</span>
  <span class="comment">// within that interface's defining class:</span>
  <span class="comment">//! class DImp implements A.D {</span>
  <span class="comment">//!  public void f() {}</span>
  <span class="comment">//! }</span>
  <span class="type">class</span> <span class="class">EImp</span> <span class="directive">implements</span> E {
    <span class="directive">public</span> <span class="type">void</span> g() {}
  }
  <span class="type">class</span> <span class="class">EGImp</span> <span class="directive">implements</span> E.G {
    <span class="directive">public</span> <span class="type">void</span> f() {}
  }
  <span class="type">class</span> <span class="class">EImp2</span> <span class="directive">implements</span> E {
    <span class="directive">public</span> <span class="type">void</span> g() {}
    <span class="type">class</span> <span class="class">EG</span> <span class="directive">implements</span> G {
      <span class="directive">public</span> <span class="type">void</span> f() {}
    }
  }
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    A a = <span class="keyword">new</span> A();
    <span class="comment">// Can't access A.D:</span>
    <span class="comment">//! A.D ad = a.getD();</span>
    <span class="comment">// Doesn't return anything but A.D:</span>
    <span class="comment">//! A.DImp2 di2 = a.getD();</span>
    <span class="comment">// Cannot access a member of the interface:</span>
    <span class="comment">//! a.getD().f();</span>
    <span class="comment">// Only another A can do anything with getD():</span>
    A a2 = <span class="keyword">new</span> A();
    a2.receiveD(a.getD());
  }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>内嵌的接口可以是 <strong><em>private</em></strong></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interfaces_and_factories"><a class="anchor" href="#_interfaces_and_factories"></a>66. Interfaces and factories</h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_innerclasses" class="sect0"><a class="anchor" href="#_innerclasses"></a>InnerClasses</h1>
<div class="openblock partintro">
<div class="content">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>It’s possible to place a class definition within another class definition.
This is called an inner class.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; zxb
</div>
</div>
<div class="paragraph">
<p>内部类是一个非常重要的特性，因为它允许你把类组合在一起同时还能控制类的可见性。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>内部类跟 <em>composition</em> 是有明显区别的。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>首先，内部类看起来就像只是简单地把类隐藏在了类中。然而，内部类做了可并不止这些。内部类可以与它所在的外部类之间进行通讯。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_inner_classes"><a class="anchor" href="#_creating_inner_classes"></a>67. Creating inner classes</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Parcel1</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel1.java</span>
<span class="comment">// Creating inner classes.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel1</span> {
    <span class="type">class</span> <span class="class">Contents</span> {
        <span class="directive">private</span> <span class="type">int</span> i = <span class="integer">11</span>;

        <span class="directive">public</span> <span class="type">int</span> value() {
            <span class="keyword">return</span> i;
        }
    }

    <span class="type">class</span> <span class="class">Destination</span> { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="directive">private</span> <span class="predefined-type">String</span> label;

        <span class="predefined-type">Destination</span>(<span class="predefined-type">String</span> whereTo) {
            label = whereTo;
        }

        <span class="predefined-type">String</span> readLabel() {
            <span class="keyword">return</span> label;
        }
    }

    <span class="comment">// Using inner classes looks just like</span>
    <span class="comment">// using any other class, within Parcel1:</span>
    <span class="directive">public</span> <span class="type">void</span> ship(<span class="predefined-type">String</span> dest) {
        Parcel1.Contents c = <span class="keyword">new</span> Contents();  <img src="./images/icons/callouts/2.png" alt="2">
        Parcel1.Destination d = <span class="keyword">new</span> <span class="predefined-type">Destination</span>(dest);

        Parcel1.Contents e = <span class="keyword">new</span> Parcel1.Contents();
        <span class="predefined-type">System</span>.out.println(d.readLabel());
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel1 p = <span class="keyword">new</span> Parcel1();
        p.ship(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tasmania</span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">/* Output:
Tasmania
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>内部类看上去与普通的类没什么区别，只是它放在了外部类里面而已</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>内部类需要使用外部类来访问它</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>然而，更通常的情况是，外部类会有一个方法来返回内部类的引用出去。</p>
</div>
<div class="listingblock">
<div class="title">Parcel2</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel2.java</span>
<span class="comment">// Returning a reference to an inner class.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel2</span> {
    <span class="type">class</span> <span class="class">Contents</span> {
        <span class="directive">private</span> <span class="type">int</span> i = <span class="integer">11</span>;

        <span class="directive">public</span> <span class="type">int</span> value() {
            <span class="keyword">return</span> i;
        }
    }

    <span class="type">class</span> <span class="class">Destination</span> {
        <span class="directive">private</span> <span class="predefined-type">String</span> label;

        <span class="predefined-type">Destination</span>(<span class="predefined-type">String</span> whereTo) {
            label = whereTo;
        }

        <span class="predefined-type">String</span> readLabel() {
            <span class="keyword">return</span> label;
        }
    }

    <span class="directive">public</span> <span class="predefined-type">Destination</span> to(<span class="predefined-type">String</span> s) { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Destination</span>(s);
    }

    <span class="directive">public</span> Contents contents() { <img src="./images/icons/callouts/2.png" alt="2">
        <span class="keyword">return</span> <span class="keyword">new</span> Contents();
    }

    <span class="directive">public</span> <span class="type">void</span> ship(<span class="predefined-type">String</span> dest) {
        Contents c = contents();
        <span class="predefined-type">Destination</span> d = to(dest);
        <span class="predefined-type">System</span>.out.println(d.readLabel());
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel2 p = <span class="keyword">new</span> Parcel2();
        p.ship(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tasmania</span><span class="delimiter">&quot;</span></span>);
        Parcel2 q = <span class="keyword">new</span> Parcel2();
        <span class="comment">// Defining references to inner classes:</span>
        Parcel2.Contents c = q.contents(); <img src="./images/icons/callouts/3.png" alt="3">
        Parcel2.Destination d = q.to(<span class="string"><span class="delimiter">&quot;</span><span class="content">Borneo</span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">/* Output:
Tasmania
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>通过外部类的 <em>to</em>　方法返回一个内部类 <em>Destination</em> 对象</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>通过外部类的 <em>contents</em>　方法返回一个内部类 <em>Contents</em> 对象</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>返回的内部类引用，须要使用 <em>OuterClassName.InnerClassName</em> 来引用哦</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>这里的内部类为包访问权限，所以如果出了这个包，你是访问不了这个内部类的，除非内部类声明为 <em>public</em></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_link_to_the_outer_class"><a class="anchor" href="#_the_link_to_the_outer_class"></a>68. The link to the outer class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>至目前为止，内部类好像只是将类隐藏及代码重新组织了，并没有其它吸引人的地方，其它并不是这样的。</p>
</div>
<div class="paragraph">
<p>当你创建一个内部类的时候，内部类中有一个 <em>link to the enclosing object that made it</em> ，即内部类中持有创建它的外部类的一个引用。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important">
</td>
<td class="content">
<div class="paragraph">
<p>内部类中可以访问外部类的所有成员，哪怕是 <em>private</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">著名的迭代器设计</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Sequence.java</span>
<span class="comment">// Holds a sequence of Objects.</span>

<span class="type">interface</span> <span class="class">Selector</span> {
    <span class="type">boolean</span> end();

    <span class="predefined-type">Object</span> current();

    <span class="type">void</span> next();
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Sequence</span> {
    <span class="directive">private</span> <span class="predefined-type">Object</span><span class="type">[]</span> items;
    <span class="directive">private</span> <span class="type">int</span> next = <span class="integer">0</span>;

    <span class="directive">public</span> <span class="predefined-type">Sequence</span>(<span class="type">int</span> size) {
        items = <span class="keyword">new</span> <span class="predefined-type">Object</span>[size];
    }

    <span class="directive">public</span> <span class="type">void</span> add(<span class="predefined-type">Object</span> x) {
        <span class="keyword">if</span> (next &lt; items.length)
            items[next++] = x;
    }

    <span class="directive">private</span> <span class="type">class</span> <span class="class">SequenceSelector</span> <span class="directive">implements</span> <span class="predefined-type">Selector</span> { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="directive">private</span> <span class="type">int</span> i = <span class="integer">0</span>;

        <span class="directive">public</span> <span class="type">boolean</span> end() {
            <span class="keyword">return</span> i == items.length; <img src="./images/icons/callouts/2.png" alt="2">
        }

        <span class="directive">public</span> <span class="predefined-type">Object</span> current() {
            <span class="keyword">return</span> items[i];
        }

        <span class="directive">public</span> <span class="type">void</span> next() {
            <span class="keyword">if</span> (i &lt; items.length) i++;
        }
    }

    <span class="directive">public</span> <span class="predefined-type">Selector</span> selector() {
        <span class="keyword">return</span> <span class="keyword">new</span> SequenceSelector(); <img src="./images/icons/callouts/3.png" alt="3">
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Sequence</span> sequence = <span class="keyword">new</span> <span class="predefined-type">Sequence</span>(<span class="integer">10</span>);
        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++)
            sequence.add(<span class="predefined-type">Integer</span>.toString(i));
        <span class="predefined-type">Selector</span> selector = sequence.selector(); <img src="./images/icons/callouts/4.png" alt="4">
        <span class="keyword">while</span> (!selector.end()) {
            <span class="predefined-type">System</span>.out.print(selector.current() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
            selector.next();
        }
    }
} <span class="comment">/* Output:
0 1 2 3 4 5 6 7 8 9
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td><em>private</em> 内部类实现了外部接口</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>内部类可以完全访问外部类的成员</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>外部类定义 <em>selector</em> 方法返回一个内部类</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>通过接口引用指向 <em>private</em> 内部类。这种方法很牛啊。完成隐藏了内部实现。</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>参考 <em>AbstractList</em> 代码，迭代器的实现跟这里完成一样。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">class</span> <span class="class">Itr</span> <span class="directive">implements</span> <span class="predefined-type">Iterator</span>&lt;E&gt;{
}

<span class="directive">public</span> <span class="predefined-type">Iterator</span>&lt;E&gt; iterator() {
    <span class="keyword">return</span> <span class="keyword">new</span> Itr();
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">内部类是如何可以自动访问外部类成员的呢</div>
<div class="paragraph">
<p>外部类在创建内部类时，内部类持有了外部类的一个引用。当你访问外部类成员时就是通过这个引用访问的。</p>
</div>
<div class="paragraph">
<p>幸运地是，编译器把所有细节帮你实现了，你在内部类中只需要直接访问外部类成员即可。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_this_and_new"><a class="anchor" href="#_using_this_and_new"></a>69. Using .this and .new</h2>
<div class="sectionbody">
<div class="paragraph">
<p>当需要在内部类中使用外部类的引用时，可以显式地使用 <em>OuterClassName.this</em> 来获取外部类的引用。</p>
</div>
<div class="sect2">
<h3 id="__this"><a class="anchor" href="#__this"></a>69.1. .this</h3>
<div class="listingblock">
<div class="title">OuterClassName.this</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/DotThis.java</span>
<span class="comment">// Qualifying access to the outer-class object.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">DotThis</span> {
    <span class="type">void</span> f() {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">DotThis.f()</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="type">class</span> <span class="class">Inner</span> {
        <span class="directive">public</span> DotThis outer() {
            <span class="keyword">return</span> DotThis.this; <img src="./images/icons/callouts/1.png" alt="1">
            <span class="comment">// A plain &quot;this&quot; would be Inner's &quot;this&quot;  </span><img src="./images/icons/callouts/2.png" alt="2">
        }
    }

    <span class="directive">public</span> Inner inner() {
        <span class="keyword">return</span> <span class="keyword">new</span> Inner();
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        DotThis dt = <span class="keyword">new</span> DotThis();
        Inner dti = dt.inner();
        dti.outer().f();
    }
} <span class="comment">/* Output:
DotThis.f()
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>通过 <em>OuterClassName.this</em> 获取外部类的引用</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>如果直接在这里使用 <em>this</em> ，那么获取的肯定只是内部类的引用</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DotThis.png" alt="DotThis">
</div>
<div class="title">Figure 1. 直接在 <em>outer</em> 方法中返回 <em>this</em></div>
</div>
</div>
<div class="sect2">
<h3 id="__new"><a class="anchor" href="#__new"></a>69.2. .new</h3>
<div class="paragraph">
<p>当需要创建内部类的对象时，即不是通过调用外部类的方法来返回一个内部类对象。此时需要使用 <em>new</em> 关键字来实现。</p>
</div>
<div class="listingblock">
<div class="title">DotNew</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/DotNew.java</span>
<span class="comment">// Creating an inner class directly using the .new syntax.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">DotNew</span> {
    <span class="directive">public</span> <span class="type">class</span> <span class="class">Inner</span> {
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        DotNew dn = <span class="keyword">new</span> DotNew();
        DotNew.Inner dni = dn.new Inner(); <img src="./images/icons/callouts/1.png" alt="1">
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>通过外部对象然后继承调用 <em>.new Inter()</em> 来创建内部对象。此处的前提是你所在的类能够访问内部类。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>通常情况下，你不可能在不创建外部类对象的情况下直接创建内部类。 <strong>除非内部类是 <em>static</em> 的（静态内部类）</strong> 。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inner_classes_and_upcasting"><a class="anchor" href="#_inner_classes_and_upcasting"></a>70. Inner classes and upcasting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>内部类通常会向上转型， <em>upcast</em>　后则一般不会 <em>downcast</em> ，因为内部类通常无法被其它类访问。这种通过 <em>base type</em> 或 <em>interface</em> 的引用访问内部类，可以很好地隐藏内部实现。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">Parcel4</span> {
  <span class="directive">private</span> <span class="type">class</span> <span class="class">PContents</span> <span class="directive">implements</span> Contents { <img src="./images/icons/callouts/1.png" alt="1">
    <span class="directive">private</span> <span class="type">int</span> i = <span class="integer">11</span>;

    <span class="directive">public</span> <span class="type">int</span> value() {
      <span class="keyword">return</span> i;
    }
  }

  <span class="directive">protected</span> <span class="type">class</span> <span class="class">PDestination</span> <span class="directive">implements</span> <span class="predefined-type">Destination</span> { <img src="./images/icons/callouts/2.png" alt="2">
    <span class="directive">private</span> <span class="predefined-type">String</span> label;

    <span class="directive">private</span> PDestination(<span class="predefined-type">String</span> whereTo) {
      label = whereTo;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> readLabel() {
      <span class="keyword">return</span> label;
    }
  }

  <span class="directive">public</span> <span class="predefined-type">String</span> destinationLabel(<span class="predefined-type">String</span> s){
    <span class="keyword">return</span> <span class="keyword">new</span> PDestination(s).label; <img src="./images/icons/callouts/3.png" alt="3">
  }

  <span class="directive">public</span> <span class="predefined-type">Destination</span> destination(<span class="predefined-type">String</span> s) {
    <span class="keyword">return</span> <span class="keyword">new</span> PDestination(s);
  }

  <span class="directive">public</span> Contents contents() {
    <span class="keyword">return</span> <span class="keyword">new</span> PContents();
  }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">TestParcel</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    Parcel4 p = <span class="keyword">new</span> Parcel4();
    Contents c = p.contents();
    <span class="predefined-type">Destination</span> d = p.destination(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tasmania</span><span class="delimiter">&quot;</span></span>); <img src="./images/icons/callouts/4.png" alt="4">
    <span class="comment">// Illegal -- can't access private class:</span>
    <span class="comment">//! Parcel4.PContents pc = p.new PContents(); </span><img src="./images/icons/callouts/5.png" alt="5">

    <span class="predefined-type">String</span> label = p.destinationLabel(<span class="string"><span class="delimiter">&quot;</span><span class="content">BeiJing</span><span class="delimiter">&quot;</span></span>);
    <span class="predefined-type">System</span>.out.println(label);
  }
}<span class="comment">///:BeiJing</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>内部类为 <em>private</em> 的，所以只有它的外部类能访问它。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>内部类为 <em>protected</em> ，则有包访问与子类访问它的权限。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>外部类中可以直接访问内部类的 <em>private</em> 成员。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>接口引用指向内部类。 <strong>如果接口引用指向的内部类为 <em>private</em> 的，那么就不能 <em>downcast</em> 了</strong> 。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/5.png" alt="5"></td>
<td>不能在其它类中访问被 <em>private</em> 修饰的内部类。</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><strong>除了内部类可以使用 <em>private</em> 和 <em>protected</em> 修饰外，其它的类只能是 <em>public</em> 或者 <em>package access</em> 。</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inner_classes_in_methods_and_scopes"><a class="anchor" href="#_inner_classes_in_methods_and_scopes"></a>71. Inner Classes in methods and scopes</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Inner Classes</em> 可以在方法内部或者其它任意的一个 <em>Scope</em> 中创建。</p>
</div>
<div class="paragraph">
<p>这么做一般有两种原因：
. 例如写了一个内部类实现一个接口，然后在方法中返回接口引用。
. 再比如你用内部类帮你解决了一个复杂的问题，但是你不希望内部类被外部访问。</p>
</div>
<div class="listingblock">
<div class="title">Nesting a class within a method</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel5.java</span>
<span class="comment">// Nesting a class within a method.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel5</span> {
    <span class="directive">public</span> <span class="predefined-type">Destination</span> destination(<span class="predefined-type">String</span> s) {
        <span class="type">class</span> <span class="class">PDestination</span> <span class="directive">implements</span> <span class="predefined-type">Destination</span> { <img src="./images/icons/callouts/1.png" alt="1">
            <span class="directive">private</span> <span class="predefined-type">String</span> label;

            <span class="directive">private</span> PDestination(<span class="predefined-type">String</span> whereTo) {
                label = whereTo;
            }

            <span class="directive">public</span> <span class="predefined-type">String</span> readLabel() {
                <span class="keyword">return</span> label;
            }
        }
        <span class="keyword">return</span> <span class="keyword">new</span> PDestination(s); <img src="./images/icons/callouts/2.png" alt="2">
    }

    <span class="comment">// private PDestination p; </span><img src="./images/icons/callouts/3.png" alt="3">

    <span class="directive">public</span> <span class="type">void</span> visitPDestination(){
        <span class="comment">// PDestination p = new PDestination();</span>
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel5 p = <span class="keyword">new</span> Parcel5();
        <span class="predefined-type">Destination</span> d = p.destination(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tasmania</span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>内部类定义在方法内部，所以这个类的 <em>scope</em>　则只有这个方法了。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td><em>Up Cast</em> 为接口引用</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>在方法外部，也就无法访问这个内部类了</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Nesting a class within a scope</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel6.java</span>
<span class="comment">// Nesting a class within a scope.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel6</span> {
    <span class="directive">private</span> <span class="type">void</span> internalTracking(<span class="type">boolean</span> b) {
        <span class="keyword">if</span> (b) {
            <span class="type">class</span> <span class="class">TrackingSlip</span> { <img src="./images/icons/callouts/1.png" alt="1">
                <span class="directive">private</span> <span class="predefined-type">String</span> id;

                TrackingSlip(<span class="predefined-type">String</span> s) {
                    id = s;
                }

                <span class="predefined-type">String</span> getSlip() {
                    <span class="keyword">return</span> id;
                }
            }
            TrackingSlip ts = <span class="keyword">new</span> TrackingSlip(<span class="string"><span class="delimiter">&quot;</span><span class="content">slip</span><span class="delimiter">&quot;</span></span>);
            <span class="predefined-type">String</span> s = ts.getSlip();
        }
        <span class="comment">// Can't use it here! Out of scope:</span>
        <span class="comment">//! TrackingSlip ts = new TrackingSlip(&quot;x&quot;);</span>
    }

    <span class="directive">public</span> <span class="type">void</span> track() {
        internalTracking(<span class="predefined-constant">true</span>);
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel6 p = <span class="keyword">new</span> Parcel6();
        p.track();
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>内部类定义在 <em>if</em> 代码块中，所以它的访问 <em>scope</em> 就只在这个 <em>if</em> 块中了。</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important">
</td>
<td class="content">
<div class="paragraph">
<p>上述定义在 <em>method</em> 或 <em>if</em> 中的内部类，并不是说在每次方法执行或进入 <em>if</em> 中时该类都会编译。
这个类同其它的普通类没什么区别，都只会在初次访问时被编译一次就够了。它与其它普通类的区别在于它的访问 <em>scope</em> 不一样。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anonymous_inner_classes"><a class="anchor" href="#_anonymous_inner_classes"></a>72. Anonymous inner classes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>语法</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">new</span> <span class="error">父</span><span class="error">类</span><span class="error">构</span><span class="error">造</span><span class="error">器</span><span class="error">（</span><span class="error">参</span><span class="error">数</span><span class="error">列</span><span class="error">表</span><span class="error">）</span>|<span class="error">实</span><span class="error">现</span><span class="error">接</span><span class="error">口</span><span class="error">（</span><span class="error">）</span>    <img src="./images/icons/callouts/1.png" alt="1">
   {
    <span class="comment">//匿名内部类的类体部分</span>
   }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>注意，匿名内部类可以是直接 new 父类或接口哦。</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">LinkedHashMap</span> map = <span class="keyword">new</span> <span class="predefined-type">LinkedHashMap</span>&lt;K, V&gt;(hashTableCapacity, hashTableLoadFactor, <span class="predefined-constant">true</span>) {
            <span class="comment">// (an anonymous inner class)</span>
            <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">long</span> serialVersionUID = <span class="integer">1</span>;

            <span class="annotation">@Override</span>
            <span class="directive">protected</span> <span class="type">boolean</span> removeEldestEntry(<span class="predefined-type">Map</span>.Entry&lt;K, V&gt; eldest) {
                <span class="keyword">return</span> size() &gt; LRUCache.this.cacheSize;
            }
        };  <img src="./images/icons/callouts/1.png" alt="1">

<span class="predefined-type">Map</span> map = <span class="keyword">new</span> <span class="predefined-type">Map</span>() {  <img src="./images/icons/callouts/2.png" alt="2">
    <span class="directive">public</span> <span class="type">int</span> size() {
        <span class="keyword">return</span> <span class="integer">0</span>;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>这就是直接 <em>new</em> 父类构造器</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>这就是直接 <em>new</em> 接口</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>下面的例子可能看起来让人困惑。</p>
</div>
<div class="sect2">
<h3 id="_作为返回值返回匿名内部类"><a class="anchor" href="#_作为返回值返回匿名内部类"></a>72.1. 作为返回值返回匿名内部类</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel7.java</span>
<span class="comment">// Returning an instance of an anonymous inner class.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel7</span> {
    <span class="directive">public</span> Contents contents() {
        <span class="keyword">return</span> <span class="keyword">new</span> Contents() { <span class="comment">// Insert a class definition </span><img src="./images/icons/callouts/1.png" alt="1">
            <span class="directive">private</span> <span class="type">int</span> i = <span class="integer">11</span>;

            <span class="directive">public</span> <span class="type">int</span> value() {
                <span class="keyword">return</span> i;
            }
        }; <span class="comment">// Semicolon required in this case</span>
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel7 p = <span class="keyword">new</span> Parcel7();
        Contents c = p.contents();
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>定义了一个匿名内部类，没有名字。该实现类直接 <em>upcast to</em>  <em>Contents</em> 了。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_传入构造函数参数给匿名内部类"><a class="anchor" href="#_传入构造函数参数给匿名内部类"></a>72.2. 传入构造函数参数给匿名内部类</h3>
<div class="paragraph">
<p>如果父类型不是接口，而是一个普通的类，并且这个类没有默认构造函数，只有带参函数时。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;

<span class="comment">//: innerclasses/Wrapping.java</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Wrapping</span> { <img src="./images/icons/callouts/1.png" alt="1">
  <span class="directive">private</span> <span class="type">int</span> i;
  <span class="directive">public</span> Wrapping(<span class="type">int</span> x) { i = x; }
  <span class="directive">public</span> <span class="type">int</span> value() { <span class="keyword">return</span> i; }
} <span class="comment">///:~</span>


<span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel8.java</span>
<span class="comment">// Calling the base-class constructor.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel8</span> {
    <span class="directive">public</span> Wrapping wrapping(<span class="type">int</span> x) {
        <span class="comment">// Base constructor call:</span>
        <span class="keyword">return</span> <span class="keyword">new</span> Wrapping(x) { <span class="comment">// Pass constructor argument.  </span><img src="./images/icons/callouts/2.png" alt="2">
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">int</span> value() {  <img src="./images/icons/callouts/3.png" alt="3">
                <span class="keyword">return</span> <span class="local-variable">super</span>.value() * <span class="integer">47</span>;
            }
        }; <span class="comment">// Semicolon required</span>
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel8 p = <span class="keyword">new</span> Parcel8();
        Wrapping w = p.wrapping(<span class="integer">10</span>);
        <span class="predefined-type">System</span>.out.println(w.value());
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>普通的 <em>Java</em>　类</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>返回一个匿名内部类的实现，此处传参 <em>x</em> 给父类的构造函数</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>重写父类的 <em>value</em> 方法</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_传参初始化匿名内部的成员变量"><a class="anchor" href="#_传参初始化匿名内部的成员变量"></a>72.3. 传参初始化匿名内部的成员变量</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel9.java</span>
<span class="comment">// An anonymous inner class that performs</span>
<span class="comment">// initialization. A briefer version of Parcel5.java.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel9</span> {
    <span class="comment">// Argument must be final to use inside</span>
    <span class="comment">// anonymous inner class:</span>
    <span class="directive">public</span> <span class="predefined-type">Destination</span> destination(<span class="directive">final</span> <span class="predefined-type">String</span> dest) { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Destination</span>() {
            <span class="directive">private</span> <span class="predefined-type">String</span> label = dest; <img src="./images/icons/callouts/2.png" alt="2">

            <span class="directive">public</span> <span class="predefined-type">String</span> readLabel() {
                <span class="keyword">return</span> label;
            }
        };
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel9 p = <span class="keyword">new</span> Parcel9();
        <span class="predefined-type">Destination</span> d = p.destination(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tasmania</span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>传参用于初始化内部类的成员变量时，传入的参数必须被 <em>final</em> 修饰</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>使用传入的参数初始化内部类的成员变量</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_匿名内部类的构造函数"><a class="anchor" href="#_匿名内部类的构造函数"></a>72.4. 匿名内部类的构造函数</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>由于匿名内部类是没有名字的，所以它自然是没有构造函数的。这里使用 <strong>构造代码块</strong> 来实现类似效果。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/AnonymousConstructor.java</span>
<span class="comment">// Creating a constructor for an anonymous inner class.</span>

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">abstract</span> <span class="type">class</span> <span class="class">Base</span> {

    {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Base initial code!</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> Base(<span class="type">int</span> i) {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Base constructor, i = </span><span class="delimiter">&quot;</span></span> + i);
    }

    <span class="directive">public</span> <span class="directive">abstract</span> <span class="type">void</span> f();
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">AnonymousConstructor</span> {
    <span class="directive">public</span> <span class="directive">static</span> Base getBase(<span class="type">int</span> i) {
        <span class="keyword">return</span> <span class="keyword">new</span> Base(i) {
            {
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Inside instance initializer</span><span class="delimiter">&quot;</span></span>); <img src="./images/icons/callouts/1.png" alt="1">
            }

            <span class="directive">public</span> <span class="type">void</span> f() {
                print(<span class="string"><span class="delimiter">&quot;</span><span class="content">In anonymous f()</span><span class="delimiter">&quot;</span></span>);
            }
        };
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Base base = getBase(<span class="integer">47</span>);
        base.f();
    }
} <span class="comment">/* Output:
Base initial code!
Base constructor, i = 47
Inside instance initializer
In anonymous f()
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>使用构造代码块执行匿名内部类的构造初始化</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_匿名内部类构造初始化"><a class="anchor" href="#_匿名内部类构造初始化"></a>72.5. 匿名内部类构造初始化</h3>
<div class="paragraph">
<p>上述的例子中参数 <em>i</em> 并没有在匿名内部类中使用，下面的例子将会使用参数并初始化。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel10.java</span>
<span class="comment">// Using &quot;instance initialization&quot; to perform</span>
<span class="comment">// construction on an anonymous inner class.</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel10</span> {
    <span class="directive">public</span> <span class="predefined-type">Destination</span> destination(<span class="directive">final</span> <span class="predefined-type">String</span> dest, <span class="directive">final</span> <span class="type">float</span> price) { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Destination</span>() {
            <span class="directive">private</span> <span class="type">int</span> cost;

            <span class="comment">// Instance initialization for each object:</span>
            {
                cost = <span class="predefined-type">Math</span>.round(price); <img src="./images/icons/callouts/3.png" alt="3">
                <span class="keyword">if</span> (cost &gt; <span class="integer">100</span>)
                    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Over budget!</span><span class="delimiter">&quot;</span></span>);
            } <img src="./images/icons/callouts/4.png" alt="4">

            <span class="directive">private</span> <span class="predefined-type">String</span> label = dest; <img src="./images/icons/callouts/2.png" alt="2">

            <span class="directive">public</span> <span class="predefined-type">String</span> readLabel() {
                <span class="keyword">return</span> label;
            }
        };
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Parcel10 p = <span class="keyword">new</span> Parcel10();
        <span class="predefined-type">Destination</span> d = p.destination(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tasmania</span><span class="delimiter">&quot;</span></span>, <span class="float">101.395F</span>);
    }
} <span class="comment">/* Output:
Over budget!
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>传入匿名内部类中使用的参数在参数列表中必须声明为 <em>final</em> 的。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>匿名内部类的成员变量初始化</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>匿名内部类的构造初始化</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>构造代码块初始化也有不方便之外，它不能重载</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>匿名内部类与常规类相比也是有许多限制之处，虽然它可以继承一个类或实现一个接口，但是：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>它只能继承一个类，不能同时实现接口</p>
</li>
<li>
<p>它只能实现一个接口，不能继承类，也不能实现多个接口</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_factory_method_revisited"><a class="anchor" href="#_factory_method_revisited"></a>73. Factory Method revisited</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Factories.java</span>

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="type">interface</span> <span class="class">Service</span> {
    <span class="type">void</span> method1();

    <span class="type">void</span> method2();
}

<span class="type">interface</span> <span class="class">ServiceFactory</span> {
    Service getService();
}

<span class="type">class</span> <span class="class">Implementation1</span> <span class="directive">implements</span> Service {
    <span class="directive">private</span> Implementation1() {
    }

    <span class="directive">public</span> <span class="type">void</span> method1() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation1 method1</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="type">void</span> method2() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation1 method2</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="directive">static</span> ServiceFactory factory =
            <span class="keyword">new</span> ServiceFactory() {
                <span class="directive">public</span> Service getService() {
                    <span class="keyword">return</span> <span class="keyword">new</span> Implementation1();
                }
            };
}

<span class="type">class</span> <span class="class">Implementation2</span> <span class="directive">implements</span> Service {
    <span class="directive">private</span> Implementation2() {
    }

    <span class="directive">public</span> <span class="type">void</span> method1() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation2 method1</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="type">void</span> method2() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation2 method2</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="directive">static</span> ServiceFactory factory =
            <span class="keyword">new</span> ServiceFactory() {
                <span class="directive">public</span> Service getService() {
                    <span class="keyword">return</span> <span class="keyword">new</span> Implementation2();
                }
            };
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Factories</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> serviceConsumer(ServiceFactory fact) {
        Service s = fact.getService();
        s.method1();
        s.method2();
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        serviceConsumer(Implementation1.factory);
        <span class="comment">// Implementations are completely interchangeable:</span>
        serviceConsumer(Implementation2.factory);
    }
} <span class="comment">/* Output:
Implementation1 method1
Implementation1 method2
Implementation2 method1
Implementation2 method2
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nested_classes_静态内部类"><a class="anchor" href="#_nested_classes_静态内部类"></a>74. Nested classes（静态内部类）</h2>
<div class="sectionbody">
<div class="paragraph">
<p>如果你不需要 <em>inner class</em> 与 <em>outer class</em> 之间有关联，你可以使用 <em>static</em> 修饰 <em>inner class</em> 。这也通常被称为 <em>Nested class</em> 。</p>
</div>
<div class="paragraph">
<p>当使用 <em>static</em> 修饰一个内部类时，也就是创建一个 <em>Nested class</em> 时，这也意味着：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>不需要一个 <em>outer class</em> 对象来创建该 <em>Nested class</em> 的对象</p>
</li>
<li>
<p><strong>在 <em>Nested class</em> 的对象中，不能访问非静态的外部类对象</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>Nested class</em> 与普通的 <em>inner class</em>　还有一个区别。普通内部类的字段与方法，只能放在类的外部层次上，所以普通的内部类不能有静态方法、字段及 <em>Nested class</em>　，然而上面这些 <em>Nested class</em> 都可以有。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/Parcel11.java</span>
<span class="comment">// Nested classes (static inner classes).</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Parcel11</span> {
    <span class="directive">private</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">ParcelContents</span> <span class="directive">implements</span> Contents { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="directive">private</span> <span class="type">int</span> i = <span class="integer">11</span>;

        <span class="directive">public</span> <span class="type">int</span> value() {
            <span class="keyword">return</span> i;
        }
    }

    <span class="directive">protected</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">ParcelDestination</span>
            <span class="directive">implements</span> <span class="predefined-type">Destination</span> { <img src="./images/icons/callouts/2.png" alt="2">
        <span class="directive">private</span> <span class="predefined-type">String</span> label;

        <span class="directive">private</span> ParcelDestination(<span class="predefined-type">String</span> whereTo) { <img src="./images/icons/callouts/3.png" alt="3">
            label = whereTo;
        }

        <span class="directive">public</span> <span class="predefined-type">String</span> readLabel() {
            <span class="keyword">return</span> label;
        }

        <span class="comment">// Nested classes can contain other static elements:</span>
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> f() {
        }

        <span class="directive">static</span> <span class="type">int</span> x = <span class="integer">10</span>;

        <span class="directive">static</span> <span class="type">class</span> <span class="class">AnotherLevel</span> { <img src="./images/icons/callouts/4.png" alt="4">
            <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> f() {
            }

            <span class="directive">static</span> <span class="type">int</span> x = <span class="integer">10</span>;
        }
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">Destination</span> destination(<span class="predefined-type">String</span> s) {
        <span class="keyword">return</span> <span class="keyword">new</span> ParcelDestination(s);
    }

    <span class="directive">public</span> <span class="directive">static</span> Contents contents() {
        <span class="keyword">return</span> <span class="keyword">new</span> ParcelContents();
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Contents c = contents();
        <span class="predefined-type">Destination</span> d = destination(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tasmania</span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>静态内部类同样可以使用 <em>private</em> 修饰</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>静态内部类同样可以使用 <em>protected</em> 修饰</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>与普通内部类一样，可以拥有普通的成员变量与方法</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>可以拥有其它静态成员，甚至 <em>Nested class</em></td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_classes_inside_interfaces"><a class="anchor" href="#_classes_inside_interfaces"></a>74.1. Classes inside interfaces</h3>
<div class="paragraph">
<p>正常情况下，在 <em>interface</em> 中不可以再放其它代码，但是一个 <em>Nested class</em> 可以放在 <em>interface</em> 中。在 <em>interface</em> 中的任何 <em>class</em> 都自动是 <em>public static</em>　的。</p>
</div>
<div class="paragraph">
<p><em>Nested class</em> 放在 <em>interface</em> 中与 <em>interface</em> 的规则并不冲突，它只是用了 <em>Interface</em> 的名称来调用而已。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ClassInInterface</span> {
    <span class="type">void</span> howdy(); <img src="./images/icons/callouts/1.png" alt="1">

    <span class="type">class</span> <span class="class">Test</span> <span class="directive">implements</span> ClassInInterface { <img src="./images/icons/callouts/2.png" alt="2">
        <span class="directive">public</span> <span class="type">void</span> howdy() {
            <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Howdy!</span><span class="delimiter">&quot;</span></span>);
        }

        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> doHowdy(){ <img src="./images/icons/callouts/3.png" alt="3">
            <span class="keyword">new</span> Test().howdy();
        }
    }
} <span class="comment">/* Output:
Howdy!
*/</span><span class="comment">//:~</span>

<span class="type">class</span> <span class="class">TestInterface</span> <span class="directive">implements</span> ClassInInterface{

    <span class="directive">public</span> <span class="type">void</span> howdy() {
        ClassInInterface.Test.doHowdy(); <img src="./images/icons/callouts/4.png" alt="4">

        <span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">TestInterface's Howdy!</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>定义接口的方法</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>定义 <em>Nested class</em> 并且实现当前这个接口。　此时 <em>Nested class</em> 默认为 <em>public static</em> 的</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>定义通用 <em>code</em> 给其它处调用</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>在其它实现类中调用 <em>Nested class</em> 中定义的通用代码</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_reaching_outward_from_a_multiply_nested_class"><a class="anchor" href="#_reaching_outward_from_a_multiply_nested_class"></a>74.2. Reaching outward from a multiply nested class</h3>
<div class="paragraph">
<p>一个内部类内嵌多少层都可以，内嵌越深的层是可以完全访问所有包围它的类的成员。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/MultiNestingAccess.java</span>
<span class="comment">// Nested classes can access all members of all</span>
<span class="comment">// levels of the classes they are nested within.</span>

<span class="type">class</span> <span class="class">MNA</span> {
    <span class="directive">private</span> <span class="type">void</span> f() {
    }

    <span class="type">class</span> <span class="class">A</span> {
        <span class="directive">private</span> <span class="type">void</span> g() {
        }

        <span class="directive">public</span> <span class="type">class</span> <span class="class">B</span> {
            <span class="type">void</span> h() {
                g(); <img src="./images/icons/callouts/1.png" alt="1">
                f();
            }
        }
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">MultiNestingAccess</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        MNA mna = <span class="keyword">new</span> MNA();
        MNA.A mnaa = mna.new A();
        MNA.A.B mnaab = mnaa.new B();
        mnaab.h();
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>完全可以访问上层的class中的成员</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_inner_classes"><a class="anchor" href="#_why_inner_classes"></a>75. Why inner classes?</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_inheriting_from_inner_class"><a class="anchor" href="#_inheriting_from_inner_class"></a>76. Inheriting from inner class</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/InheritInner.java</span>
<span class="comment">// Inheriting an inner class.</span>

<span class="type">class</span> <span class="class">WithInner</span> {
    <span class="type">class</span> <span class="class">Inner</span> {
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">InheritInner</span> <span class="directive">extends</span> WithInner.Inner {
    <span class="comment">//! InheritInner() {} // Won't compile  </span><img src="./images/icons/callouts/1.png" alt="1">
    InheritInner(WithInner wi) {  <img src="./images/icons/callouts/2.png" alt="2">
        wi.super();
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        WithInner wi = <span class="keyword">new</span> WithInner();
        InheritInner ii = <span class="keyword">new</span> InheritInner(wi);
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>直接写构造函数是编译不通过的</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>需要这么才能写出构造函数来</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_can_inner_classes_be_overridden"><a class="anchor" href="#_can_inner_classes_be_overridden"></a>77. Can inner classes be overridden?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>通过继承外部类，然后覆写内部类是不行的。不过可以通过继承外部类，然后又同时写个内部类继承外部类的内部类来实现。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/BigEgg.java</span>
<span class="comment">// An inner class cannot be overriden like a method.</span>

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="type">class</span> <span class="class">Egg</span> {
    <span class="directive">private</span> Yolk y;

    <span class="directive">protected</span> <span class="type">class</span> <span class="class">Yolk</span> {
        <span class="directive">public</span> Yolk() {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Egg.Yolk()</span><span class="delimiter">&quot;</span></span>);
        }
    }

    <span class="directive">public</span> Egg() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">New Egg()</span><span class="delimiter">&quot;</span></span>);
        y = <span class="keyword">new</span> Yolk();
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">BigEgg</span> <span class="directive">extends</span> Egg {
    <span class="directive">public</span> <span class="type">class</span> <span class="class">Yolk</span> {  <img src="./images/icons/callouts/1.png" alt="1">
        <span class="directive">public</span> Yolk() {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">BigEgg.Yolk()</span><span class="delimiter">&quot;</span></span>);
        }
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="keyword">new</span> BigEgg();
    }
} <span class="comment">/* Output:
New Egg()
Egg.Yolk()
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>这里写的 <em>Yolk</em> 类与 <em>Egg</em> 中的 <em>Yolk</em> 类是两个单独的类。这里不存在覆写。</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/BigEgg2.java</span>
<span class="comment">// Proper inheritance of an inner class.</span>

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="type">class</span> <span class="class">Egg2</span> {
    <span class="directive">protected</span> <span class="type">class</span> <span class="class">Yolk</span> {
        <span class="directive">public</span> Yolk() {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Egg2.Yolk()</span><span class="delimiter">&quot;</span></span>);
        }

        <span class="directive">public</span> <span class="type">void</span> f() {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Egg2.Yolk.f()</span><span class="delimiter">&quot;</span></span>);
        }
    }

    <span class="directive">private</span> Yolk y = <span class="keyword">new</span> Yolk();

    <span class="directive">public</span> Egg2() {
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">New Egg2()</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="type">void</span> insertYolk(Yolk yy) {
        y = yy;
    }

    <span class="directive">public</span> <span class="type">void</span> g() {
        y.f();
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">BigEgg2</span> <span class="directive">extends</span> Egg2 {
    <span class="directive">public</span> <span class="type">class</span> <span class="class">Yolk</span> <span class="directive">extends</span> Egg2.Yolk {  <img src="./images/icons/callouts/1.png" alt="1">
        <span class="directive">public</span> Yolk() {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">BigEgg2.Yolk()</span><span class="delimiter">&quot;</span></span>);
        }

        <span class="directive">public</span> <span class="type">void</span> f() {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">BigEgg2.Yolk.f()</span><span class="delimiter">&quot;</span></span>);
        }
    }

    <span class="directive">public</span> BigEgg2() {
        insertYolk(<span class="keyword">new</span> Yolk());  <img src="./images/icons/callouts/2.png" alt="2">
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        Egg2 e2 = <span class="keyword">new</span> BigEgg2();
        e2.g();  <img src="./images/icons/callouts/3.png" alt="3">
    }
} <span class="comment">/* Output:
Egg2.Yolk()
New Egg2()
Egg2.Yolk()
BigEgg2.Yolk()
BigEgg2.Yolk.f()
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>这里继承了 <em>Egg2.Yolk</em>　</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>此处构造函数中传入了当前的 <em>Yolk</em> 类的引用</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>出现了多态</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inner_class_identifiers"><a class="anchor" href="#_inner_class_identifiers"></a>78. Inner-class identifiers</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">---
<span class="keyword">package</span> <span class="namespace">innerclasses</span>;<span class="comment">//: innerclasses/LocalInnerClass.java</span>
<span class="comment">// Holds a sequence of Objects.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>import static net.mindview.util.Print.*;</p>
</div>
<div class="paragraph">
<p>interface Counter {
    int next();
}</p>
</div>
<div class="paragraph">
<p>public class LocalInnerClass {
    private int count = 0;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Counter getCounter(final String name) {
    // A local inner class:
    class LocalCounter implements Counter {
        public LocalCounter() {
            // Local inner class can have a constructor
            print("LocalCounter()");
        }</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>        public int next() {
            printnb(name); // Access local final
            return count++;
        }
    }
    return new LocalCounter();
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// The same thing with an anonymous inner class:
Counter getCounter2(final String name) {
    return new Counter() {
        // Anonymous inner class cannot have a named
        // constructor, only an instance initializer:
        {
            print("Counter()");
        }</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>        public int next() {
            printnb(name); // Access local final
            return count++;
        }
    };
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    public static void main(String[] args) {
        LocalInnerClass lic = new LocalInnerClass();
        Counter
                c1 = lic.getCounter("Local inner "),
                c2 = lic.getCounter2("Anonymous inner ");
        for (int i = 0; i &lt; 5; i++)
            print(c1.next());
        for (int i = 0; i &lt; 5; i++)
            print(c2.next());
    }
} /* Output:
LocalCounter()
Counter()
Local inner 0
Local inner 1
Local inner 2
Local inner 3
Local inner 4
Anonymous inner 5
Anonymous inner 6
Anonymous inner 7
Anonymous inner 8
Anonymous inner 9
*///:~
---</pre>
</div>
</div>
<div class="listingblock">
<div class="title">产生出来的类文件如下</div>
<div class="content">
<pre>Counter.class
LocalInnerClass$l.class         <img src="./images/icons/callouts/1.png" alt="1">
LocallnnerClassSlLocalCounter.class  <img src="./images/icons/callouts/2.png" alt="2">
LocallnnerClass.class</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>内部类，则直接在外部类后面加一个 <em>$</em> ，匿名内部类没有名字就自动产生了一个序号1</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>这个是方法内的内部类，和外部类中间多了一个S1。我理解的可能是方法的常量值？</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>嵌套多个内部类的话，则依次加 <em>$</em></td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="_holding_your_objects" class="sect0"><a class="anchor" href="#_holding_your_objects"></a>Holding Your Objects</h1>
<div class="sect1">
<h2 id="_adding_groups_of_elements"><a class="anchor" href="#_adding_groups_of_elements"></a>79. Adding groups of elements</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Collection</span>&lt;<span class="predefined-type">Integer</span>&gt; collection = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">Integer</span>&gt;(<span class="predefined-type">Arrays</span>.asList(<span class="integer">1</span>,<span class="integer">2</span>,<span class="integer">3</span>,<span class="integer">4</span>,<span class="integer">5</span>));  <img src="./images/icons/callouts/1.png" alt="1"> <img src="./images/icons/callouts/2.png" alt="2">

<span class="predefined-type">Collections</span>.addAll(collection, <span class="integer">1</span>,<span class="integer">2</span>,<span class="integer">3</span>,<span class="integer">4</span>,<span class="integer">5</span>); <img src="./images/icons/callouts/3.png" alt="3"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>使用构造函数装入其它 <em>Collection</em></td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td><em>Arrays.asList</em> 将数组转为固定数组的集合</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td><em>Collections.addAll()</em>　为集合添加元素</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important">
</td>
<td class="content">
<div class="paragraph">
<p><em>Arrays.asList()</em> 返回的是一个固定长度的数组集合，其继承了AbstractList，其内部维持了一个固定的数组。
由于它没有重写父类的 <em>add</em> 与　<em>remove</em> 方法，所以 <em>Arrays.asList()</em> 返回的 <em>List</em> 调用 <em>add</em> 或 <em>remove</em> 方法将会出现错误。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ArraysAsList.png" alt="ArraysAsList">
</div>
<div class="title">Figure 2. 见 <em>Arrays</em> 的嵌套类 <em>ArrayList</em></div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_arrays_aslist"><a class="anchor" href="#_arrays_aslist"></a>79.1. Arrays.asList</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/AsListInference.java</span>
<span class="comment">// Arrays.asList() makes its best guess about type.</span>

<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="type">class</span> <span class="class">Snow</span> {
}

<span class="type">class</span> <span class="class">Powder</span> <span class="directive">extends</span> Snow {
}

<span class="type">class</span> <span class="class">Light</span> <span class="directive">extends</span> Powder {
}

<span class="type">class</span> <span class="class">Heavy</span> <span class="directive">extends</span> Powder {
}

<span class="type">class</span> <span class="class">Crusty</span> <span class="directive">extends</span> Snow {
}

<span class="type">class</span> <span class="class">Slush</span> <span class="directive">extends</span> Snow {
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">AsListInference</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">List</span>&lt;Snow&gt; snow1 = <span class="predefined-type">Arrays</span>.asList(
                <span class="keyword">new</span> Crusty(), <span class="keyword">new</span> Slush(), <span class="keyword">new</span> Powder());

        <span class="comment">// Won't compile:</span>
        <span class="comment">// List&lt;Snow&gt; snow2 = Arrays.asList( </span><img src="./images/icons/callouts/1.png" alt="1">
        <span class="comment">//   new Light(), new Heavy());</span>
        <span class="comment">// Compiler says:</span>
        <span class="comment">// found   : java.util.List&lt;Powder&gt;</span>
        <span class="comment">// required: java.util.List&lt;Snow&gt;</span>

        <span class="comment">// Collections.addAll() doesn't get confused:</span>
        <span class="predefined-type">List</span>&lt;Snow&gt; snow3 = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;Snow&gt;();
        <span class="predefined-type">Collections</span>.addAll(snow3, <span class="keyword">new</span> Light(), <span class="keyword">new</span> Heavy()); <img src="./images/icons/callouts/2.png" alt="2">

        <span class="comment">// Give a hint using an</span>
        <span class="comment">// explicit type argument specification:</span>
        <span class="predefined-type">List</span>&lt;Snow&gt; snow4 = <span class="predefined-type">Arrays</span>.&lt;Snow&gt;asList( <img src="./images/icons/callouts/3.png" alt="3">
                <span class="keyword">new</span> Light(), <span class="keyword">new</span> Heavy());

        snow4.add(<span class="keyword">new</span> Powder()); <img src="./images/icons/callouts/4.png" alt="4">
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>这里不能编译，父类 <em>Powder</em> 不自动向上转型为 <em>Snow</em></td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>使用 <em>Collections.addAll()</em> 不会存在 (1) 中的问题</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>使用 <strong>Arrays.&lt;Snow&gt;asList</strong> 可以强制转型</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>这里调用失败，不能给 <em>Arrays.asList()</em> 返回的集合 <em>add</em> 或 <em>remove</em> 元素。</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="exception">Exception</span> in thread <span class="string"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span> java.lang.UnsupportedOperationException
        at java.util.AbstractList.add(<span class="predefined-type">AbstractList</span>.java:<span class="integer">131</span>)
        at java.util.AbstractList.add(<span class="predefined-type">AbstractList</span>.java:<span class="integer">91</span>)
        at holding.AsListInference.main(AsListInference.java:<span class="integer">45</span>)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native <span class="predefined-type">Method</span>)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="integer">39</span>)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="integer">25</span>)
        at java.lang.reflect.Method.invoke(<span class="predefined-type">Method</span>.java:<span class="integer">597</span>)
        at com.intellij.rt.execution.application.AppMain.main(AppMain.java:<span class="integer">144</span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_printing_containers"><a class="anchor" href="#_printing_containers"></a>80. Printing containers</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Array</em> 使用 <em>Arrays.toString()</em> 来输入一个可阅读的数组值。
而 <em>Map</em> 或 <em>List</em> 则可以直接输出，因为它们的父类重写了 <em>toString()</em> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/PrintingContainers.java</span>
<span class="comment">// Containers print themselves automatically.</span>

<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">PrintingContainers</span> {
    <span class="directive">static</span> <span class="predefined-type">Collection</span> fill(<span class="predefined-type">Collection</span>&lt;<span class="predefined-type">String</span>&gt; collection) {
        collection.add(<span class="string"><span class="delimiter">&quot;</span><span class="content">rat</span><span class="delimiter">&quot;</span></span>);
        collection.add(<span class="string"><span class="delimiter">&quot;</span><span class="content">cat</span><span class="delimiter">&quot;</span></span>);
        collection.add(<span class="string"><span class="delimiter">&quot;</span><span class="content">dog</span><span class="delimiter">&quot;</span></span>);
        collection.add(<span class="string"><span class="delimiter">&quot;</span><span class="content">dog</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> collection;
    }

    <span class="directive">static</span> <span class="predefined-type">Map</span> fill(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; map) {
        map.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">rat</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Fuzzy</span><span class="delimiter">&quot;</span></span>);
        map.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">cat</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Rags</span><span class="delimiter">&quot;</span></span>);
        map.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">dog</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Bosco</span><span class="delimiter">&quot;</span></span>);
        map.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">dog</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Spot</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> map;
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        print(fill(<span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt;()));
        print(fill(<span class="keyword">new</span> <span class="predefined-type">LinkedList</span>&lt;<span class="predefined-type">String</span>&gt;()));
        print(fill(<span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;<span class="predefined-type">String</span>&gt;()));
        print(fill(<span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;<span class="predefined-type">String</span>&gt;()));
        print(fill(<span class="keyword">new</span> <span class="predefined-type">LinkedHashSet</span>&lt;<span class="predefined-type">String</span>&gt;()));
        print(fill(<span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;()));
        print(fill(<span class="keyword">new</span> <span class="predefined-type">TreeMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;()));
        print(fill(<span class="keyword">new</span> <span class="predefined-type">LinkedHashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;()));
    }
} <span class="comment">/* Output:
[rat, cat, dog, dog]
[rat, cat, dog, dog]
[dog, cat, rat]
[cat, dog, rat]
[rat, cat, dog]
{dog=Spot, cat=Rags, rat=Fuzzy}
{cat=Rags, dog=Spot, rat=Fuzzy}
{rat=Fuzzy, cat=Rags, dog=Spot}
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><em>AbstractMap</em> 中重写了 <em>toString()</em></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="predefined-type">Iterator</span>&lt;Entry&lt;K,V&gt;&gt; i = entrySet().iterator();
        <span class="keyword">if</span> (! i.hasNext())
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">{}</span><span class="delimiter">&quot;</span></span>;

        <span class="predefined-type">StringBuilder</span> sb = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        sb.append(<span class="string"><span class="delimiter">'</span><span class="content">{</span><span class="delimiter">'</span></span>);
        <span class="keyword">for</span> (;;) {
            Entry&lt;K,V&gt; e = i.next();
            K key = e.getKey();
            V value = e.getValue();
            sb.append(key   == <span class="local-variable">this</span> ? <span class="string"><span class="delimiter">&quot;</span><span class="content">(this Map)</span><span class="delimiter">&quot;</span></span> : key);
            sb.append(<span class="string"><span class="delimiter">'</span><span class="content">=</span><span class="delimiter">'</span></span>);
            sb.append(value == <span class="local-variable">this</span> ? <span class="string"><span class="delimiter">&quot;</span><span class="content">(this Map)</span><span class="delimiter">&quot;</span></span> : value);
            <span class="keyword">if</span> (! i.hasNext())  <img src="./images/icons/callouts/1.png" alt="1">
                <span class="keyword">return</span> sb.append(<span class="string"><span class="delimiter">'</span><span class="content">}</span><span class="delimiter">'</span></span>).toString();
            sb.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span>);
        }
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>通过前面判断来阻止最后追加 <code>,</code></td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title"><em>AbstractCollection</em></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="predefined-type">Iterator</span>&lt;E&gt; i = iterator();
        <span class="keyword">if</span> (! i.hasNext())
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">[]</span><span class="delimiter">&quot;</span></span>;

        <span class="predefined-type">StringBuilder</span> sb = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        sb.append(<span class="string"><span class="delimiter">'</span><span class="content">[</span><span class="delimiter">'</span></span>);
        <span class="keyword">for</span> (;;) {
            E e = i.next();
            sb.append(e == <span class="local-variable">this</span> ? <span class="string"><span class="delimiter">&quot;</span><span class="content">(this Collection)</span><span class="delimiter">&quot;</span></span> : e);
            <span class="keyword">if</span> (! i.hasNext())
                <span class="keyword">return</span> sb.append(<span class="string"><span class="delimiter">'</span><span class="content">]</span><span class="delimiter">'</span></span>).toString();
            sb.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span>);
        }
    }</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Collections.png" alt="Collections">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">名称</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">说明</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ArrayList</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List，按插入顺序输出。List是不去重复的，基于数组实现。</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LinkedList</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List,按插入顺序输出。保证为插入时的顺序，基于链表实现。</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HashSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set,去重复的，无序，基于Hash查找速度快</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TreeSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set,去重复的，按字母顺序排序</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LinkedHashSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set,去重复的，保证为插入时的顺序，基于链表实现</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HashMap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map,key-value，无序的，基于Hash查找速度快</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TreeMap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map,key-value，按字母顺序排序</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LinkedHashMap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map,key-value，保证为插入时的顺序，基于Hash查找速度快，基于链表实现</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_list"><a class="anchor" href="#_list"></a>81. List</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>List</em> 接口在 <em>Collection</em> 接口之上又添加了一些方法。</p>
</div>
<div class="dlist">
<div class="title">这里有两种基本的 <em>List</em> 实现类：</div>
<dl>
<dt class="hdlist1">ArrayList</dt>
<dd>
<p>擅长随机访问元素，但是不适合在集合中间添加或删除元素。　因为它基于数组实现</p>
</dd>
<dt class="hdlist1">LinkedList</dt>
<dd>
<p>不擅长随机访问元素，适合在集合中添加或删除元素。 因为它基于链表实现</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/ListFeatures.java</span>

<span class="keyword">import</span> <span class="include">typeinfo.pets</span>.*;

<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ListFeatures</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Random</span> rand = <span class="keyword">new</span> <span class="predefined-type">Random</span>(<span class="integer">47</span>);
        <span class="predefined-type">List</span>&lt;Pet&gt; pets = Pets.arrayList(<span class="integer">7</span>);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">1: </span><span class="delimiter">&quot;</span></span> + pets);
        Hamster h = <span class="keyword">new</span> Hamster();
        pets.add(h); <span class="comment">// Automatically resizes</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">2: </span><span class="delimiter">&quot;</span></span> + pets);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">3: </span><span class="delimiter">&quot;</span></span> + pets.contains(h));
        pets.remove(h); <span class="comment">// Remove by object</span>
        Pet p = pets.get(<span class="integer">2</span>);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">4: </span><span class="delimiter">&quot;</span></span> + p + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + pets.indexOf(p));
        Pet cymric = <span class="keyword">new</span> Cymric();
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">5: </span><span class="delimiter">&quot;</span></span> + pets.indexOf(cymric));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">6: </span><span class="delimiter">&quot;</span></span> + pets.remove(cymric));
        <span class="comment">// Must be the exact object:</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">7: </span><span class="delimiter">&quot;</span></span> + pets.remove(p));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">8: </span><span class="delimiter">&quot;</span></span> + pets);
        pets.add(<span class="integer">3</span>, <span class="keyword">new</span> Mouse()); <span class="comment">// Insert at an index</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">9: </span><span class="delimiter">&quot;</span></span> + pets);
        <span class="predefined-type">List</span>&lt;Pet&gt; sub = pets.subList(<span class="integer">1</span>, <span class="integer">4</span>);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">subList: </span><span class="delimiter">&quot;</span></span> + sub);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">10: </span><span class="delimiter">&quot;</span></span> + pets.containsAll(sub));
        <span class="predefined-type">Collections</span>.sort(sub); <span class="comment">// In-place sort</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">sorted subList: </span><span class="delimiter">&quot;</span></span> + sub);
        <span class="comment">// Order is not important in containsAll():</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">11: </span><span class="delimiter">&quot;</span></span> + pets.containsAll(sub));
        <span class="predefined-type">Collections</span>.shuffle(sub, rand); <span class="comment">// Mix it up</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">shuffled subList: </span><span class="delimiter">&quot;</span></span> + sub);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">12: </span><span class="delimiter">&quot;</span></span> + pets.containsAll(sub));
        <span class="predefined-type">List</span>&lt;Pet&gt; copy = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;Pet&gt;(pets);
        sub = <span class="predefined-type">Arrays</span>.asList(pets.get(<span class="integer">1</span>), pets.get(<span class="integer">4</span>));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">sub: </span><span class="delimiter">&quot;</span></span> + sub);
        copy.retainAll(sub);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">13: </span><span class="delimiter">&quot;</span></span> + copy);
        copy = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;Pet&gt;(pets); <span class="comment">// Get a fresh copy</span>
        copy.remove(<span class="integer">2</span>); <span class="comment">// Remove by index</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">14: </span><span class="delimiter">&quot;</span></span> + copy);
        copy.removeAll(sub); <span class="comment">// Only removes exact objects</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">15: </span><span class="delimiter">&quot;</span></span> + copy);
        copy.set(<span class="integer">1</span>, <span class="keyword">new</span> Mouse()); <span class="comment">// Replace an element</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">16: </span><span class="delimiter">&quot;</span></span> + copy);
        copy.addAll(<span class="integer">2</span>, sub); <span class="comment">// Insert a list in the middle</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">17: </span><span class="delimiter">&quot;</span></span> + copy);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">18: </span><span class="delimiter">&quot;</span></span> + pets.isEmpty());
        pets.clear(); <span class="comment">// Remove all elements</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">19: </span><span class="delimiter">&quot;</span></span> + pets);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">20: </span><span class="delimiter">&quot;</span></span> + pets.isEmpty());
        pets.addAll(Pets.arrayList(<span class="integer">4</span>));
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">21: </span><span class="delimiter">&quot;</span></span> + pets);
        <span class="predefined-type">Object</span><span class="type">[]</span> o = pets.toArray();
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">22: </span><span class="delimiter">&quot;</span></span> + o[<span class="integer">3</span>]);
        Pet<span class="type">[]</span> pa = pets.toArray(<span class="keyword">new</span> Pet[<span class="integer">0</span>]);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">23: </span><span class="delimiter">&quot;</span></span> + pa[<span class="integer">3</span>].id());
    }
} <span class="comment">/* Output:
1: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug]
2: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Hamster]
3: true
4: Cymric 2
5: -1
6: false
7: true
8: [Rat, Manx, Mutt, Pug, Cymric, Pug]
9: [Rat, Manx, Mutt, Mouse, Pug, Cymric, Pug]
subList: [Manx, Mutt, Mouse]
10: true
sorted subList: [Manx, Mouse, Mutt]
11: true
shuffled subList: [Mouse, Manx, Mutt]
12: true
sub: [Mouse, Pug]
13: [Mouse, Pug]
14: [Rat, Mouse, Mutt, Pug, Cymric, Pug]
15: [Rat, Mutt, Cymric, Pug]
16: [Rat, Mouse, Cymric, Pug]
17: [Rat, Mouse, Mouse, Pug, Cymric, Pug]
18: false
19: []
20: true
21: [Manx, Cymric, Rat, EgyptianMau]
22: EgyptianMau
23: 14
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. 主要方法说明</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">方法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">说明</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">检查集合中是否存在元素</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remove</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">移除指定元素，必须与集合中的元素 equals 为 <em>true</em> 哦</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexOf</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">subList</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">containsAll</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collections.shuffle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">洗牌，打散集合中元素的顺序</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">retainAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">只保留指定 <em>subList</em> 中的元素，也就是非 <em>subList</em> 中的元素则移除</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">removeAll</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addAll</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pets.toArray(new Pet[0])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">看 <em>toArray</em> 的实现，此处指定数组长度为0时，实际上是重新 <em>new</em> 了一个数组</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_iterator"><a class="anchor" href="#_iterator"></a>82. Iterator</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Iterator</em> 提供了对 <em>Containers</em> 的统一访问，使得调用者不再需要关心具体的 <em>Container</em> 实现。</p>
</div>
<div class="paragraph">
<p><em>Java</em> <strong>Iterator</strong> 只能朝一个方向移动（遍历）。</p>
</div>
<div class="olist arabic">
<div class="title">使用 <em>Iterator</em>　可进行的操作</div>
<ol class="arabic">
<li>
<p>使用 <em>Collection</em> 的 <em>iterator()</em> 方法返回一个 <em>Iterator</em> 对象</p>
</li>
<li>
<p>获取序列中的下一对象，调用 <em>Iterator</em> 的 <em>next()</em> 方法</p>
</li>
<li>
<p>查看是否有下一对象时，使用 <em>hasNext()</em> 方法</p>
</li>
<li>
<p>移除最后获得的对象，使用 <em>remove()</em> 方法</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/SimpleIteration.java</span>

<span class="keyword">import</span> <span class="include">typeinfo.pets</span>.*;

<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleIteration</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">List</span>&lt;Pet&gt; pets = Pets.arrayList(<span class="integer">12</span>);
        <span class="predefined-type">Iterator</span>&lt;Pet&gt; it = pets.iterator();
        <span class="keyword">while</span> (it.hasNext()) {
            Pet p = it.next();
            <span class="predefined-type">System</span>.out.print(p.id() + <span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="delimiter">&quot;</span></span> + p + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
        }
        <span class="predefined-type">System</span>.out.println();
        <span class="comment">// A simpler approach, when possible:</span>
        <span class="keyword">for</span> (Pet p : pets) <img src="./images/icons/callouts/1.png" alt="1">
            <span class="predefined-type">System</span>.out.print(p.id() + <span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="delimiter">&quot;</span></span> + p + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println();
        <span class="comment">// An Iterator can also remove elements:</span>
        it = pets.iterator();
        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">6</span>; i++) {
            it.next();
            it.remove();
        }
        <span class="predefined-type">System</span>.out.println(pets);
    }
} <span class="comment">/* Output:
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
[Pug, Manx, Cymric, Rat, EgyptianMau, Hamster]
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td><em>foreach</em> 写法，实际上也是调用 <em>iterator</em> 实现的。所以它只能遍历实现了 <em>Iterator</em> 接口的 <em>container</em></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><em>remove()</em> 方法是可选的，即不是所有的 <strong>Iterator</strong> 实现类都需要实现该方法。</p>
</div>
<div class="paragraph">
<p>不过 <em>JDK</em> 中的 <em>container</em> 都实现了该方法。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_listiterator"><a class="anchor" href="#_listiterator"></a>82.1. ListIterator</h3>
<div class="paragraph">
<p><strong>ListIterator</strong> 是 <em>List</em> 专有的一个 <em>Iterator</em>　的子接口，通过调用 <em>listIterator()</em> 获得。</p>
</div>
<div class="paragraph">
<p><em>Iterator</em> 只能向 <em>next</em> 遍历，而 <strong>ListIterator</strong> 则可以向 <em>previous</em> 遍历。</p>
</div>
<div class="listingblock">
<div class="title">ListIteration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/ListIteration.java</span>

<span class="keyword">import</span> <span class="include">typeinfo.pets</span>.*;

<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ListIteration</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">List</span>&lt;Pet&gt; pets = Pets.arrayList(<span class="integer">8</span>);
        <span class="predefined-type">ListIterator</span>&lt;Pet&gt; it = pets.listIterator();
        <span class="keyword">while</span> (it.hasNext())
            <span class="predefined-type">System</span>.out.print(it.next() + <span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span> + it.nextIndex() +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span> + it.previousIndex() + <span class="string"><span class="delimiter">&quot;</span><span class="content">; </span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println();
        <span class="comment">// Backwards:</span>
        <span class="keyword">while</span> (it.hasPrevious())
            <span class="predefined-type">System</span>.out.print(it.previous().id() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println();
        <span class="predefined-type">System</span>.out.println(pets);
        it =   pets.listIterator(<span class="integer">3</span>); <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">while</span> (it.hasNext()) {
            it.next();
            it.set(Pets.randomPet()); <img src="./images/icons/callouts/2.png" alt="2">
        }
        <span class="predefined-type">System</span>.out.println(pets);
    }
} <span class="comment">/* Output:
Rat, 1, 0; Manx, 2, 1; Cymric, 3, 2; Mutt, 4, 3; Pug, 5, 4; Cymric, 6, 5; Pug, 7, 6; Manx, 8, 7;
7 6 5 4 3 2 1 0
[Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Manx]
[Rat, Manx, Cymric, Cymric, Rat, EgyptianMau, Hamster, EgyptianMau]
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>该方法的一个重载，详见文档说明。这里表示从索引位置为 <em>3</em> 处开始向 <em>next</em> 或 <em>previous</em> 遍历。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>同时还有 <em>set</em> 方法，来直接修改 <em>List</em> 中的对象</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linkedlist"><a class="anchor" href="#_linkedlist"></a>83. LinkedList</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>LinkedList</em> 同 <em>ArrayList</em> 一样实现了抽象接口 <em>List</em> ，但是它在执行往集合中间添加或移除数据时比 <em>ArrayList</em> 更方便且性能消耗小很多，相反，在随机访问元素上比不过 <em>ArrayList</em> 。</p>
</div>
<div class="paragraph">
<p><em>LinkedList</em>　添加了一些方法，使它可以像 <em>Stack</em> <em>Queue</em> 或 <em>双出口的 Queue</em> 使用。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Queue接口</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">方法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">说明</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">add</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">插入元素至队列尾部</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">插入元素至队列尾部，当使用容量有限制的队列时，此方法比 <em>add</em> 更好</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">poll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取并移除队列头部元素，如果队列为空，将返回 <em>null</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">element</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取但是不移除队列头部元素，如果队列为空，将抛出异常</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">peek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取但是不移除队列头部元素，如果队列为空，将返回 <em>null</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. LinkedList获取元素操作</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">方法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">名称</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">getFirst</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">取得队列头部元素，如果队列为空，将抛出 <em>NoSuchElementException</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">element</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">取得队列头部元素，如果队列为空，将抛出 <em>NoSuchElementException</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">peek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">取得队列头部元素，如果队列为空，将返回 <em>null</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. LinkedList移除元素操作</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">方法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">名称</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remove</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取队列头部元素并移除，如果队列为空，将抛出 <em>NoSuchElementException</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">removeFirst</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">等同于 <em>remove</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取队列头部元素并移除，如果队列为空，将返回 <em>null</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">removeLast</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取并移除队列尾部的元素</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. LinkedList添加元素操作</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">方法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">名称</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addFirst</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加元素至队列头部</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">add</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加元素至队列尾部</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addLast</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">等同于 <em>add</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">等同于 <em>add</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">LinkedListFeatures</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/LinkedListFeatures.java</span>

<span class="keyword">import</span> <span class="include">typeinfo.pets</span>.*;

<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">LinkedListFeatures</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">LinkedList</span>&lt;Pet&gt; pets =
                <span class="keyword">new</span> <span class="predefined-type">LinkedList</span>&lt;Pet&gt;(Pets.arrayList(<span class="integer">5</span>));
        print(pets);
        <span class="comment">// Identical:</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">pets.getFirst(): </span><span class="delimiter">&quot;</span></span> + pets.getFirst());
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">pets.element(): </span><span class="delimiter">&quot;</span></span> + pets.element());
        <span class="comment">// Only differs in empty-list behavior:</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">pets.peek(): </span><span class="delimiter">&quot;</span></span> + pets.peek());
        <span class="comment">// Identical; remove and return the first element:</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">pets.remove(): </span><span class="delimiter">&quot;</span></span> + pets.remove());
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">pets.removeFirst(): </span><span class="delimiter">&quot;</span></span> + pets.removeFirst());
        <span class="comment">// Only differs in empty-list behavior:</span>
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">pets.poll(): </span><span class="delimiter">&quot;</span></span> + pets.poll());
        print(pets);
        pets.addFirst(<span class="keyword">new</span> Rat());
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">After addFirst(): </span><span class="delimiter">&quot;</span></span> + pets);
        pets.offer(Pets.randomPet());
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">After offer(): </span><span class="delimiter">&quot;</span></span> + pets);
        pets.add(Pets.randomPet());
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">After add(): </span><span class="delimiter">&quot;</span></span> + pets);
        pets.addLast(<span class="keyword">new</span> Hamster());
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">After addLast(): </span><span class="delimiter">&quot;</span></span> + pets);
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">pets.removeLast(): </span><span class="delimiter">&quot;</span></span> + pets.removeLast());
    }
} <span class="comment">/* Output:
[Rat, Manx, Cymric, Mutt, Pug]
pets.getFirst(): Rat
pets.element(): Rat
pets.peek(): Rat
pets.remove(): Rat
pets.removeFirst(): Manx
pets.poll(): Cymric
[Mutt, Pug]
After addFirst(): [Rat, Mutt, Pug]
After offer(): [Rat, Mutt, Pug, Cymric]
After add(): [Rat, Mutt, Pug, Cymric, Pug]
After addLast(): [Rat, Mutt, Pug, Cymric, Pug, Hamster]
pets.removeLast(): Hamster
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stack"><a class="anchor" href="#_stack"></a>84. Stack</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Stack</em> 经常被称为 <strong>"last-in,first-out"</strong> 的 <em>container</em> ，也被称为 <em>push down</em> 栈，向下存储。因为你最后放入的元素，将会是第一个被你弹出的元素。</p>
</div>
<div class="paragraph">
<p><em>LinkedList</em> 中有相关的方法直接实现了 <em>Stack</em> 的功能，所以你甚至可以直接使用 <em>LinkedList</em> 当作 <em>Stack</em> 使用。然而有时候， <em>Stack</em> 更有语义一些。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/stackQueue.png" alt="stackQueue">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set"><a class="anchor" href="#_set"></a>85. Set</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">名称</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">说明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HashSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">基于hash的快速查找</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LinkedHashSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">基于hash的快速查找，且保持了元素的顺序，按插入时的顺序保存</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TreeSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">基于红黑树的Set，按指定的compator排序。</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>String.CASE_INSENSITIVE_ORDER 是 <em>String</em> 类提供的可以忽略大小写的 <em>Compator</em></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_map"><a class="anchor" href="#_map"></a>86. Map</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_queue"><a class="anchor" href="#_queue"></a>87. Queue</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>queue</em> 是一个典型的 <em>FIFO</em> (first-in, first-out) 容器，即 <strong>先入先出</strong> 。</p>
</div>
<div class="paragraph">
<p>队列通常用于从程序的某一处将对象传输到另一处，尤其在多线程情况下可以安全地将对象从一个任务传输到另一个任务中。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/queue.png" alt="queue">
</div>
<div class="title">Figure 3. 类图</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p><em>LinkedList</em> 实现了 <em>Queue</em> 接口。</p>
</div>
<div class="paragraph">
<p><em>Queue</em> 接口继承自 <em>Collection</em> 接口。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_priorityqueue"><a class="anchor" href="#_priorityqueue"></a>87.1. PriorityQueue</h3>
<div class="paragraph">
<p><em>PriorityQueue</em> 即带有优先级顺序的队列，即优先级越高的对象越靠前。</p>
</div>
<div class="listingblock">
<div class="title">使用示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/PriorityQueueDemo.java</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">PriorityQueueDemo</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">Integer</span>&gt; priorityQueue =
      <span class="keyword">new</span> <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">Integer</span>&gt;();
    <span class="predefined-type">Random</span> rand = <span class="keyword">new</span> <span class="predefined-type">Random</span>(<span class="integer">47</span>);
    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++)
      priorityQueue.offer(rand.nextInt(i + <span class="integer">10</span>));
    QueueDemo.printQ(priorityQueue);

    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; ints = <span class="predefined-type">Arrays</span>.asList(<span class="integer">25</span>, <span class="integer">22</span>, <span class="integer">20</span>,
      <span class="integer">18</span>, <span class="integer">14</span>, <span class="integer">9</span>, <span class="integer">3</span>, <span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">9</span>, <span class="integer">14</span>, <span class="integer">18</span>, <span class="integer">21</span>, <span class="integer">23</span>, <span class="integer">25</span>);
    priorityQueue = <span class="keyword">new</span> <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">Integer</span>&gt;(ints);
    QueueDemo.printQ(priorityQueue);
    priorityQueue = <span class="keyword">new</span> <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">Integer</span>&gt;(
        ints.size(), <span class="predefined-type">Collections</span>.reverseOrder());
    priorityQueue.addAll(ints);
    QueueDemo.printQ(priorityQueue);

    <span class="predefined-type">String</span> fact = <span class="string"><span class="delimiter">&quot;</span><span class="content">EDUCATION SHOULD ESCHEW OBFUSCATION</span><span class="delimiter">&quot;</span></span>;
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; strings = <span class="predefined-type">Arrays</span>.asList(fact.split(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>));
    <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">String</span>&gt; stringPQ =
      <span class="keyword">new</span> <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">String</span>&gt;(strings);
    QueueDemo.printQ(stringPQ);
    stringPQ = <span class="keyword">new</span> <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">String</span>&gt;(
      strings.size(), <span class="predefined-type">Collections</span>.reverseOrder());
    stringPQ.addAll(strings);
    QueueDemo.printQ(stringPQ);

    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Character</span>&gt; charSet = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;<span class="predefined-type">Character</span>&gt;();
    <span class="keyword">for</span>(<span class="type">char</span> c : fact.toCharArray())
      charSet.add(c); <span class="comment">// Autoboxing</span>
    <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">Character</span>&gt; characterPQ =
      <span class="keyword">new</span> <span class="predefined-type">PriorityQueue</span>&lt;<span class="predefined-type">Character</span>&gt;(charSet);
    QueueDemo.printQ(characterPQ);
  }
} <span class="comment">/* Output:
0 1 1 1 1 1 3 5 8 14
1 1 2 3 3 9 9 14 14 18 18 20 21 22 23 25 25
25 25 23 22 21 20 18 18 14 14 9 9 3 3 2 1 1
       A A B C C C D D E E E F H H I I L N N O O O O S S S T T U U U W
W U U U T T S S S O O O O N N L I I H H F E E E D D C C C B A A
  A B C D E F H I L N O S T U W
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>这里在队列中放 <em>String</em> 或 <em>Integer</em> 等对象可以排序是因为这些对象有默认的排序方法。</p>
</li>
<li>
<p>在 <em>PriorityQueue</em> 中可以指定 <em>Comparator</em> 来进行排序，如 <em>Collections.reverseOrder()</em></p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_collection_vs_iterator"><a class="anchor" href="#_collection_vs_iterator"></a>88. Collection vs. Iterator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>由于 <em>Collection</em> 接口继承自 <em>Iterable</em> 接口，所以 <em>Collection</em> 都必须实现 <em>Iterator&lt;T&gt; iterator()</em> 方法</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_foreach_and_iterators"><a class="anchor" href="#_foreach_and_iterators"></a>89. Foreach and iterators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JavaSE<sub>5</sub> 引入了 <em>Iterable</em> 接口，所有实现了该接口的 <em>Container</em> 都可以使用 <em>foreach</em> 来遍历</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="title">Array is not a Iterable</div>
<div class="paragraph">
<p><em>Array</em> 并不是一个 <em>Iterable</em> ，虽然 <em>Array</em> 也可以使用 <em>foreach</em> 进行遍历。</p>
</div>
<div class="paragraph">
<p>如果需要将 <em>Array</em> 转换为 <em>Iterable</em> ，则可以使用如 <em>Arrays.asList(array)</em> 来实现。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_the_adapter_method_idiom"><a class="anchor" href="#_the_adapter_method_idiom"></a>89.1. The Adapter Method idiom</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">适配方法</dt>
<dd>
<p>此处借用适配器模式的名字来说的。这里是指在 <em>Container</em> 中通过接口适配实现另一种排序方式。</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">示例1</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/AdapterMethodIdiom.java</span>
<span class="comment">// The &quot;Adapter Method&quot; idiom allows you to use foreach</span>
<span class="comment">// with additional kinds of Iterables.</span>

<span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="keyword">import</span> <span class="include">java.util.Arrays</span>;
<span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">java.util.Iterator</span>;

<span class="type">class</span> <span class="class">ReversibleArrayList</span>&lt;T&gt; <span class="directive">extends</span> <span class="predefined-type">ArrayList</span>&lt;T&gt; {
    <span class="directive">public</span> ReversibleArrayList(<span class="predefined-type">Collection</span>&lt;T&gt; c) {
        <span class="local-variable">super</span>(c);
    }

    <span class="directive">public</span> <span class="predefined-type">Iterable</span>&lt;T&gt; reversed() { <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Iterable</span>&lt;T&gt;() {
            <span class="directive">public</span> <span class="predefined-type">Iterator</span>&lt;T&gt; iterator() {
                <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Iterator</span>&lt;T&gt;() {
                    <span class="type">int</span> current = size() - <span class="integer">1</span>;

                    <span class="directive">public</span> <span class="type">boolean</span> hasNext() {
                        <span class="keyword">return</span> current &gt; -<span class="integer">1</span>;
                    }

                    <span class="directive">public</span> T next() {
                        <span class="keyword">return</span> get(current--);
                    }

                    <span class="directive">public</span> <span class="type">void</span> remove() { <span class="comment">// Not implemented</span>
                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">UnsupportedOperationException</span>();
                    }
                };
            }
        };
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">AdapterMethodIdiom</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        ReversibleArrayList&lt;<span class="predefined-type">String</span>&gt; ral =
                <span class="keyword">new</span> ReversibleArrayList&lt;<span class="predefined-type">String</span>&gt;(
                        <span class="predefined-type">Arrays</span>.asList(<span class="string"><span class="delimiter">&quot;</span><span class="content">To be or not to be</span><span class="delimiter">&quot;</span></span>.split(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>)));
        <span class="comment">// Grabs the ordinary iterator via iterator():</span>
        <span class="keyword">for</span> (<span class="predefined-type">String</span> s : ral)
            <span class="predefined-type">System</span>.out.print(s + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println();
        <span class="comment">// Hand it the Iterable of your choice</span>
        <span class="keyword">for</span> (<span class="predefined-type">String</span> s : ral.reversed()) <img src="./images/icons/callouts/2.png" alt="2">
            <span class="predefined-type">System</span>.out.print(s + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">/* Output:
To be or not to be
be to not or be To
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>注意，此处返回的是 <em>Iterable</em> 接口</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>因为 <em>reversed()</em> 方法返回的是 <em>Iterable</em> 接口的实现，所以它可以被 <em>foreach</em> 遍历</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>通过上面的这种方式，可以添加 <strong>多种遍历方式</strong> 。</p>
</div>
<div class="listingblock">
<div class="title">示例2</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">holding</span>;<span class="comment">//: holding/MultiIterableClass.java</span>
<span class="comment">// Adding several Adapter Methods.</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MultiIterableClass</span> <span class="directive">extends</span> IterableClass {
  <span class="directive">public</span> <span class="predefined-type">Iterable</span>&lt;<span class="predefined-type">String</span>&gt; reversed() {
    <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Iterable</span>&lt;<span class="predefined-type">String</span>&gt;() {
      <span class="directive">public</span> <span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">String</span>&gt; iterator() {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">String</span>&gt;() {
          <span class="type">int</span> current = words.length - <span class="integer">1</span>;
          <span class="directive">public</span> <span class="type">boolean</span> hasNext() { <span class="keyword">return</span> current &gt; -<span class="integer">1</span>; }
          <span class="directive">public</span> <span class="predefined-type">String</span> next() { <span class="keyword">return</span> words[current--]; }
          <span class="directive">public</span> <span class="type">void</span> remove() { <span class="comment">// Not implemented</span>
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">UnsupportedOperationException</span>();
          }
        };
      }
    };
  }
  <span class="directive">public</span> <span class="predefined-type">Iterable</span>&lt;<span class="predefined-type">String</span>&gt; randomized() {
    <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Iterable</span>&lt;<span class="predefined-type">String</span>&gt;() {
      <span class="directive">public</span> <span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">String</span>&gt; iterator() {
        <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; shuffled =
          <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt;(<span class="predefined-type">Arrays</span>.asList(words));
        <span class="predefined-type">Collections</span>.shuffle(shuffled, <span class="keyword">new</span> <span class="predefined-type">Random</span>(<span class="integer">47</span>));
        <span class="keyword">return</span> shuffled.iterator();
      }
    };
  }
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    MultiIterableClass mic = <span class="keyword">new</span> MultiIterableClass();
    <span class="keyword">for</span>(<span class="predefined-type">String</span> s : mic.reversed())
      <span class="predefined-type">System</span>.out.print(s + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    <span class="predefined-type">System</span>.out.println();
    <span class="keyword">for</span>(<span class="predefined-type">String</span> s : mic.randomized())
      <span class="predefined-type">System</span>.out.print(s + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    <span class="predefined-type">System</span>.out.println();
    <span class="keyword">for</span>(<span class="predefined-type">String</span> s : mic)
      <span class="predefined-type">System</span>.out.print(s + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
  }
} <span class="comment">/* Output:
banana-shaped. be to Earth the know we how is that And
is banana-shaped. Earth that how the be And we know to
And that is how we know the Earth to be banana-shaped.
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary_3"><a class="anchor" href="#_summary_3"></a>90. Summary</h2>
<div class="sectionbody">
<div class="olist arabic">
<div class="title"><strong>Java</strong> 提供了一系列容器用于保存对象</div>
<ol class="arabic">
<li>
<p><em>array</em> 将下标与对象关联，通过下标获取到对象。 <em>array</em> 是通过精确的类型保存的，所以不存在取对象出来时还需要拆箱的。<em>array</em> 可以保存基本类型数据，然而 <em>array</em> 不能 <em>resize</em></p>
</li>
<li>
<p><em>Collection</em> 用于保存一组单个对象， <em>Map</em> 用于保存一组有关联的键值对。使用 <em>Java</em> 泛型后，可以不再需要装箱与拆箱的动作了。 <em>Collection</em> 与 <em>Map</em> 都可以在容量达到后自动 <em>resize</em> 。<em>Collection</em> 与 <em>Map</em> 都不能保存基本数据类型，但是可以保存它们的包装类型。</p>
</li>
<li>
<p>同 <em>array</em> 类似， <em>List</em> 也通过下标与对象关联，所以 <em>array</em> 与 <em>List</em> 都是有序的容器。</p>
</li>
<li>
<p>如果你经常使用 <em>random access</em> ，那么请选用 <em>ArrayList</em> 。如果在 <em>List</em> 中间频繁插入与删除的话，那么应该选择 <em>LinkedList</em></p>
</li>
<li>
<p><em>Queue</em> 与 <em>Stack</em> 的行为可以通过 <em>LinkedList</em> 提供。</p>
</li>
<li>
<p><em>Map</em> 是一种将对象与对象关联的方式。 <em>HashMap</em> 主要用于快速访问， <em>TreeMap</em> 则保证元素有序，访问速度不如 <em>HashMap</em> ，而 <em>LinkedHashMap</em> 则保证了元素按插入时的顺序，同时也提供了快速访问。</p>
</li>
<li>
<p><em>Set</em> 则是保证了元素非重复。 <em>HashSet</em> 提供了快速访问， <em>TreeSet</em> 保证了元素有序，而 <em>LinkedHashSet</em> 则保证元素按插入的顺序，同时提供快速访问。</p>
</li>
<li>
<p>现在不推荐使用过时的如 <em>Vector</em> , <em>Hashtable</em> , <em>Stack</em> 了。</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/container.png" alt="container">
</div>
<div class="title">Figure 4. 容器简单类图</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>实线为实现类</p>
</li>
<li>
<p>虚线为接口</p>
</li>
<li>
<p>实心箭头表示 Produces</p>
</li>
</ol>
</div>
</div>
</div>
<h1 id="_error_handling_with_exceptions" class="sect0"><a class="anchor" href="#_error_handling_with_exceptions"></a>Error Handling with Exceptions</h1>
<div class="sect1">
<h2 id="_concepts"><a class="anchor" href="#_concepts"></a>91. Concepts</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_finally"><a class="anchor" href="#_finally"></a>92. finally</h2>
<div class="sectionbody">
<div class="olist arabic">
<div class="title">finally不执行的时机</div>
<ol class="arabic">
<li>
<p>finally在使用label标记的代码块跳出时（GOTO)不会被执行。</p>
</li>
<li>
<p>finally在使用System.exit(0)时不会被执行。</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_异常丢失情况"><a class="anchor" href="#_异常丢失情况"></a>92.1. 异常丢失情况</h3>
<div class="listingblock">
<div class="title">异常丢失在finally的throw Exception</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">exceptions</span>;<span class="comment">//: exceptions/LostMessage.java</span>
<span class="comment">// How an exception can be lost.</span>

<span class="type">class</span> <span class="class">VeryImportantException</span> <span class="directive">extends</span> <span class="exception">Exception</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">A very important exception!</span><span class="delimiter">&quot;</span></span>;
    }
}

<span class="type">class</span> <span class="class">HoHumException</span> <span class="directive">extends</span> <span class="exception">Exception</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">A trivial exception</span><span class="delimiter">&quot;</span></span>;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">LostMessage</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="keyword">try</span> {
            LostMessage lm = <span class="keyword">new</span> LostMessage();
            <span class="keyword">try</span> {
                lm.f();
            } <span class="keyword">finally</span> {
                lm.dispose(); <img src="./images/icons/callouts/1.png" alt="1">
            }
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="predefined-type">System</span>.out.println(e);
        }
    }

    <span class="type">void</span> f() <span class="directive">throws</span> VeryImportantException {
        <span class="keyword">throw</span> <span class="keyword">new</span> VeryImportantException();
    }

    <span class="type">void</span> dispose() <span class="directive">throws</span> HoHumException {
        <span class="keyword">throw</span> <span class="keyword">new</span> HoHumException();
    }
} <span class="comment">/* Output:
A trivial exception
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>finally块中又抛出了异常， <em>try</em> 块中的异常被丢失，无法被上层捕捉</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">try-finally中return沉默异常</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">exceptions</span>;<span class="comment">//: exceptions/ExceptionSilencer.java</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">ExceptionSilencer</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="keyword">try</span> {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>();
        } <span class="keyword">finally</span> {
            <span class="comment">// Using 'return' inside the finally block</span>
            <span class="comment">// will silence any thrown exception.</span>
            <span class="keyword">return</span>;
        }
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exception_restrictions"><a class="anchor" href="#_exception_restrictions"></a>93. Exception restrictions</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>覆写方法时，子类不能抛出比父类更多的异常</p>
</li>
<li>
<p>覆写方法时，子类可以抛出比父类少的异常或者不抛出异常</p>
</li>
<li>
<p>覆写方法时，子类可以抛出与父类相同的异常</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_constuctors"><a class="anchor" href="#_constuctors"></a>94. Constuctors</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_exception_guidelines"><a class="anchor" href="#_exception_guidelines"></a>95. Exception GuideLines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>以下情况下使用异常</p>
</div>
<div class="olist arabic">
<div class="title">异常使用指南</div>
<ol class="arabic">
<li>
<p>在适当的级别处理异常。千万不要在你不知道如何处理这个异常时去捕捉这个异常。</p>
</li>
<li>
<p>处理问题</p>
</li>
<li>
<p>修补程序并继续执行程序</p>
</li>
<li>
<p>在当前 <em>context</em> 下处理一些事，并且将 <em>Exception</em> 继续向上抛</p>
</li>
<li>
<p>在当前 <em>context</em> 下处理一些事，并且向上抛出一个不一样的类型的 <em>Exception</em></p>
</li>
<li>
<p>终止程序</p>
</li>
<li>
<p>简化程序</p>
</li>
<li>
<p>使程序更安全，拙壮</p>
</li>
</ol>
</div>
</div>
</div>
<h1 id="_strings" class="sect0"><a class="anchor" href="#_strings"></a>Strings</h1>
<div class="sect1">
<h2 id="_immutable_strings"><a class="anchor" href="#_immutable_strings"></a>96. Immutable Strings</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>String</em> 对象是不可变的。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overloading_vs_stringbuilder"><a class="anchor" href="#_overloading_vs_stringbuilder"></a>97. Overloading ‘+’ vs. StringBuilder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>使用&#8217;+&#8217;可以用来拼接字符串</p>
</div>
<div class="listingblock">
<div class="title">示例1</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/Concatenation.java</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">Concatenation</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">String</span> mango = <span class="string"><span class="delimiter">&quot;</span><span class="content">mango</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">String</span> s = <span class="string"><span class="delimiter">&quot;</span><span class="content">abc</span><span class="delimiter">&quot;</span></span> + mango + <span class="string"><span class="delimiter">&quot;</span><span class="content">def</span><span class="delimiter">&quot;</span></span> + <span class="integer">47</span>;
        <span class="predefined-type">System</span>.out.println(s);
    }
} <span class="comment">/* Output:
abcmangodef47
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>此时可以使用 <code>javap -c Concatenation.class</code> 看反汇编后的代码，通过这个即看具体的实现细节。</p>
</div>
<div class="listingblock">
<div class="title">示例1细节</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Compiled from <span class="string"><span class="delimiter">&quot;</span><span class="content">Concatenation.java</span><span class="delimiter">&quot;</span></span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">strings</span>.Concatenation {
  <span class="directive">public</span> strings.Concatenation();
    Code:
       <span class="integer">0</span>: aload_0
       <span class="integer">1</span>: invokespecial <span class="error">#</span><span class="integer">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span>
       <span class="integer">4</span>: <span class="keyword">return</span>

  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(java.lang.String<span class="type">[]</span>);
    Code:
       <span class="integer">0</span>: ldc           <span class="error">#</span><span class="integer">2</span>                  <span class="comment">// String mango</span>
       <span class="integer">2</span>: astore_1
       <span class="integer">3</span>: <span class="keyword">new</span>           <span class="error">#</span><span class="integer">3</span>                  <span class="comment">// class java/lang/StringBuilder</span>
       <span class="integer">6</span>: dup
       <span class="integer">7</span>: invokespecial <span class="error">#</span><span class="integer">4</span>                  <span class="comment">// Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span>
      <span class="integer">10</span>: ldc           <span class="error">#</span><span class="integer">5</span>                  <span class="comment">// String abc</span>
      <span class="integer">12</span>: invokevirtual <span class="error">#</span><span class="integer">6</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
      <span class="integer">15</span>: aload_1
      <span class="integer">16</span>: invokevirtual <span class="error">#</span><span class="integer">6</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
      <span class="integer">19</span>: ldc           <span class="error">#</span><span class="integer">7</span>                  <span class="comment">// String def</span>
      <span class="integer">21</span>: invokevirtual <span class="error">#</span><span class="integer">6</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
      <span class="integer">24</span>: bipush        <span class="integer">47</span>
      <span class="integer">26</span>: invokevirtual <span class="error">#</span><span class="integer">8</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;</span>
      <span class="integer">29</span>: invokevirtual <span class="error">#</span><span class="integer">9</span>                  <span class="comment">// Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span>
      <span class="integer">32</span>: astore_2
      <span class="integer">33</span>: getstatic     <span class="error">#</span><span class="integer">10</span>                 <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span>
      <span class="integer">36</span>: aload_2
      <span class="integer">37</span>: invokevirtual <span class="error">#</span><span class="integer">11</span>                 <span class="comment">// Method java/io/PrintStream.println:(Ljava/lang/String;)V</span>
      <span class="integer">40</span>: <span class="keyword">return</span>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>由此可见， “+” 追加字符串实际上是用 <em>StringBuilder</em> 来 <em>append</em> 的。</p>
</div>
</td>
</tr>
</table>
</div>
<hr>
<div class="paragraph">
<p>然而在 <em>for</em> 循环时，使用 <code>+</code> （隐式使用 <em>StringBuilder</em> ） 与 <code>StringBuilder</code> 还是有区别的。</p>
</div>
<div class="listingblock">
<div class="title">示例2</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/WhitherStringBuilder.java</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">WhitherStringBuilder</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> implicit(<span class="predefined-type">String</span><span class="type">[]</span> fields) {
        <span class="predefined-type">String</span> result = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; fields.length; i++)
            result += fields[i];  <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">return</span> result;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> explicit(<span class="predefined-type">String</span><span class="type">[]</span> fields) {
        <span class="predefined-type">StringBuilder</span> result = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>(); <img src="./images/icons/callouts/2.png" alt="2">
        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; fields.length; i++)
            result.append(fields[i]);
        <span class="keyword">return</span> result.toString();
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>隐式使用 StringBuilder</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td>显式使用 StringBuilder</td>
</tr>
</table>
</div>
<div class="quoteblock">
<blockquote>
<div class="literalblock">
<div class="content">
<pre>javap -c WitherStringBuilder.class</pre>
</div>
</div>
</blockquote>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">strings</span>.WhitherStringBuilder {
  <span class="directive">public</span> strings.WhitherStringBuilder();
    Code:
       <span class="integer">0</span>: aload_0
       <span class="integer">1</span>: invokespecial <span class="error">#</span><span class="integer">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span>
       <span class="integer">4</span>: <span class="keyword">return</span>

  <span class="directive">public</span> java.lang.String implicit(java.lang.String<span class="type">[]</span>);
    Code:
       <span class="integer">0</span>: ldc           <span class="error">#</span><span class="integer">2</span>                  <span class="comment">// String</span>
       <span class="integer">2</span>: astore_2
       <span class="integer">3</span>: iconst_0
       <span class="integer">4</span>: istore_3
       <span class="integer">5</span>: iload_3
       <span class="integer">6</span>: aload_1
       <span class="integer">7</span>: arraylength
       <span class="integer">8</span>: if_icmpge     <span class="integer">38</span>
      <span class="integer">11</span>: <span class="keyword">new</span>           <span class="error">#</span><span class="integer">3</span>                  <span class="comment">// class java/lang/StringBuilder</span>
      <span class="integer">14</span>: dup
      <span class="integer">15</span>: invokespecial <span class="error">#</span><span class="integer">4</span>                  <span class="comment">// Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V  </span><img src="./images/icons/callouts/1.png" alt="1">
      <span class="integer">18</span>: aload_2
      <span class="integer">19</span>: invokevirtual <span class="error">#</span><span class="integer">5</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
      <span class="integer">22</span>: aload_1
      <span class="integer">23</span>: iload_3
      <span class="integer">24</span>: aaload
      <span class="integer">25</span>: invokevirtual <span class="error">#</span><span class="integer">5</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
      <span class="integer">28</span>: invokevirtual <span class="error">#</span><span class="integer">6</span>                  <span class="comment">// Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span>
      <span class="integer">31</span>: astore_2
      <span class="integer">32</span>: iinc          <span class="integer">3</span>, <span class="integer">1</span>
      <span class="integer">35</span>: <span class="reserved">goto</span>          <span class="integer">5</span>
      <span class="integer">38</span>: aload_2
      <span class="integer">39</span>: areturn

  <span class="directive">public</span> java.lang.String explicit(java.lang.String<span class="type">[]</span>);
    Code:
       <span class="integer">0</span>: <span class="keyword">new</span>           <span class="error">#</span><span class="integer">3</span>                  <span class="comment">// class java/lang/StringBuilder</span>
       <span class="integer">3</span>: dup
       <span class="integer">4</span>: invokespecial <span class="error">#</span><span class="integer">4</span>                  <span class="comment">// Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span>
       <span class="integer">7</span>: astore_2
       <span class="integer">8</span>: iconst_0
       <span class="integer">9</span>: istore_3
      <span class="integer">10</span>: iload_3
      <span class="integer">11</span>: aload_1
      <span class="integer">12</span>: arraylength
      <span class="integer">13</span>: if_icmpge     <span class="integer">30</span>
      <span class="integer">16</span>: aload_2
      <span class="integer">17</span>: aload_1
      <span class="integer">18</span>: iload_3
      <span class="integer">19</span>: aaload
      <span class="integer">20</span>: invokevirtual <span class="error">#</span><span class="integer">5</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
      <span class="integer">23</span>: pop
      <span class="integer">24</span>: iinc          <span class="integer">3</span>, <span class="integer">1</span>
      <span class="integer">27</span>: <span class="reserved">goto</span>          <span class="integer">10</span>
      <span class="integer">30</span>: aload_2
      <span class="integer">31</span>: invokevirtual <span class="error">#</span><span class="integer">6</span>                  <span class="comment">// Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span>
      <span class="integer">34</span>: areturn
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td><em>implicit</em> 方法中 <code>'+</code>' 的隐式创建 <em>StringBuilder</em> 是在 <em>for</em> 循环中完成的。</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><em>for</em> 循环中不要使用 <code>+</code> 来追加字符串，因为每次都在重新 <em>new</em> 一个 <em>StringBuilder</em> 。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>与 <em>StringBuilder</em> 类似的是 <em>StringBuffer</em> ， <em>StringBuffer</em> 为线程安全的。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unintended_recursion"><a class="anchor" href="#_unintended_recursion"></a>98. Unintended recursion</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">无限递归</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/InfiniteRecursion.java</span>
<span class="comment">// Accidental recursion.</span>
<span class="comment">// {RunByHand}</span>

<span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">InfiniteRecursion</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">List</span>&lt;InfiniteRecursion&gt; v =
                <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;InfiniteRecursion&gt;();
        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++)
            v.add(<span class="keyword">new</span> InfiniteRecursion());
        <span class="predefined-type">System</span>.out.println(v);
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content"> InfiniteRecursion address: </span><span class="delimiter">&quot;</span></span> + <span class="local-variable">this</span> + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>; <img src="./images/icons/callouts/1.png" alt="1">
    }
} <span class="comment">///:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>注意，此处 "+" 连接 <em>this</em> 会造成递归调用 <em>toString()</em> 方法</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_string_intern"><a class="anchor" href="#_string_intern"></a>99. String.intern()</h2>
<div class="sectionbody">
<div class="sidebarblock">
<div class="content">
<div class="title">intern</div>
<div class="paragraph">
<p>public   String   intern()返回字符串对象的规范化表示形式。
一个初始时为空的字符串池，它由类   String   私有地维护。</p>
</div>
<div class="paragraph">
<p>当调用   intern   方法时，如果池已经包含一个等于此   String   对象的字符串（该对象由   equals(Object)   方法确定），则返回池中的字符串。否则，将此   String   对象添加到池中，并且返回此   String   对象的引用。
它遵循对于任何两个字符串   s   和   t，当且仅当   s.equals(t)   为   true   时，s.intern()   ==   t.intern()   才为   true。
所有字面值字符串和字符串赋值常量表达式都是内部的。字符串字面值在《Java   Language   Specification》的   §3.10.5   中已定义。</p>
</div>
<div class="paragraph">
<p>返回：
一个字符串，内容与此字符串相同，但它保证来自字符串池中。</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;

<span class="comment">/**
 * String.intern()说明
 *
 * @author zxb
 * @version 1.0.0
 *          2016年06月24日 14:34
 * @since Jdk1.6
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Intern</span> {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">String</span> myName = <span class="string"><span class="delimiter">&quot;</span><span class="content">zxb</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">String</span> myNameObj = <span class="keyword">new</span> <span class="predefined-type">String</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">zxb</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">myName==myNameObj:%s</span><span class="delimiter">&quot;</span></span>, myName == myNameObj); <img src="./images/icons/callouts/1.png" alt="1">

        <span class="predefined-type">System</span>.out.println();
        <span class="predefined-type">String</span> myNameIntern = <span class="string"><span class="delimiter">&quot;</span><span class="content">zxb</span><span class="delimiter">&quot;</span></span>.intern();
        <span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">myNameIntern==myName:%s</span><span class="delimiter">&quot;</span></span>, myName == myNameIntern);<img src="./images/icons/callouts/2.png" alt="2">

        <span class="predefined-type">System</span>.out.println();
        <span class="predefined-type">String</span> myNameAppend = <span class="string"><span class="delimiter">&quot;</span><span class="content">zx</span><span class="delimiter">&quot;</span></span> + <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>;<img src="./images/icons/callouts/3.png" alt="3">
        myNameIntern = myNameAppend.intern();
        <span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">myNameAppend==myNameIntern:%s</span><span class="delimiter">&quot;</span></span>, myNameAppend == myNameIntern);

        <span class="predefined-type">System</span>.out.println();
        <span class="predefined-type">String</span> myNameAppendObj = <span class="string"><span class="delimiter">&quot;</span><span class="content">zx</span><span class="delimiter">&quot;</span></span>;
        myNameAppend = myNameAppendObj + <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>; <img src="./images/icons/callouts/4.png" alt="4">
        myNameIntern = myNameAppend.intern();
        <span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">myNameAppend==myNameIntern:%s</span><span class="delimiter">&quot;</span></span>, myNameAppend == myNameIntern);
    }
}
<span class="comment">/*
myName==myNameObj:false
myNameIntern==myName:true
myNameAppend==myNameIntern:true
myNameAppend==myNameIntern:false
*/</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>一个在常量池中，一个在堆上</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td><em>intern</em> 直接从常量池中取值了</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>此处两个字符串直接相加，并没有走StringBuilder.append()，而是直接优化为了常量值中的 "zxb"</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/4.png" alt="4"></td>
<td>此处走了StringBuilder.append()，在堆上创建的并返回了新对象。而其 <em>intern()</em> 则是从常量池中拿的值。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_formating_output"><a class="anchor" href="#_formating_output"></a>100. Formating output</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_formatter_class"><a class="anchor" href="#_formatter_class"></a>100.1. Formatter class</h3>
<div class="paragraph">
<p><em>System.out.format();</em> 及 <em>System.out.printf()</em> 都是通过调用 <em>Formatter</em> 的 <em>format</em> 方法完成格式化的。</p>
</div>
</div>
<div class="sect2">
<h3 id="_format_specifiers"><a class="anchor" href="#_format_specifiers"></a>100.2. Format specifiers</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>%[argument_index$][flags][width][.precision]conversion</p>
</div>
</blockquote>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">argument_index</dt>
<dd>
<p>参数下标，从1开始。此处指定要使用的替换参数</p>
</dd>
<dt class="hdlist1">flags</dt>
<dd>
<p>标记，默认格式化输出是右对齐，此处指定 <code>-</code> 则为左对齐</p>
</dd>
<dt class="hdlist1">width</dt>
<dd>
<p>指定格式化输出的字符串宽度</p>
</dd>
<dt class="hdlist1">precision</dt>
<dd>
<p>精度</p>
</dd>
<dt class="hdlist1">conversion</dt>
<dd>
<p>即下面的 <em>Formatter conversions</em></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/Receipt.java</span>
<span class="keyword">import</span> <span class="include">java.util</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Receipt</span> {
  <span class="directive">private</span> <span class="type">double</span> total = <span class="integer">0</span>;
  <span class="directive">private</span> <span class="predefined-type">Formatter</span> f = <span class="keyword">new</span> <span class="predefined-type">Formatter</span>(<span class="predefined-type">System</span>.out);
  <span class="directive">public</span> <span class="type">void</span> printTitle() {
    f.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%2$-15s %2$5s %3$10s</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Item</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Qty</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Price</span><span class="delimiter">&quot;</span></span>);
    f.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%-15s %5s %10s</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">----</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">---</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-----</span><span class="delimiter">&quot;</span></span>);
  }
  <span class="directive">public</span> <span class="type">void</span> print(<span class="predefined-type">String</span> name, <span class="type">int</span> qty, <span class="type">double</span> price) {
    f.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%-15.15s %5d %10.2f</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, name, qty, price);
    total += price;
  }
  <span class="directive">public</span> <span class="type">void</span> printTotal() {
    f.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%-15s %5s %10.2f</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Tax</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, total*<span class="float">0.06</span>);
    f.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%-15s %5s %10s</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-----</span><span class="delimiter">&quot;</span></span>);
    f.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%-15s %5s %10.2f</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Total</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>,
      total * <span class="float">1.06</span>);
  }
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    Receipt receipt = <span class="keyword">new</span> Receipt();
    receipt.printTitle();
    receipt.print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Jack's Magic Beans</span><span class="delimiter">&quot;</span></span>, <span class="integer">4</span>, <span class="float">4.25</span>);
    receipt.print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Princess Peas</span><span class="delimiter">&quot;</span></span>, <span class="integer">3</span>, <span class="float">5.1</span>);
    receipt.print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Three Bears Porridge</span><span class="delimiter">&quot;</span></span>, <span class="integer">1</span>, <span class="float">14.29</span>);
    receipt.printTotal();
  }
} <span class="comment">/* Output:
Item              Qty      Price

Jack's Magic Be     4       4.25
Princess Peas       3       5.10
Three Bears Por     1      14.29
Tax                         1.42
                           -----
Total                      25.06
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_formatter_conversions"><a class="anchor" href="#_formatter_conversions"></a>100.3. Formatter conversions</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Conversion Characters</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integral (as decimal)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode character</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">f</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Floating point (as decimal)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Floating point (in scientific notation)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integral (as hex)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash code (as hex)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Literal "%"</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_string_format"><a class="anchor" href="#_string_format"></a>100.4. String.format()</h3>
<div class="paragraph">
<p><em>String.format()</em> 接收与 <em>Formatter 的 format()</em> 相同的参数，但是返回 <em>String</em> 对象。如果只使用一次 <em>format</em> ，可以直接使用 <em>String.format()</em> 方法，否则还是建议使用 <em>Formatter</em> 来格式化。</p>
</div>
<div class="sect3">
<h4 id="_a_hex_dump_tool"><a class="anchor" href="#_a_hex_dump_tool"></a>100.4.1. A hex dump tool</h4>
<div class="paragraph">
<p>使用 <em>format</em> 作一个 <em>hex</em> 工具。当需要将 <em>byte[]</em> 转换 <em>hex</em> 输出时。</p>
</div>
<div class="listingblock">
<div class="title">Hex Tool</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//: net/mindview/util/Hex.java</span>
<span class="keyword">package</span> <span class="namespace">net.mindview.util</span>;

<span class="keyword">import</span> <span class="include">java.io.File</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Hex</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">String</span> format(<span class="type">byte</span><span class="type">[]</span> data) {
        <span class="predefined-type">StringBuilder</span> result = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        <span class="type">int</span> n = <span class="integer">0</span>;
        <span class="keyword">for</span> (<span class="type">byte</span> b : data) {
            <span class="keyword">if</span> (n % <span class="integer">16</span> == <span class="integer">0</span>)
                result.append(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%05X: </span><span class="delimiter">&quot;</span></span>, n));
            result.append(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%02X </span><span class="delimiter">&quot;</span></span>, b));
            n++;
            <span class="keyword">if</span> (n % <span class="integer">16</span> == <span class="integer">0</span>) result.append(<span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>);
        }
        result.append(<span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> result.toString();
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="keyword">if</span> (args.length == <span class="integer">0</span>)
            <span class="comment">// Test by displaying this class file:</span>
            <span class="predefined-type">System</span>.out.println(
                    format(BinaryFile.read(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hex.class</span><span class="delimiter">&quot;</span></span>)));
        <span class="keyword">else</span>
            <span class="predefined-type">System</span>.out.println(
                    format(BinaryFile.read(<span class="keyword">new</span> <span class="predefined-type">File</span>(args[<span class="integer">0</span>]))));
    }
} <span class="comment">/* Output: (Sample)
00000: CA FE BA BE 00 00 00 31 00 52 0A 00 05 00 22 07
00010: 00 23 0A 00 02 00 22 08 00 24 07 00 25 0A 00 26
00020: 00 27 0A 00 28 00 29 0A 00 02 00 2A 08 00 2B 0A
00030: 00 2C 00 2D 08 00 2E 0A 00 02 00 2F 09 00 30 00
00040: 31 08 00 32 0A 00 33 00 34 0A 00 15 00 35 0A 00
00050: 36 00 37 07 00 38 0A 00 12 00 39 0A 00 33 00 3A
...
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scanning_input"><a class="anchor" href="#_scanning_input"></a>101. Scanning Input</h2>
<div class="sectionbody">
<div class="paragraph">
<p>直到现在从一个普通文档读取内容还是相当麻烦的。</p>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/SimpleRead.java</span>

<span class="keyword">import</span> <span class="include">java.io.BufferedReader</span>;
<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.io.StringReader</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleRead</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">BufferedReader</span> input = <span class="keyword">new</span> <span class="predefined-type">BufferedReader</span>(
            <span class="keyword">new</span> <span class="predefined-type">StringReader</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Sir Robin of Camelot</span><span class="char">\n</span><span class="content">22 1.61803</span><span class="delimiter">&quot;</span></span>));

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="keyword">try</span> {
            <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">What is your name?</span><span class="delimiter">&quot;</span></span>);
            <span class="predefined-type">String</span> name = input.readLine();
            <span class="predefined-type">System</span>.out.println(name);
            <span class="predefined-type">System</span>.out.println(
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">How old are you? What is your favorite double?</span><span class="delimiter">&quot;</span></span>);
            <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">(input: &lt;age&gt; &lt;double&gt;)</span><span class="delimiter">&quot;</span></span>);
            <span class="predefined-type">String</span> numbers = input.readLine();
            <span class="predefined-type">System</span>.out.println(numbers);
            <span class="predefined-type">String</span><span class="type">[]</span> numArray = numbers.split(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
            <span class="type">int</span> age = <span class="predefined-type">Integer</span>.parseInt(numArray[<span class="integer">0</span>]);
            <span class="type">double</span> favorite = <span class="predefined-type">Double</span>.parseDouble(numArray[<span class="integer">1</span>]);
            <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hi %s.</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, name);
            <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">In 5 years you will be %d.</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>,
                    age + <span class="integer">5</span>);
            <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">My favorite double is %f.</span><span class="delimiter">&quot;</span></span>,
                    favorite / <span class="integer">2</span>);
        } <span class="keyword">catch</span> (<span class="exception">IOException</span> e) {
            <span class="predefined-type">System</span>.err.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">I/O exception</span><span class="delimiter">&quot;</span></span>);
        }
    }
} <span class="comment">/* Output:
What is your name?
Sir Robin of Camelot
How old are you? What is your favorite double?
(input: &lt;age&gt; &lt;double&gt;)
22 1.61803
Hi Sir Robin of Camelot.
In 5 years you will be 27.
My favorite double is 0.809015.
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>使用 <em>BufferedReader</em> 包装是因为这个类有 <em>readLine()</em> 方法。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>J2SE<sub>5</sub> 中 <strong>Scanner</strong> 类的出现，极大地简化了普通文本扫描读取的烦恼，它能使用正则表达式解析基本类型与 <em>String</em> 类型。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><strong>Scanner</strong> 是多线程下非安全的，需要程序员自己进行额外的同步操作。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/BetterRead.java</span>

<span class="keyword">import</span> <span class="include">java.util.Scanner</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">BetterRead</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Scanner</span> stdin = <span class="keyword">new</span> <span class="predefined-type">Scanner</span>(SimpleRead.input);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">What is your name?</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">String</span> name = stdin.nextLine();
        <span class="predefined-type">System</span>.out.println(name);
        <span class="predefined-type">System</span>.out.println(
                <span class="string"><span class="delimiter">&quot;</span><span class="content">How old are you? What is your favorite double?</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">(input: &lt;age&gt; &lt;double&gt;)</span><span class="delimiter">&quot;</span></span>);
        <span class="type">int</span> age = stdin.nextInt();
        <span class="type">double</span> favorite = stdin.nextDouble();
        <span class="predefined-type">System</span>.out.println(age);
        <span class="predefined-type">System</span>.out.println(favorite);
        <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hi %s.</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, name);
        <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">In 5 years you will be %d.</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>,
                age + <span class="integer">5</span>);
        <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">My favorite double is %f.</span><span class="delimiter">&quot;</span></span>,
                favorite / <span class="integer">2</span>);
    }
} <span class="comment">/* Output:
What is your name?
Sir Robin of Camelot
How old are you? What is your favorite double?
(input: &lt;age&gt; &lt;double&gt;)
22
1.61803
Hi Sir Robin of Camelot.
In 5 years you will be 27.
My favorite double is 0.809015.
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_scanner_delimiters"><a class="anchor" href="#_scanner_delimiters"></a>101.1. Scanner Delimiters</h3>
<div class="paragraph">
<p>默认情况下， <em>Scanner</em> 以 <em>whitespace</em> (<em>Character.isWhitespace 来判断</em>) 作为分隔符，当然你也可以使用你指定的正则来作为分隔符。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p><em>scanner.reset()</em> 方法将重置 <em>Scanner</em> 的状态为默认值，即以  <em>useDelimiter, useLocale, or useRadix</em> 等方法改变的状态。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/ScannerDelimiter.java</span>

<span class="keyword">import</span> <span class="include">java.util.Scanner</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ScannerDelimiter</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Scanner</span> scanner = <span class="keyword">new</span> <span class="predefined-type">Scanner</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">12, 42, 78, 99, 42</span><span class="delimiter">&quot;</span></span>);
        scanner.useDelimiter(<span class="string"><span class="delimiter">&quot;</span><span class="char">\\</span><span class="content">s*,</span><span class="char">\\</span><span class="content">s*</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">while</span> (scanner.hasNextInt())
            <span class="predefined-type">System</span>.out.println(scanner.nextInt());
    }
} <span class="comment">/* Output:
12
42
78
99
42
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p><em>scanner.delimiter()</em> 方法将返回当前使用的 <em>delimiter</em></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_scanning_with_regular_expressions"><a class="anchor" href="#_scanning_with_regular_expressions"></a>101.2. Scanning with regular expressions</h3>
<div class="paragraph">
<p><em>Scanner</em> 不仅可以通过 <em>next(), nextInt()</em> 等方法解析基本类型，还可以使用正则解析复杂的数据。</p>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/ThreatAnalyzer.java</span>

<span class="keyword">import</span> <span class="include">java.util.Scanner</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.MatchResult</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ThreatAnalyzer</span> {
    <span class="directive">static</span> <span class="predefined-type">String</span> threatData =
            <span class="string"><span class="delimiter">&quot;</span><span class="content">58.27.82.161@02/10/2005</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">204.45.234.40@02/11/2005</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">58.27.82.161@02/11/2005</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">58.27.82.161@02/12/2005</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">58.27.82.161@02/12/2005</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">[Next log section with different data format]</span><span class="delimiter">&quot;</span></span>;

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Scanner</span> scanner = <span class="keyword">new</span> <span class="predefined-type">Scanner</span>(threatData);
        <span class="predefined-type">String</span> pattern = <span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="char">\\</span><span class="content">d+[.]</span><span class="char">\\</span><span class="content">d+[.]</span><span class="char">\\</span><span class="content">d+[.]</span><span class="char">\\</span><span class="content">d+)@</span><span class="delimiter">&quot;</span></span> +
                <span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="char">\\</span><span class="content">d{2}/</span><span class="char">\\</span><span class="content">d{2}/</span><span class="char">\\</span><span class="content">d{4})</span><span class="delimiter">&quot;</span></span>;
        <span class="keyword">while</span> (scanner.hasNext(pattern)) {
            scanner.next(pattern);
            <span class="predefined-type">MatchResult</span> match = scanner.match();
            <span class="predefined-type">String</span> ip = match.group(<span class="integer">1</span>);
            <span class="predefined-type">String</span> date = match.group(<span class="integer">2</span>);
            <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Threat on %s from %s</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, date, ip);
        }
    }
} <span class="comment">/* Output:
Threat on 02/10/2005 from 58.27.82.161
Threat on 02/11/2005 from 204.45.234.40
Threat on 02/11/2005 from 58.27.82.161
Threat on 02/12/2005 from 58.27.82.161
Threat on 02/12/2005 from 58.27.82.161
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">示例2</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> input = <span class="string"><span class="delimiter">&quot;</span><span class="content">1 fish 2 fish red fish blue fish</span><span class="delimiter">&quot;</span></span>;
     <span class="predefined-type">Scanner</span> s = <span class="keyword">new</span> <span class="predefined-type">Scanner</span>(input);
     s.findInLine(<span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="char">\\</span><span class="content">d+) fish (</span><span class="char">\\</span><span class="content">d+) fish (</span><span class="char">\\</span><span class="content">w+) fish (</span><span class="char">\\</span><span class="content">w+)</span><span class="delimiter">&quot;</span></span>);
     <span class="predefined-type">MatchResult</span> result = s.match();
     <span class="keyword">for</span> (<span class="type">int</span> i=<span class="integer">1</span>; i&lt;=result.groupCount(); i++)
         <span class="predefined-type">System</span>.out.println(result.group(i));
     s.close();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stringtokenizer"><a class="anchor" href="#_stringtokenizer"></a>102. StringTokenizer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在 J2SE<sub>4</sub> 出来以前，只能通过 <em>StringTokenizer</em> 的 <em>tokenize</em>  方法拆分字符串。</p>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/ReplacingStringTokenizer.java</span>

<span class="keyword">import</span> <span class="include">java.util.Arrays</span>;
<span class="keyword">import</span> <span class="include">java.util.Scanner</span>;
<span class="keyword">import</span> <span class="include">java.util.StringTokenizer</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ReplacingStringTokenizer</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">String</span> input = <span class="string"><span class="delimiter">&quot;</span><span class="content">But I'm not dead yet! I feel happy!</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">StringTokenizer</span> stoke = <span class="keyword">new</span> <span class="predefined-type">StringTokenizer</span>(input);
        <span class="keyword">while</span> (stoke.hasMoreElements())
            <span class="predefined-type">System</span>.out.print(stoke.nextToken() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println();
        <span class="predefined-type">System</span>.out.println(<span class="predefined-type">Arrays</span>.toString(input.split(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>)));
        <span class="predefined-type">Scanner</span> scanner = <span class="keyword">new</span> <span class="predefined-type">Scanner</span>(input);
        <span class="keyword">while</span> (scanner.hasNext())
            <span class="predefined-type">System</span>.out.print(scanner.next() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">/* Output:
But I'm not dead yet! I feel happy!
[But, I'm, not, dead, yet!, I, feel, happy!]
But I'm not dead yet! I feel happy!
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>事实证明，现在已经没有必要使用 <em>StringTokenizer</em> 了，现有的 <em>Scanner</em> 等更加强大。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="_regularexpression" class="sect0"><a class="anchor" href="#_regularexpression"></a>RegularExpression</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>正则表达式</p>
</div>
<div class="paragraph">
<p>一个正则表达式，通常即一个 <em>String</em> ，必须先编译为 <em>java.util.Pattern</em> 的一个实例。 <em>Pattern</em> 实例可以用来创建 <em>Matcher</em> 对象， <em>Matcher</em> 对象可以用来匹配字符串，匹配到的信息等全部保存在该对象中。</p>
</div>
<div class="listingblock">
<div class="title">示例1</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Pattern</span> p = <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">a*b</span><span class="delimiter">&quot;</span></span>);
<span class="predefined-type">Matcher</span> m = p.matcher(<span class="string"><span class="delimiter">&quot;</span><span class="content">aaaaab</span><span class="delimiter">&quot;</span></span>);
<span class="type">boolean</span> b = m.matches();</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">示例2</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">boolean</span> b = <span class="predefined-type">Pattern</span>.matches(<span class="string"><span class="delimiter">&quot;</span><span class="content">a*b</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">aaaaab</span><span class="delimiter">&quot;</span></span>); <img src="./images/icons/callouts/1.png" alt="1"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>这是示例1的简写形式，只有当正则表达式不需要复用时使用，因为它每次都要重新创建 <em>Pattern</em> 实例。</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p><strong>Pattern</strong> 类是不可变的，并且是多线程下安全的。</p>
</div>
<div class="paragraph">
<p><strong>Matcher</strong> 是多线程下非安全的。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_基本使用"><a class="anchor" href="#_基本使用"></a>103. 基本使用</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_string_matches"><a class="anchor" href="#_string_matches"></a>103.1. String.Matches</h3>
<div class="listingblock">
<div class="title">String.matches</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/IntegerMatch.java</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">IntegerMatch</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">-1234</span><span class="delimiter">&quot;</span></span>.matches(<span class="string"><span class="delimiter">&quot;</span><span class="content">-?</span><span class="char">\\</span><span class="content">d+</span><span class="delimiter">&quot;</span></span>)); <img src="./images/icons/callouts/1.png" alt="1">
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">5678</span><span class="delimiter">&quot;</span></span>.matches(<span class="string"><span class="delimiter">&quot;</span><span class="content">-?</span><span class="char">\\</span><span class="content">d+</span><span class="delimiter">&quot;</span></span>));
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">+911</span><span class="delimiter">&quot;</span></span>.matches(<span class="string"><span class="delimiter">&quot;</span><span class="content">-?</span><span class="char">\\</span><span class="content">d+</span><span class="delimiter">&quot;</span></span>));
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">+911</span><span class="delimiter">&quot;</span></span>.matches(<span class="string"><span class="delimiter">&quot;</span><span class="content">(-|</span><span class="char">\\</span><span class="content">+)?</span><span class="char">\\</span><span class="content">d+</span><span class="delimiter">&quot;</span></span>));
    }
} <span class="comment">/* Output:
true
true
false
true
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td><em>String.matches()</em> 实际是调用的 <em>Pattern.matches()</em> 方法</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_string_split"><a class="anchor" href="#_string_split"></a>103.2. String.split</h3>
<div class="paragraph">
<p><em>String</em> 的 <em>split</em> 方法中参数实际上即是正则，也就是说其拆分符为正则。</p>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/Splitting.java</span>

<span class="keyword">import</span> <span class="include">java.util.Arrays</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Splitting</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">String</span> knights =
            <span class="string"><span class="delimiter">&quot;</span><span class="content">Then, when you have found the shrubbery, you must </span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">cut down the mightiest tree in the forest... </span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">with... a herring!</span><span class="delimiter">&quot;</span></span>;

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> split(<span class="predefined-type">String</span> regex) {
        <span class="predefined-type">System</span>.out.println(
                <span class="predefined-type">Arrays</span>.toString(knights.split(regex)));
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        split(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>); <span class="comment">// Doesn't have to contain regex chars</span>
        split(<span class="string"><span class="delimiter">&quot;</span><span class="char">\\</span><span class="content">W+</span><span class="delimiter">&quot;</span></span>); <span class="comment">// Non-word characters</span>
        split(<span class="string"><span class="delimiter">&quot;</span><span class="content">n</span><span class="char">\\</span><span class="content">W+</span><span class="delimiter">&quot;</span></span>); <span class="comment">// 'n' followed by non-word characters</span>
    }
} <span class="comment">/* Output:
[Then,, when, you, have, found, the, shrubbery,, you, must, cut, down, the, mightiest, tree, in, the, forest..., with..., a, herring!]
[Then, when, you, have, found, the, shrubbery, you, must, cut, down, the, mightiest, tree, in, the, forest, with, a, herring]
[The, whe, you have found the shrubbery, you must cut dow, the mightiest tree i, the forest... with... a herring!]
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_正则规则"><a class="anchor" href="#_正则规则"></a>104. 正则规则</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/pattern_1.png" alt="pattern 1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pattern_2.png" alt="pattern 2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pattern_3.png" alt="pattern 3">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pattern_4.png" alt="pattern 4">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pattern_5.png" alt="pattern 5">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_转义符"><a class="anchor" href="#_转义符"></a>105. 转义符</h2>
<div class="sectionbody">
<div class="paragraph">
<p>转义符 <strong>\</strong> 用来将特殊字符转义，但是在 <em>java</em> 中 <strong>\</strong> 本身也是特殊字符，所以需要继续对 <strong>\</strong> 进行转义。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. 示例</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">转义</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java中转义</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\\</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\\\</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">{</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\{</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\\{</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(hello)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(hello\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\\(hello\\)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_字符类"><a class="anchor" href="#_字符类"></a>106. 字符类</h2>
<div class="sectionbody">
<div class="paragraph">
<p>当正则的字符区间之间通过 <em>&amp;&amp;</em> 等进行关联时，就需要考虑各字符类之间的优先级了。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. 优先级</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">优先级别序号</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">名称</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符转义</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分组</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符区间</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a-z</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符区间并集</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[a-e][i-u]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符区间交集</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[a-z&amp;&amp;[aeiou]]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_行终止符"><a class="anchor" href="#_行终止符"></a>107. 行终止符</h2>
<div class="sectionbody">
<div class="paragraph">
<p>行终止符一般为1-2个字符，用于标记一行的结束。以下字符被定义为行终止符。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">说明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">换行符</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\r\n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">回车换行符</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\r</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">标准回车符</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\u0085</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">下一行</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\u2028</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">行分隔符</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\u2029</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">段落分隔符</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>如果 <em>Uninx Lines</em> 模式启用的话，则只有 \n 是支持的。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>正则中 <strong>.</strong> 默认是匹配所有字符，除了行终止符。 如果 <em>DOTALL</em> 标记启用的话，那么 <strong>.</strong> 也会匹配行终止符。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>默认情况下， <strong>^</strong> 与 <strong>$</strong> 在正则中只会匹配一行的开头和结尾，不会匹配到行终止符。如果 <em>MULTLINE</em> 模式启用后，那么 <strong>^</strong> 与 <strong>$</strong> 会匹配到行终止符，即匹配输入字符串的开头与结尾（哪怕输入字符串是多行的）。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_分组与捕捉"><a class="anchor" href="#_分组与捕捉"></a>108. 分组与捕捉</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_分组序号"><a class="anchor" href="#_分组序号"></a>108.1. 分组序号</h3>
<div class="paragraph">
<p>分组序号根据分组的括号从左到右数的，如下所示。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. 正则A)(B&#169;</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">序号</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分组</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A)(B&#169;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(A)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(B&#169;)</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>分组序号中 <em>0</em> 总是表示该正则表达式。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>这里保存分组序号是因为表达式中可能会用到，或者通过 <em>back reference</em> 引用到。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_分组名称"><a class="anchor" href="#_分组名称"></a>108.2. 分组名称</h3>
<div class="paragraph">
<p>一个分组也可以使用一个 <em>name</em> 来标记。取名的规范如下：</p>
</div>
<div class="olist arabic">
<div class="title">分组名称命名规范</div>
<ol class="arabic">
<li>
<p>必须以字母开头</p>
</li>
<li>
<p>大小写字母均可以</p>
</li>
<li>
<p>数字0-9也可以</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p>以 <em>name</em> 标记分组后，其序号依然是有效的。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>(?&lt;name&gt;X) 即可指定分组名称</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution">
</td>
<td class="content">
<div class="paragraph">
<p><em>non-capturing</em> 将取消分组命名， <strong>同时会取消其分组序号</strong> 。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/non-capturing.png" alt="non capturing">
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_回溯引用"><a class="anchor" href="#_回溯引用"></a>109. 回溯引用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>back reference(回溯引用)指在正则表达式中，后面的引用前面的分组。
引用方式有如下两种</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/back-reference.png" alt="back reference">
</div>
<div class="title">Figure 5. 语法</div>
</div>
<div class="listingblock">
<div class="title">示例-匹配h1-h6标签</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;body&gt;</span>

    <span class="tag">&lt;h1&gt;</span>Welcome to my page<span class="tag">&lt;/H1&gt;</span> Content is divided into twosections:
    <span class="tag">&lt;br&gt;</span>

    <span class="tag">&lt;h2&gt;</span>Introduction<span class="tag">&lt;/h2&gt;</span> Information about me.

    <span class="tag">&lt;H2&gt;</span>Hobby<span class="tag">&lt;/H2&gt;</span> Information about my hobby.

    <span class="tag">&lt;h2&gt;</span>This is invalid HTML<span class="tag">&lt;/h3&gt;</span>
<span class="tag">&lt;/body&gt;</span></code></pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>匹配正则为：<code>&lt;([hH][1-6])&gt;.*?&lt;\/\1&gt;</code></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>上述正则中，后面的 <code>\1</code> 就是引用前面的分组内容([hH][1-6])。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/back-reference-count.png" alt="back reference count">
</div>
<div class="title">Figure 6. 最终效果</div>
</div>
<div class="sect2">
<h3 id="_使用示例"><a class="anchor" href="#_使用示例"></a>109.1. 使用示例</h3>
<div class="imageblock">
<div class="content">
<img src="images/back-reference-case.png" alt="back reference case">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_零宽断言_预搜索_预匹配"><a class="anchor" href="#_零宽断言_预搜索_预匹配"></a>110. 零宽断言（预搜索、预匹配）</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/look-syntax.png" alt="look syntax">
</div>
<div class="title">Figure 7. 语法</div>
</div>
<div class="sect2">
<h3 id="_使用示例_2"><a class="anchor" href="#_使用示例_2"></a>110.1. 使用示例</h3>
<div class="imageblock">
<div class="content">
<img src="images/look.png" alt="look">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_量词"><a class="anchor" href="#_量词"></a>111. 量词</h2>
<div class="sectionbody">
<div class="paragraph">
<p>量词分为贪婪、勉强、占有模式</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/greedy.png" alt="greedy">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">贪婪模式</dt>
<dd>
<p>贪婪模式下正则表达式会 <strong>尽可能长</strong> 地去匹配符合规则的字符串，且会 <strong>回溯</strong></p>
</dd>
<dt class="hdlist1">勉强模式</dt>
<dd>
<p>勉强模式下正则表达式会 <strong>尽可能短</strong> 地去匹配符合规则的字符串。</p>
</dd>
<dt class="hdlist1">占有模式</dt>
<dd>
<p>同贪婪模式一样匹配最长， <strong>尽可能长</strong> 地去匹配字符串，一旦匹配不成功就立即结束，且 <strong>不会回溯</strong> 。</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;

<span class="keyword">import</span> <span class="include">java.util.regex.Matcher</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="comment">/**
 * @author zxb
 * @version 1.0.0
 *          2016年07月01日 16:55
 * @since Jdk1.6
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Greedy</span> {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">String</span> str = <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;ol&gt;&lt;li&gt;张雄彪&lt;/li&gt;&lt;br/&gt;&lt;li&gt;你好哇嘿&lt;/li&gt;&lt;/ol&gt;</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">String</span> greedyPattern = <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;li&gt;.*&lt;/li&gt;</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">String</span> reluctantPattern = <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;li&gt;.*?&lt;/li&gt;</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">String</span> possessivePattern = <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;li&gt;.*+&lt;/li&gt;</span><span class="delimiter">&quot;</span></span>;

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">贪婪模式===</span><span class="delimiter">&quot;</span></span>);
        print(str, greedyPattern);
        <span class="predefined-type">System</span>.out.println();

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">勉强模式===</span><span class="delimiter">&quot;</span></span>);
        print(str, reluctantPattern);
        <span class="predefined-type">System</span>.out.println();

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">占有模式===</span><span class="delimiter">&quot;</span></span>);
        print(str, possessivePattern);
    }

    <span class="directive">private</span> <span class="directive">static</span> <span class="type">void</span> print(<span class="predefined-type">String</span> str, <span class="predefined-type">String</span> patternStr) {
        <span class="predefined-type">Pattern</span> pattern = <span class="predefined-type">Pattern</span>.compile(patternStr);
        <span class="predefined-type">Matcher</span> matcher = pattern.matcher(str);
        <span class="keyword">while</span> (matcher.find()) {
            <span class="predefined-type">System</span>.out.println(matcher.group() + <span class="string"><span class="delimiter">&quot;</span><span class="content">,start:</span><span class="delimiter">&quot;</span></span> + matcher.start() + <span class="string"><span class="delimiter">&quot;</span><span class="content">,end:</span><span class="delimiter">&quot;</span></span> + matcher.end());
        }
    }
}
<span class="comment">/*
贪婪模式===
&lt;li&gt;张雄彪&lt;/li&gt;&lt;br/&gt;&lt;li&gt;你好哇嘿&lt;/li&gt;,start:4,end:34

勉强模式===
&lt;li&gt;张雄彪&lt;/li&gt;,start:4,end:16
&lt;li&gt;你好哇嘿&lt;/li&gt;,start:21,end:34

占有模式===

 */</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_使用示例_3"><a class="anchor" href="#_使用示例_3"></a>111.1. 使用示例</h3>
<div class="imageblock">
<div class="content">
<img src="images/quantifiers.png" alt="quantifiers">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_行终止符_2"><a class="anchor" href="#_行终止符_2"></a>112. 行终止符</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/line-terminal-syntax.png" alt="line terminal syntax">
</div>
<div class="title">Figure 8. 语法</div>
</div>
<div class="sect2">
<h3 id="_使用示例_4"><a class="anchor" href="#_使用示例_4"></a>112.1. 使用示例</h3>
<div class="sect3">
<h4 id="__b"><a class="anchor" href="#__b"></a>112.1.1. \b</h4>
<div class="imageblock">
<div class="content">
<img src="images/word.png" alt="word">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_其它终止符"><a class="anchor" href="#_其它终止符"></a>112.1.2. 其它终止符</h4>
<div class="imageblock">
<div class="content">
<img src="images/line-terminal.png" alt="line terminal">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_逻辑操作符"><a class="anchor" href="#_逻辑操作符"></a>113. 逻辑操作符</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/logic-operator.png" alt="logic operator">
</div>
<div class="title">Figure 9. 语法</div>
</div>
<div class="sect2">
<h3 id="_使用示例_5"><a class="anchor" href="#_使用示例_5"></a>113.1. 使用示例</h3>
<div class="imageblock">
<div class="content">
<img src="images/or.png" alt="or">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_charsequence"><a class="anchor" href="#_charsequence"></a>114. CharSequence</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title"><em>CharSequence</em> 接口</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">interface</span> <span class="class">CharSequence</span> {
  charAt(<span class="type">int</span> i);
  length();
  subSequence(<span class="type">int</span> start,| <span class="type">int</span> end);
  toString();
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/diagram.png" alt="diagram">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note">
</td>
<td class="content">
<div class="paragraph">
<p>大多数正则表达式的方法采用 <em>CharSequence</em> 作为方法参数</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pattern_and_matcher"><a class="anchor" href="#_pattern_and_matcher"></a>115. Pattern and Matcher</h2>
<div class="sectionbody">
<div class="paragraph">
<p>通常情况下，你一般会创建出正则表达式的 <em>Pattern</em> 对象，而非使用 <em>String</em> 的正则匹配方法。因为通过 <em>Pattern</em> 能复用正则对象。</p>
</div>
<div class="paragraph">
<p><em>Pattern.compile(String pattern)</em> 将返回一个 <em>Pattern</em> 对象。</p>
</div>
<div class="paragraph">
<p><em>Pattern</em> 对象的 <em>matcher(String input)</em> 将返回一个 <em>Matcher</em> 对象。</p>
</div>
<hr>
<div class="dlist">
<div class="title"><strong>Matcher</strong> 对象通常有以下3种匹配方式</div>
<dl>
<dt class="hdlist1"><em>boolean matches()</em></dt>
<dd>
<p>将尝试将整个输入内容与正则 <em>pattern</em> 进行匹配。当前仅当整个输入被 <em>pattern</em> 匹配到时才为 <em>true</em> 。</p>
</dd>
<dt class="hdlist1"><em>boolean lookingAt()</em></dt>
<dd>
<p>将尝试用正则 <em>pattern</em> 去匹配输入的开头，如果匹配到了就返回 <em>true</em></p>
</dd>
<dt class="hdlist1"><em>boolean find()</em></dt>
<dd>
<p>将遍历扫描输入，用正则尝试匹配输入的每一个子序列。</p>
<div class="listingblock">
<div class="content">
<pre>  尝试查找与该模式匹配的输入序列的下一个子序列。

  此方法从匹配器区域的开头开始，如果该方法的前一次调用成功了并且从那时开始匹配器没有被重置，则从以前匹配操作没有匹配的第一个字符开始。

  如果匹配成功，则可以通过 start、end 和 group 方法获取更多信息。

  返回：

  当且仅当输入序列的子序列匹配此匹配器的模式时才返回 true。</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_matches_与_lookingat"><a class="anchor" href="#_matches_与_lookingat"></a>115.1. Matches() 与 LookingAt()</h3>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;

<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="comment">/**
 * @author zxb
 * @version 1.0.0
 *          2016年07月01日 23:21
 * @since Jdk1.6
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MatchesAndLookingAt</span> {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">String</span> input = <span class="string"><span class="delimiter">&quot;</span><span class="content">This is my first Car</span><span class="delimiter">&quot;</span></span>;

        <span class="predefined-type">String</span> pattern = <span class="string"><span class="delimiter">&quot;</span><span class="content">This</span><span class="char">\\</span><span class="content">s+</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">matches:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Pattern</span>.compile(pattern).matcher(input).matches()); <span class="comment">// 无法完整匹配到整个字符串，false</span>
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">lookingAt:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Pattern</span>.compile(pattern).matcher(input).lookingAt());<span class="comment">// 已经匹配到字符串开头，true</span>

        <span class="predefined-type">System</span>.out.println();

        pattern = <span class="string"><span class="delimiter">&quot;</span><span class="content">This[</span><span class="char">\\</span><span class="content">s</span><span class="char">\\</span><span class="content">S]+</span><span class="delimiter">&quot;</span></span>;
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">matches:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Pattern</span>.compile(pattern).matcher(input).matches());<span class="comment">//可匹配到整个字符串，true</span>
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">lookingAt:</span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">Pattern</span>.compile(pattern).matcher(input).lookingAt());<span class="comment">//已经匹配到字符串开头，true</span>
    }
}
<span class="comment">/*
Output:
matches:false
lookingAt:true

matches:true
lookingAt:true
 */</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>matches()需要完整匹配整个字符串，才为 <em>true</em></p>
</li>
<li>
<p>lookingAt()只需要匹配字符串开头，就为 <em>true</em></p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_find"><a class="anchor" href="#_find"></a>115.2. find()</h3>
<div class="paragraph">
<p>用正则尝试匹配输入的每一个子序列</p>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/Finding.java</span>

<span class="keyword">import</span> <span class="include">java.util.regex.Matcher</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.util.regex.Pattern.compile</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print.print</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print.printnb</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Finding</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Matcher</span> m = compile(<span class="string"><span class="delimiter">&quot;</span><span class="char">\\</span><span class="content">w+</span><span class="delimiter">&quot;</span></span>)
                .matcher(<span class="string"><span class="delimiter">&quot;</span><span class="content">Evening is full of the linnet's wings</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">while</span> (m.find()) {
            printnb(m.group() + <span class="string"><span class="delimiter">&quot;</span><span class="content">,start:</span><span class="delimiter">&quot;</span></span> + m.start() + <span class="string"><span class="delimiter">&quot;</span><span class="content">,end:</span><span class="delimiter">&quot;</span></span> + m.end() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
            <span class="predefined-type">System</span>.out.println();
        }
        print();
        <span class="type">int</span> i = <span class="integer">0</span>;
        <span class="keyword">while</span> (m.find(i)) { <img src="./images/icons/callouts/1.png" alt="1">
            printnb(m.group() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
            i++;
        }

        <span class="predefined-type">System</span>.out.println();
        m = <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">(a(b)?)+</span><span class="delimiter">&quot;</span></span>).matcher(<span class="string"><span class="delimiter">&quot;</span><span class="content">ababc</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">while</span> (m.find()) {
            printnb(m.group() + <span class="string"><span class="delimiter">&quot;</span><span class="content">,start:</span><span class="delimiter">&quot;</span></span> + m.start() + <span class="string"><span class="delimiter">&quot;</span><span class="content">,end:</span><span class="delimiter">&quot;</span></span> + m.end());
            <span class="predefined-type">System</span>.out.println();
            <span class="predefined-type">System</span>.out.println(m.group(<span class="integer">1</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">,start:</span><span class="delimiter">&quot;</span></span> + m.start(<span class="integer">1</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">,end:</span><span class="delimiter">&quot;</span></span> + m.end(<span class="integer">1</span>));  <img src="./images/icons/callouts/2.png" alt="2">
            <span class="predefined-type">System</span>.out.println(m.group(<span class="integer">2</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">,start:</span><span class="delimiter">&quot;</span></span> + m.start(<span class="integer">2</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">,end:</span><span class="delimiter">&quot;</span></span> + m.end(<span class="integer">2</span>));
        }
    }
} <span class="comment">/* Output:
Evening,start:0,end:7
is,start:8,end:10
full,start:11,end:15
of,start:16,end:18
the,start:19,end:22
linnet,start:23,end:29
s,start:30,end:31
wings,start:32,end:37

Evening vening ening ning ing ng g is is s full full ull ll l of of f the the he e linnet linnet innet nnet net et t s s wings wings ings ngs gs s
abab,start:0,end:4
ab,start:2,end:4  <img src="./images/icons/callouts/3.png" alt="3">
b,start:3,end:4
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>重置 <em>Matcher</em> ，然后从输入内容的指定位置 <em>i</em> 处开始匹配。</td>
</tr>
<tr>
<td><img src="./images/icons/callouts/2.png" alt="2"></td>
<td><em>group(int x)</em> 中取的总是最近一次匹配中的 <em>match</em></td>
</tr>
<tr>
<td><img src="./images/icons/callouts/3.png" alt="3"></td>
<td>注意，此处 <em>group(1)</em> 拿的位置</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>分组() 捕获的内容(保存的子序列) 总是该 <em>group</em> <strong>最近一次匹配到的内容</strong> 。</p>
</li>
<li>
<p>如果分组() 因为有量词再次进行匹配时，其前一次匹配保存的子序列内容将会被放弃。</p>
</li>
<li>
<p>如果再次匹配失败的话，那么前一次匹配的内容（子序列）还会继续保存。</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_groups"><a class="anchor" href="#_groups"></a>115.3. Groups</h3>
<div class="paragraph">
<p><em>Groups</em> 就是用 () 包括的正则表达式，而且 <em>group</em> 可以通过它的编号进行回溯引用。</p>
</div>
<div class="paragraph">
<p><em>Group 0</em> 对应的就是整个表达式匹配到的内容， <em>Group 1</em> 就是第一组 () ，依此类推。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>A(B(C))D</pre>
</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
group 0 
</td>
<td class="hdlist2">
<p>ABCD</p>
</td>
</tr>
<tr>
<td class="hdlist1">
group 1 
</td>
<td class="hdlist2">
<p>BC</p>
</td>
</tr>
<tr>
<td class="hdlist1">
group 2 
</td>
<td class="hdlist2">
<p>C</p>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">方法列表</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">int</span> groupCount()</code></pre>
</div>
</div>
<div class="paragraph">
<p>返回 <em>match</em> 到的 <em>group</em> 数量， <em>group 0</em> 不算在此列。</p>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">pubic <span class="predefined-type">String</span> group()</code></pre>
</div>
</div>
<div class="paragraph">
<p>返回上一匹配操作（如 find()） 匹配到的内容</p>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">String</span> group(<span class="type">int</span> i)</code></pre>
</div>
</div>
<div class="paragraph">
<p>返回上一匹配操作中指定的序号的 <em>group</em> 内容。如果匹配到了，但是指定的序列号不对，将抛出 <em>IndexOutOfBoundsException</em></p>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">int</span> start(<span class="type">int</span> group)</code></pre>
</div>
</div>
<div class="paragraph">
<p>返回上一匹配操作中的指定序号的 <em>group</em> 在输入内容中匹配到的子序列的开始位置</p>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">int</span> end(<span class="type">int</span> group)</code></pre>
</div>
</div>
<div class="paragraph">
<p>返回上一匹配操作中的指定序号的 <em>group</em> 在输入内容中匹配到的子序列的结束位置</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/Groups.java</span>

<span class="keyword">import</span> <span class="include">java.util.regex.Matcher</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print.print</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print.printnb</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Groups</span> {
    <span class="directive">static</span> <span class="directive">public</span> <span class="directive">final</span> <span class="predefined-type">String</span> POEM =
            <span class="string"><span class="delimiter">&quot;</span><span class="content">Twas brillig, and the slithy toves</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">Did gyre and gimble in the wabe.</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">All mimsy were the borogoves,</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">And the mome raths outgrabe.</span><span class="char">\n</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">Beware the Jabberwock, my son,</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">The jaws that bite, the claws that catch.</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">Beware the Jubjub bird, and shun</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">The frumious Bandersnatch.</span><span class="delimiter">&quot;</span></span>;

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Matcher</span> m =
                <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">(?m)(</span><span class="char">\\</span><span class="content">S+)</span><span class="char">\\</span><span class="content">s+((</span><span class="char">\\</span><span class="content">S+)</span><span class="char">\\</span><span class="content">s+(</span><span class="char">\\</span><span class="content">S+))$</span><span class="delimiter">&quot;</span></span>)
                        .matcher(POEM);  <img src="./images/icons/callouts/1.png" alt="1">
        <span class="keyword">while</span> (m.find()) {
            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="integer">0</span>; j &lt;= m.groupCount(); j++)
                printnb(<span class="string"><span class="delimiter">&quot;</span><span class="content">[</span><span class="delimiter">&quot;</span></span> + m.group(j) + <span class="string"><span class="delimiter">&quot;</span><span class="content">]</span><span class="delimiter">&quot;</span></span>);
            print();
        }
    }
} <span class="comment">/* Output:
[the slithy toves][the][slithy toves][slithy][toves]
[in the wabe.][in][the wabe.][the][wabe.]
[were the borogoves,][were][the borogoves,][the][borogoves,]
[mome raths outgrabe.][mome][raths outgrabe.][raths][outgrabe.]
[Jabberwock, my son,][Jabberwock,][my son,][my][son,]
[claws that catch.][claws][that catch.][that][catch.]
[bird, and shun][bird,][and shun][and][shun]
[The frumious Bandersnatch.][The][frumious Bandersnatch.][frumious][Bandersnatch.]
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>(?m) 表示多行匹配</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_start_end"><a class="anchor" href="#_start_end"></a>115.4. start() , end()</h3>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/StartEnd.java</span>

<span class="keyword">import</span> <span class="include">java.util.regex.Matcher</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print.print</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">StartEnd</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">String</span> input =
            <span class="string"><span class="delimiter">&quot;</span><span class="content">As long as there is injustice, whenever a</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">Targathian baby cries out, wherever a distress</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">signal sounds among the stars ... We'll be there.</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">This fine ship, and this fine crew ...</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">Never give up! Never surrender!</span><span class="delimiter">&quot;</span></span>;

    <span class="directive">static</span> <span class="type">void</span> examine(<span class="predefined-type">String</span> s, <span class="predefined-type">String</span> regex) {
        Display d = <span class="keyword">new</span> Display(regex);
        <span class="predefined-type">Pattern</span> p = <span class="predefined-type">Pattern</span>.compile(regex);
        <span class="predefined-type">Matcher</span> m = p.matcher(s);
        <span class="keyword">while</span> (m.find())
            d.display(<span class="string"><span class="delimiter">&quot;</span><span class="content">find() '</span><span class="delimiter">&quot;</span></span> + m.group() +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">' start = </span><span class="delimiter">&quot;</span></span> + m.start() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> end = </span><span class="delimiter">&quot;</span></span> + m.end());
        <span class="keyword">if</span> (m.lookingAt()) <span class="comment">// No reset() necessary</span>
            d.display(<span class="string"><span class="delimiter">&quot;</span><span class="content">lookingAt() start = </span><span class="delimiter">&quot;</span></span>
                    + m.start() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> end = </span><span class="delimiter">&quot;</span></span> + m.end());
        <span class="keyword">if</span> (m.matches()) <span class="comment">// No reset() necessary</span>
            d.display(<span class="string"><span class="delimiter">&quot;</span><span class="content">matches() start = </span><span class="delimiter">&quot;</span></span>
                    + m.start() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> end = </span><span class="delimiter">&quot;</span></span> + m.end());
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="keyword">for</span> (<span class="predefined-type">String</span> in : input.split(<span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>)) {
            print(<span class="string"><span class="delimiter">&quot;</span><span class="content">input : </span><span class="delimiter">&quot;</span></span> + in);
            <span class="keyword">for</span> (<span class="predefined-type">String</span> regex : <span class="keyword">new</span> <span class="predefined-type">String</span><span class="type">[]</span>{<span class="string"><span class="delimiter">&quot;</span><span class="char">\\</span><span class="content">w*ere</span><span class="char">\\</span><span class="content">w*</span><span class="delimiter">&quot;</span></span>,
                    <span class="string"><span class="delimiter">&quot;</span><span class="char">\\</span><span class="content">w*ever</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">T</span><span class="char">\\</span><span class="content">w+</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Never.*?!</span><span class="delimiter">&quot;</span></span>})
                examine(in, regex);
        }
    }

    <span class="directive">private</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Display</span> {
        <span class="directive">private</span> <span class="type">boolean</span> regexPrinted = <span class="predefined-constant">false</span>;
        <span class="directive">private</span> <span class="predefined-type">String</span> regex;

        Display(<span class="predefined-type">String</span> regex) {
            <span class="local-variable">this</span>.regex = regex;
        }

        <span class="type">void</span> display(<span class="predefined-type">String</span> message) {
            <span class="keyword">if</span> (!regexPrinted) {
                print(regex);
                regexPrinted = <span class="predefined-constant">true</span>;
            }
            print(message);
        }
    }
} <span class="comment">/* Output:
input : As long as there is injustice, whenever a
\w*ere\w*
find() 'there' start = 11 end = 16
\w*ever
find() 'whenever' start = 31 end = 39
input : Targathian baby cries out, wherever a distress
\w*ere\w*
find() 'wherever' start = 27 end = 35
\w*ever
find() 'wherever' start = 27 end = 35
T\w+
find() 'Targathian' start = 0 end = 10
lookingAt() start = 0 end = 10
input : signal sounds among the stars ... We'll be there.
\w*ere\w*
find() 'there' start = 43 end = 48
input : This fine ship, and this fine crew ...
T\w+
find() 'This' start = 0 end = 4
lookingAt() start = 0 end = 4
input : Never give up! Never surrender!
\w*ever
find() 'Never' start = 0 end = 5
find() 'Never' start = 15 end = 20
lookingAt() start = 0 end = 5
Never.*?!
find() 'Never give up!' start = 0 end = 14
find() 'Never surrender!' start = 15 end = 31
lookingAt() start = 0 end = 14
matches() start = 0 end = 31
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_match_flags"><a class="anchor" href="#_match_flags"></a>116. match flags</h2>
<div class="sectionbody">
<div class="paragraph">
<p>匹配的标记，模式。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/flags.png" alt="flags">
</div>
</div>
<hr>
<div class="paragraph">
<p>目前有如下2种写法：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/matchflags.png" alt="matchflags">
</div>
<div class="title">Figure 10. 写法一</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/matchflags2.png" alt="matchflags2">
</div>
<div class="title">Figure 11. 写法二</div>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/ReFlags.java</span>

<span class="keyword">import</span> <span class="include">java.util.regex.Matcher</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ReFlags</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">Pattern</span> p = <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">^java</span><span class="delimiter">&quot;</span></span>,
                <span class="predefined-type">Pattern</span>.CASE_INSENSITIVE | <span class="predefined-type">Pattern</span>.MULTILINE); <img src="./images/icons/callouts/1.png" alt="1">
        <span class="predefined-type">Matcher</span> m = p.matcher(
                <span class="string"><span class="delimiter">&quot;</span><span class="content">java has regex</span><span class="char">\n</span><span class="content">Java has regex</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">JAVA has pretty good regular expressions</span><span class="char">\n</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Regular expressions are in Java</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">while</span> (m.find())
            <span class="predefined-type">System</span>.out.println(m.group());
    }
} <span class="comment">/* Output:
java
Java
JAVA
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td>指定了多行及忽略大小写匹配</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p><em>group()</em> 默认只输出 <em>find()</em> 匹配到的内容</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_split"><a class="anchor" href="#_split"></a>117. Split()</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>split()</em> 将输入内容按照指定的正则表达式拆分为字符串数组。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> <span class="type">[]</span> split(<span class="predefined-type">CharSequence</span> input)
<span class="predefined-type">String</span> <span class="type">[]</span> split(<span class="predefined-type">CharSequence</span> input, <span class="type">int</span> limit) <img src="./images/icons/callouts/1.png" alt="1"></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><img src="./images/icons/callouts/1.png" alt="1"></td>
<td><em>limit</em> 限制了拆分出来的份数</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/SplitDemo.java</span>

<span class="keyword">import</span> <span class="include">java.util.Arrays</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print.print</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">SplitDemo</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        <span class="predefined-type">String</span> input =
                <span class="string"><span class="delimiter">&quot;</span><span class="content">This!!unusual use!!of exclamation!!points</span><span class="delimiter">&quot;</span></span>;
        print(<span class="predefined-type">Arrays</span>.toString(
                <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">!!</span><span class="delimiter">&quot;</span></span>).split(input)));
        <span class="comment">// Only do the first three:</span>
        print(<span class="predefined-type">Arrays</span>.toString(
                <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">!!</span><span class="delimiter">&quot;</span></span>).split(input, <span class="integer">3</span>)));
    }
} <span class="comment">/* Output:
[This, unusual use, of exclamation, points]
[This, unusual use, of exclamation!!points]
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_replace"><a class="anchor" href="#_replace"></a>118. Replace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>字符串正则替换</p>
</div>
<div class="listingblock">
<div class="title">追加替换内容</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">Matcher</span> appendReplacement(<span class="predefined-type">StringBuffer</span> sb, <span class="predefined-type">String</span> replacement)</code></pre>
</div>
</div>
<div class="olist arabic">
<div class="title">这个方法执行以下三个步骤：</div>
<ol class="arabic">
<li>
<p>读取输入内容，将从前一次 <em>append</em> 的位置开始，到上一匹配的开始位置（start()-1）处的内容追加至 <em>StringBuffer</em></p>
</li>
<li>
<p>追加替换的内容至 <em>StringBuffer</em></p>
</li>
<li>
<p>设置 <em>append</em> 位置为上一匹配的 <em>end()</em> 位置</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendReplacement.jpg" alt="appendReplacement">
</div>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/TheReplacements.java</span>

<span class="keyword">import</span> <span class="include">net.mindview.util.TextFile</span>;

<span class="keyword">import</span> <span class="include">java.util.regex.Matcher</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">net.mindview.util.Print.print</span>;

<span class="comment">/*! Here's a block of text to use as input to
    the regular expression matcher. Note that we'll
    first extract the block of text by looking for
    the special delimiters, then process the
    extracted block. !*/</span>

<span class="directive">public</span> <span class="type">class</span> <span class="class">TheReplacements</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">String</span> s = TextFile.read(<span class="string"><span class="delimiter">&quot;</span><span class="content">TheReplacements.java</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">// Match the specially commented block of text above:</span>
        <span class="predefined-type">Matcher</span> mInput =
                <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="char">\\</span><span class="content">*!(.*)!</span><span class="char">\\</span><span class="content">*/</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">Pattern</span>.DOTALL)
                        .matcher(s);
        <span class="keyword">if</span> (mInput.find())
            s = mInput.group(<span class="integer">1</span>); <span class="comment">// Captured by parentheses</span>
        <span class="comment">// Replace two or more spaces with a single space:</span>
        s = s.replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content"> {2,}</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
        <span class="comment">// Replace one or more spaces at the beginning of each</span>
        <span class="comment">// line with no spaces. Must enable MULTILINE mode:</span>
        s = s.replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">(?m)^ +</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
        print(s);
        s = s.replaceFirst(<span class="string"><span class="delimiter">&quot;</span><span class="content">[aeiou]</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">(VOWEL1)</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">StringBuffer</span> sbuf = <span class="keyword">new</span> <span class="predefined-type">StringBuffer</span>();
        <span class="predefined-type">Pattern</span> p = <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">[aeiou]</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">Matcher</span> m = p.matcher(s);
        <span class="comment">// Process the find information as you</span>
        <span class="comment">// perform the replacements:</span>
        <span class="keyword">while</span> (m.find())
            m.appendReplacement(sbuf, m.group().toUpperCase());
        <span class="comment">// Put in the remainder of the text:</span>
        m.appendTail(sbuf);
        print(sbuf);
    }
} <span class="comment">/* Output:
Here's a block of text to use as input to
the regular expression matcher. Note that we'll
first extract the block of text by looking for
the special delimiters, then process the
extracted block.
H(VOWEL1)rE's A blOck Of tExt tO UsE As InpUt tO
thE rEgUlAr ExprEssIOn mAtchEr. NOtE thAt wE'll
fIrst ExtrAct thE blOck Of tExt by lOOkIng fOr
thE spEcIAl dElImItErs, thEn prOcEss thE
ExtrActEd blOck.
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip">
</td>
<td class="content">
<div class="paragraph">
<p><em>replaceAll()</em> 及 <em>replaceFirst()</em> 等实际上均为调用 <em>appendReplacement()</em> 与 <em>appendTail()</em> 。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reset"><a class="anchor" href="#_reset"></a>119. reset</h2>
<div class="sectionbody">
<div class="paragraph">
<p>一个已经使用过的 <em>Matcher</em> 对象，可以通过调用 <em>reset()</em> 方法再去用于匹配新的字符串。</p>
</div>
<div class="listingblock">
<div class="title">示例</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">strings</span>;<span class="comment">//: strings/Resetting.java</span>

<span class="keyword">import</span> <span class="include">java.util.regex.Matcher</span>;
<span class="keyword">import</span> <span class="include">java.util.regex.Pattern</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Resetting</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">Matcher</span> m = <span class="predefined-type">Pattern</span>.compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">[frb][aiu][gx]</span><span class="delimiter">&quot;</span></span>)
                .matcher(<span class="string"><span class="delimiter">&quot;</span><span class="content">fix the rug with bags</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">while</span> (m.find())
            <span class="predefined-type">System</span>.out.print(m.group() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println();
        m.reset(<span class="string"><span class="delimiter">&quot;</span><span class="content">fix the rig with rags</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">while</span> (m.find())
            <span class="predefined-type">System</span>.out.print(m.group() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    }
} <span class="comment">/* Output:
fix rug bag
fix rig rag
*/</span><span class="comment">//:~</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2016-06-29 21:40:22 中国标准时间
</div>
</div>
</body>
</html>