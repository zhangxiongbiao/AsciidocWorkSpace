= 系统总体架构
:imagesdir: ./images

== 概述
采用面向服务的体系结构实现公安信息系统内部以及系统之间的信息共享和数据交换。通过服务总线的管理，方便地实现服务的注册、发现、调度。

== 总体结构图
image::soa_3.png[]

服务注册方及提供方通过服务总线进行服务的交互。服务的挂接、注销等最终通过 _dubbo_ 服务总线完成。

== 服务请求示意图

=== 总线路由模式
总线路由模式，指服务的请求调用，通过总线进行请求的转发路由。大致分为以下几个步骤。

. 服务请求者将请求发送给 _资源服务总线_ ，总线解析请求报文中的服务标识，获取具体的服务信息。
. 检查请求方的访问权限，最终将请求转发给服务提供方。
. 提供方将响应信息返回给总线，再依次返回给请求方。

image::soa_request.png[]

=== 自主路由模式
自主路由模式是指请求方不再通过资源服务总线与服务提供方进行交互，而是直接与服务提供方进行交互。大致分为以下几个步骤。

. 服务请求者发送申请报文至总线，申请指定服务的访问权限
. 总线判断服务请求者是否有权限直接访问服务提供方
. 如有权访问，总线生成授权信息返回级服务请求方
. 服务请求方挟带授权信息直接访问服务提供方
. 服务提供方校验授权信息成功后，将服务提供信息返回给服务请求者

image::soq_request2.png[]
